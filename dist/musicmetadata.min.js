parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"KA2S":[function(require,module,exports) {
var t=function(t){"use strict";var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,r,e,n){var o=r&&r.prototype instanceof v?r:v,i=Object.create(o.prototype),a=new k(n||[]);return i._invoke=function(t,r,e){var n=f;return function(o,i){if(n===l)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return N()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var c=_(a,e);if(c){if(c===y)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===f)throw n=p,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=l;var u=h(t,r,e);if("normal"===u.type){if(n=e.done?p:s,u.arg===y)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n=p,e.method="throw",e.arg=u.arg)}}}(t,e,a),i}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=u;var f="suspendedStart",s="suspendedYield",l="executing",p="completed",y={};function v(){}function d(){}function g(){}var m={};m[i]=function(){return this};var w=Object.getPrototypeOf,L=w&&w(w(G([])));L&&L!==e&&n.call(L,i)&&(m=L);var x=g.prototype=v.prototype=Object.create(m);function E(t){["next","throw","return"].forEach(function(r){t[r]=function(t){return this._invoke(r,t)}})}function b(t){var r;this._invoke=function(e,o){function i(){return new Promise(function(r,i){!function r(e,o,i,a){var c=h(t[e],t,o);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?Promise.resolve(f.__await).then(function(t){r("next",t,i,a)},function(t){r("throw",t,i,a)}):Promise.resolve(f).then(function(t){u.value=t,i(u)},function(t){return r("throw",t,i,a)})}a(c.arg)}(e,o,r,i)})}return r=r?r.then(i,i):i()}}function _(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,_(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function j(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function O(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function G(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:N}}function N(){return{value:r,done:!0}}return d.prototype=x.constructor=g,g.constructor=d,g[c]=d.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===d||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},E(b.prototype),b.prototype[a]=function(){return this},t.AsyncIterator=b,t.async=function(r,e,n,o){var i=new b(u(r,e,n,o));return t.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},E(x),x[c]="Generator",x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=G,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return c.type="throw",c.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),h=n.call(a,"finallyLoc");if(u&&h){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),O(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;O(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:G(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=t}catch(r){Function("r","regeneratorRuntime = r")(t)}
},{}],"IfYP":[function(require,module,exports) {
var s=1e3,e=60*s,r=60*e,a=24*r,n=7*a,c=365.25*a;function t(t){if(!((t=String(t)).length>100)){var u=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(u){var o=parseFloat(u[1]);switch((u[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return o*c;case"weeks":case"week":case"w":return o*n;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*r;case"minutes":case"minute":case"mins":case"min":case"m":return o*e;case"seconds":case"second":case"secs":case"sec":case"s":return o*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}function u(n){var c=Math.abs(n);return c>=a?Math.round(n/a)+"d":c>=r?Math.round(n/r)+"h":c>=e?Math.round(n/e)+"m":c>=s?Math.round(n/s)+"s":n+"ms"}function o(n){var c=Math.abs(n);return c>=a?i(n,c,a,"day"):c>=r?i(n,c,r,"hour"):c>=e?i(n,c,e,"minute"):c>=s?i(n,c,s,"second"):n+" ms"}function i(s,e,r,a){var n=e>=1.5*r;return Math.round(s/r)+" "+a+(n?"s":"")}module.exports=function(s,e){e=e||{};var r=typeof s;if("string"===r&&s.length>0)return t(s);if("number"===r&&!1===isNaN(s))return e.long?o(s):u(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};
},{}],"MTTc":[function(require,module,exports) {
function e(e){function n(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]}function t(e){let o;function i(...e){if(!i.enabled)return;const n=i,s=Number(new Date),r=s-(o||s);n.diff=r,n.prev=o,n.curr=s,o=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(s,r)=>{if("%%"===s)return s;a++;const o=t.formatters[r];if("function"==typeof o){const t=e[a];s=o.call(n,t),e.splice(a,1),a--}return s}),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return i.namespace=e,i.enabled=t.enabled(e),i.useColors=t.useColors(),i.color=n(e),i.destroy=s,i.extend=r,"function"==typeof t.init&&t.init(i),t.instances.push(i),i}function s(){const e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function r(e,n){const s=t(this.namespace+(void 0===n?":":n)+e);return s.log=this.log,s}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const s=("string"==typeof e?e:"").split(/[\s,]+/),r=s.length;for(n=0;n<r;n++)s[n]&&("-"===(e=s[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){const e=t.instances[n];e.enabled=t.enabled(e.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,s;for(n=0,s=t.skips.length;n<s;n++)if(t.skips[n].test(e))return!1;for(n=0,s=t.names.length;n<s;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=require("ms"),Object.keys(e).forEach(n=>{t[n]=e[n]}),t.instances=[],t.names=[],t.skips=[],t.formatters={},t.selectColor=n,t.enable(t.load()),t}module.exports=e;
},{"ms":"IfYP"}],"g5I+":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"j+D9":[function(require,module,exports) {
var process = require("process");
var e=require("process");function o(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function C(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+module.exports.humanize(this.diff),!this.useColors)return;const o="color: "+this.color;e.splice(1,0,o,"color: inherit");let C=0,t=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(C++,"%c"===e&&(t=C))}),e.splice(t,0,o)}function t(...e){return"object"==typeof console&&console.log&&console.log(...e)}function r(e){try{e?exports.storage.setItem("debug",e):exports.storage.removeItem("debug")}catch(o){}}function n(){let o;try{o=exports.storage.getItem("debug")}catch(C){}return!o&&void 0!==e&&"env"in e&&(o=void 0),o}function s(){try{return localStorage}catch(e){}}exports.log=t,exports.formatArgs=C,exports.save=r,exports.load=n,exports.useColors=o,exports.storage=s(),exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],module.exports=require("./common")(exports);const{formatters:F}=module.exports;F.j=function(e){try{return JSON.stringify(e)}catch(o){return"[UnexpectedJSONParseError]: "+o.message}};
},{"./common":"MTTc","process":"g5I+"}],"2Fe+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.endOfFile="End-Of-File";
},{}],"FRly":[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){for(var n,o=h(r),a=o[0],u=o[1],i=new e(c(r,a,u)),f=0,A=u>0?a-4:a,d=0;d<A;d+=4)n=t[r.charCodeAt(d)]<<18|t[r.charCodeAt(d+1)]<<12|t[r.charCodeAt(d+2)]<<6|t[r.charCodeAt(d+3)],i[f++]=n>>16&255,i[f++]=n>>8&255,i[f++]=255&n;return 2===u&&(n=t[r.charCodeAt(d)]<<2|t[r.charCodeAt(d+1)]>>4,i[f++]=255&n),1===u&&(n=t[r.charCodeAt(d)]<<10|t[r.charCodeAt(d+1)]<<4|t[r.charCodeAt(d+2)]>>2,i[f++]=n>>8&255,i[f++]=255&n),i}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],"Quj6":[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],"aq/z":[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],"z1tx":[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":"FRly","ieee754":"Quj6","isarray":"aq/z","buffer":"z1tx"}],"PoRW":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function n(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function t(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}Object.defineProperty(exports,"__esModule",{value:!0});var u=require("./type"),a=function(){function n(){r(this,n),this.position=0,this.numBuffer=e.alloc(4)}return t(n,[{key:"readToken",value:function(r){var n,t,a,i,o=arguments;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:null,t=o.length>2?o[2]:void 0,a=e.alloc(r.len),s.next=5,regeneratorRuntime.awrap(this.readBuffer(a,0,r.len,n));case 5:if(i=s.sent,t||!(i<r.len)){s.next=8;break}throw new Error(u.endOfFile);case 8:return s.abrupt("return",r.get(a,0));case 9:case"end":return s.stop()}},null,this)}},{key:"peekToken",value:function(r){var n,t,a,i,o=arguments;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:this.position,t=o.length>2?o[2]:void 0,a=e.alloc(r.len),s.next=5,regeneratorRuntime.awrap(this.peekBuffer(a,0,r.len,n));case 5:if(i=s.sent,t||!(i<r.len)){s.next=8;break}throw new Error(u.endOfFile);case 8:return s.abrupt("return",r.get(a,0));case 9:case"end":return s.stop()}},null,this)}},{key:"readNumber",value:function(e){return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.readBuffer(this.numBuffer,0,e.len,null));case 2:if(!(r.sent<e.len)){r.next=5;break}throw new Error(u.endOfFile);case 5:return r.abrupt("return",e.get(this.numBuffer,0));case 6:case"end":return r.stop()}},null,this)}},{key:"peekNumber",value:function(e){return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.peekBuffer(this.numBuffer,0,e.len));case 2:if(!(r.sent<e.len)){r.next=5;break}throw new Error(u.endOfFile);case 5:return r.abrupt("return",e.get(this.numBuffer,0));case 6:case"end":return r.stop()}},null,this)}},{key:"close",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}})}}]),n}();exports.AbstractTokenizer=a;
},{"./type":"2Fe+","buffer":"z1tx"}],"NMPJ":[function(require,module,exports) {
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};
},{}],"v3DX":[function(require,module,exports) {
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};
},{}],"RaA+":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var e=arguments[3],t=require("process"),r=/%[sdj%]/g;exports.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}n=1;for(var o=arguments,s=o.length,u=String(e).replace(r,function(e){if("%%"===e)return"%";if(n>=s)return e;switch(e){case"%s":return String(o[n++]);case"%d":return Number(o[n++]);case"%j":try{return JSON.stringify(o[n++])}catch(t){return"[Circular]"}default:return e}}),c=o[n];n<s;c=o[++n])h(c)||!z(c)?u+=" "+c:u+=" "+i(c);return u},exports.deprecate=function(r,n){if(j(e.process))return function(){return exports.deprecate(r,n).apply(this,arguments)};if(!0===t.noDeprecation)return r;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var n,o={};function i(e,t){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),x(t)?r.showHidden=t:t&&exports._extend(r,t),j(r.showHidden)&&(r.showHidden=!1),j(r.depth)&&(r.depth=2),j(r.colors)&&(r.colors=!1),j(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),p(r,e,r.depth)}function s(e,t){var r=i.styles[t];return r?"["+i.colors[r][0]+"m"+e+"["+i.colors[r][1]+"m":e}function u(e,t){return e}function c(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function p(e,t,r){if(e.customInspect&&t&&D(t.inspect)&&t.inspect!==exports.inspect&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return v(n)||(n=p(e,n,r)),n}var o=l(e,t);if(o)return o;var i=Object.keys(t),s=c(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),E(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return a(t);if(0===i.length){if(D(t)){var u=t.name?": "+t.name:"";return e.stylize("[Function"+u+"]","special")}if(O(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(w(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return a(t)}var x,h="",b=!1,m=["{","}"];(d(t)&&(b=!0,m=["[","]"]),D(t))&&(h=" [Function"+(t.name?": "+t.name:"")+"]");return O(t)&&(h=" "+RegExp.prototype.toString.call(t)),w(t)&&(h=" "+Date.prototype.toUTCString.call(t)),E(t)&&(h=" "+a(t)),0!==i.length||b&&0!=t.length?r<0?O(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),x=b?f(e,t,r,s,i):i.map(function(n){return g(e,t,r,s,n,b)}),e.seen.pop(),y(x,h,m)):m[0]+h+m[1]}function l(e,t){if(j(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return m(t)?e.stylize(""+t,"number"):x(t)?e.stylize(""+t,"boolean"):h(t)?e.stylize("null","null"):void 0}function a(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,r,n,o){for(var i=[],s=0,u=t.length;s<u;++s)$(t,String(s))?i.push(g(e,t,r,n,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(g(e,t,r,n,o,!0))}),i}function g(e,t,r,n,o,i){var s,u,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),$(n,o)||(s="["+o+"]"),u||(e.seen.indexOf(c.value)<0?(u=h(r)?p(e,c.value,null):p(e,c.value,r-1)).indexOf("\n")>-1&&(u=i?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),j(s)){if(i&&o.match(/^\d+$/))return u;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function y(e,t,r){return e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function d(e){return Array.isArray(e)}function x(e){return"boolean"==typeof e}function h(e){return null===e}function b(e){return null==e}function m(e){return"number"==typeof e}function v(e){return"string"==typeof e}function S(e){return"symbol"==typeof e}function j(e){return void 0===e}function O(e){return z(e)&&"[object RegExp]"===A(e)}function z(e){return"object"==typeof e&&null!==e}function w(e){return z(e)&&"[object Date]"===A(e)}function E(e){return z(e)&&("[object Error]"===A(e)||e instanceof Error)}function D(e){return"function"==typeof e}function N(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function A(e){return Object.prototype.toString.call(e)}function J(e){return e<10?"0"+e.toString(10):e.toString(10)}exports.debuglog=function(e){if(j(n)&&(n=""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(n)){var r=t.pid;o[e]=function(){var t=exports.format.apply(exports,arguments);console.error("%s %d: %s",e,r,t)}}else o[e]=function(){};return o[e]},exports.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=d,exports.isBoolean=x,exports.isNull=h,exports.isNullOrUndefined=b,exports.isNumber=m,exports.isString=v,exports.isSymbol=S,exports.isUndefined=j,exports.isRegExp=O,exports.isObject=z,exports.isDate=w,exports.isError=E,exports.isFunction=D,exports.isPrimitive=N,exports.isBuffer=require("./support/isBuffer");var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function H(){var e=new Date,t=[J(e.getHours()),J(e.getMinutes()),J(e.getSeconds())].join(":");return[e.getDate(),R[e.getMonth()],t].join(" ")}function $(e,t){return Object.prototype.hasOwnProperty.call(e,t)}exports.log=function(){console.log("%s - %s",H(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,t){if(!t||!z(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};
},{"./support/isBuffer":"NMPJ","inherits":"v3DX","process":"g5I+"}],"TfPC":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];function e(t,e){if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0}function r(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var n=require("util/"),i=Object.prototype.hasOwnProperty,o=Array.prototype.slice,u="foo"===function(){}.name;function a(t){return Object.prototype.toString.call(t)}function f(e){return!r(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var c=module.exports=y,s=/\s*function\s+([^\(\s]*)\s*/;function l(t){if(n.isFunction(t)){if(u)return t.name;var e=t.toString().match(s);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function g(t){if(u||!n.isFunction(t))return n.inspect(t);var e=l(t);return"[Function"+(e?": "+e:"")+"]"}function h(t){return p(g(t.actual),128)+" "+t.operator+" "+p(g(t.expected),128)}function E(t,e,r,n,i){throw new c.AssertionError({message:r,actual:t,expected:e,operator:n,stackStartFunction:i})}function y(t,e){t||E(t,!0,e,"==",c.ok)}function d(t,i,o,u){if(t===i)return!0;if(r(t)&&r(i))return 0===e(t,i);if(n.isDate(t)&&n.isDate(i))return t.getTime()===i.getTime();if(n.isRegExp(t)&&n.isRegExp(i))return t.source===i.source&&t.global===i.global&&t.multiline===i.multiline&&t.lastIndex===i.lastIndex&&t.ignoreCase===i.ignoreCase;if(null!==t&&"object"==typeof t||null!==i&&"object"==typeof i){if(f(t)&&f(i)&&a(t)===a(i)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===e(new Uint8Array(t.buffer),new Uint8Array(i.buffer));if(r(t)!==r(i))return!1;var c=(u=u||{actual:[],expected:[]}).actual.indexOf(t);return-1!==c&&c===u.expected.indexOf(i)||(u.actual.push(t),u.expected.push(i),b(t,i,o,u))}return o?t===i:t==i}function m(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function b(t,e,r,i){if(null==t||null==e)return!1;if(n.isPrimitive(t)||n.isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var u=m(t),a=m(e);if(u&&!a||!u&&a)return!1;if(u)return d(t=o.call(t),e=o.call(e),r);var f,c,s=O(t),l=O(e);if(s.length!==l.length)return!1;for(s.sort(),l.sort(),c=s.length-1;c>=0;c--)if(s[c]!==l[c])return!1;for(c=s.length-1;c>=0;c--)if(!d(t[f=s[c]],e[f],r,i))return!1;return!0}function v(t,e,r){d(t,e,!0)&&E(t,e,r,"notDeepStrictEqual",v)}function q(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(r){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function x(t){var e;try{t()}catch(r){e=r}return e}function w(t,e,r,i){var o;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(i=r,r=null),o=x(e),i=(r&&r.name?" ("+r.name+").":".")+(i?" "+i:"."),t&&!o&&E(o,r,"Missing expected exception"+i);var u="string"==typeof i,a=!t&&o&&!r;if((!t&&n.isError(o)&&u&&q(o,r)||a)&&E(o,r,"Got unwanted exception"+i),t&&o&&r&&!q(o,r)||!t&&o)throw o}c.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=h(this),this.generatedMessage=!0);var e=t.stackStartFunction||E;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var r=new Error;if(r.stack){var n=r.stack,i=l(e),o=n.indexOf("\n"+i);if(o>=0){var u=n.indexOf("\n",o+1);n=n.substring(u+1)}this.stack=n}}},n.inherits(c.AssertionError,Error),c.fail=E,c.ok=y,c.equal=function(t,e,r){t!=e&&E(t,e,r,"==",c.equal)},c.notEqual=function(t,e,r){t==e&&E(t,e,r,"!=",c.notEqual)},c.deepEqual=function(t,e,r){d(t,e,!1)||E(t,e,r,"deepEqual",c.deepEqual)},c.deepStrictEqual=function(t,e,r){d(t,e,!0)||E(t,e,r,"deepStrictEqual",c.deepStrictEqual)},c.notDeepEqual=function(t,e,r){d(t,e,!1)&&E(t,e,r,"notDeepEqual",c.notDeepEqual)},c.notDeepStrictEqual=v,c.strictEqual=function(t,e,r){t!==e&&E(t,e,r,"===",c.strictEqual)},c.notStrictEqual=function(t,e,r){t===e&&E(t,e,r,"!==",c.notStrictEqual)},c.throws=function(t,e,r){w(!0,t,e,r)},c.doesNotThrow=function(t,e,r){w(!1,t,e,r)},c.ifError=function(t){if(t)throw t};var O=Object.keys||function(t){var e=[];for(var r in t)i.call(t,r)&&e.push(r);return e};
},{"util/":"RaA+"}],"3mbL":[function(require,module,exports) {
"use strict";function e(e,r,t,n,u,s,i){try{var a=e[s](i),o=a.value}catch(c){return void t(c)}a.done?r(o):Promise.resolve(o).then(n,u)}function r(r){return function(){var t=this,n=arguments;return new Promise(function(u,s){var i=r.apply(t,n);function a(r){e(i,u,s,a,o,"next",r)}function o(r){e(i,u,s,a,o,"throw",r)}a(void 0)})}}function t(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}function u(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var s=require("assert"),i=function e(){var r=this;u(this,e),this.promise=new Promise(function(e,t){r.reject=t,r.resolve=e})};exports.endOfStream="End-Of-Stream";var a=function(){function e(r){var t=this;if(u(this,e),this.s=r,this.endOfStream=!1,this.peekQueue=[],!r.read||!r.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",function(){return t.reject(new Error(exports.endOfStream))}),this.s.once("error",function(e){return t.reject(e)}),this.s.once("close",function(){return t.reject(new Error("Stream closed"))})}return n(e,[{key:"peek",value:function(){var e=r(regeneratorRuntime.mark(function e(r,t,n){var u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.read(r,t,n);case 2:return u=e.sent,this.peekQueue.push(r.slice(t,t+u)),e.abrupt("return",u);case 5:case"end":return e.stop()}},e,this)}));return function(r,t,n){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=r(regeneratorRuntime.mark(function e(r,t,n){var u,s,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n){e.next=2;break}return e.abrupt("return",0);case 2:if(0!==this.peekQueue.length||!this.endOfStream){e.next=4;break}throw new Error(exports.endOfStream);case 4:for(u=n,s=0;this.peekQueue.length>0&&u>0;)i=this.peekQueue.pop(),a=Math.min(i.length,u),i.copy(r,t+s,0,a),s+=a,u-=a,a<i.length&&this.peekQueue.push(i.slice(a));if(!(u>0)||this.endOfStream){e.next=12;break}return e.t0=s,e.next=11,this._read(r,t+s,u);case 11:s=e.t0+=e.sent;case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}},e,this)}));return function(r,t,n){return e.apply(this,arguments)}}()},{key:"_read",value:function(){var e=r(regeneratorRuntime.mark(function e(r,t,n){var u,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.ok(!this.request,"Concurrent read operation?"),!(u=this.s.read(n))){e.next=7;break}return u.copy(r,t),e.abrupt("return",u.length);case 7:return this.request={buffer:r,offset:t,length:n,deferred:new i},this.s.once("readable",function(){a.tryRead()}),e.abrupt("return",this.request.deferred.promise.then(function(e){return a.request=null,e}).catch(function(e){throw a.request=null,e}));case 10:case"end":return e.stop()}},e,this)}));return function(r,t,n){return e.apply(this,arguments)}}()},{key:"tryRead",value:function(){var e=this,r=this.s.read(this.request.length);r?(r.copy(this.request.buffer,this.request.offset),this.request.deferred.resolve(r.length)):this.s.once("readable",function(){e.tryRead()})}},{key:"reject",value:function(e){this.endOfStream=!0,this.request&&(this.request.deferred.reject(e),this.request=null)}}]),e}();exports.StreamReader=a;
},{"assert":"TfPC"}],"h40E":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&c(e,r)}function c(e,r){return(c=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}Object.defineProperty(exports,"__esModule",{value:!0});var f=require("./AbstractTokenizer"),p=require("./type"),l=require("then-read-stream"),h=require("debug"),b=h("strtok3:ReadStreamTokenizer"),d=function(r){function n(e,r){var o;return t(this,n),(o=a(this,u(n).call(this))).streamReader=new l.StreamReader(e),o.fileSize=r,o}return s(n,f.AbstractTokenizer),o(n,[{key:"readBuffer",value:function(e){var r,t,n,o,a,i=arguments;return regeneratorRuntime.async(function(u){for(;;)switch(u.prev=u.next){case 0:if(r=i.length>1&&void 0!==i[1]?i[1]:0,t=i.length>2&&void 0!==i[2]?i[2]:e.length,n=i.length>3?i[3]:void 0,0!==t){u.next=5;break}return u.abrupt("return",0);case 5:if(!n){u.next=15;break}if(!((o=n-this.position)>0)){u.next=13;break}return u.next=10,regeneratorRuntime.awrap(this.ignore(n-this.position));case 10:return u.abrupt("return",this.readBuffer(e,r,t));case 13:if(!(o<0)){u.next=15;break}throw new Error("Cannot read from a negative offset in a stream");case 15:return u.prev=15,u.next=18,regeneratorRuntime.awrap(this.streamReader.read(e,r,t));case 18:a=u.sent,this.position+=a,u.next=29;break;case 22:if(u.prev=22,u.t0=u.catch(15),u.t0.message!==l.endOfStream){u.next=28;break}throw new Error(p.endOfFile);case 28:throw u.t0;case 29:if(!(a<t)){u.next=31;break}throw new Error(p.endOfFile);case 31:return u.abrupt("return",a);case 32:case"end":return u.stop()}},null,this,[[15,22]])}},{key:"peekBuffer",value:function(r){var t,n,o,a,i,u,s,c=arguments;return regeneratorRuntime.async(function(f){for(;;)switch(f.prev=f.next){case 0:if(t=c.length>1&&void 0!==c[1]?c[1]:0,n=c.length>2&&void 0!==c[2]?c[2]:r.length,o=c.length>3?c[3]:void 0,a=c.length>4?c[4]:void 0,!o){f.next=17;break}if(!((u=o-this.position)>0)){f.next=15;break}return s=e.alloc(n+u),f.next=10,regeneratorRuntime.awrap(this.peekBuffer(s,0,u+n,void 0,a));case 10:return i=f.sent,s.copy(r,t,u),f.abrupt("return",i-u);case 15:if(!(u<0)){f.next=17;break}throw new Error("Cannot peek from a negative offset in a stream");case 17:return f.prev=17,f.next=20,regeneratorRuntime.awrap(this.streamReader.peek(r,t,n));case 20:i=f.sent,f.next=30;break;case 23:if(f.prev=23,f.t0=f.catch(17),f.t0.message!==l.endOfStream){f.next=29;break}throw new Error(p.endOfFile);case 29:throw f.t0;case 30:if(a||!(i<n)){f.next=32;break}throw new Error(p.endOfFile);case 32:return f.abrupt("return",i);case 33:case"end":return f.stop()}},null,this,[[17,23]])}},{key:"ignore",value:function(r){var t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return b("ignore ".concat(this.position,"...").concat(this.position+r-1)),t=e.alloc(r),n.abrupt("return",this.readBuffer(t));case 3:case"end":return n.stop()}},null,this)}}]),n}();exports.ReadStreamTokenizer=d;
},{"./AbstractTokenizer":"PoRW","./type":"2Fe+","then-read-stream":"3mbL","debug":"j+D9","buffer":"z1tx"}],"FUZC":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./type"),i=function(){function t(n){e(this,t),this.buffer=n,this.position=0,this.fileSize=n.length}return n(t,[{key:"readBuffer",value:function(e,t,n,r){var i=this;return regeneratorRuntime.async(function(s){for(;;)switch(s.prev=s.next){case 0:return this.position=r||this.position,s.abrupt("return",this.peekBuffer(e,t,n,this.position).then(function(e){return i.position+=e,e}));case 2:case"end":return s.stop()}},null,this)}},{key:"peekBuffer",value:function(e,t,n,i){var s,u,o=arguments;return regeneratorRuntime.async(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=o.length>4&&void 0!==o[4]&&o[4],i=i||this.position,n||(n=e.length),u=Math.min(this.buffer.length-i,n),s||!(u<n)){a.next=8;break}throw new Error(r.endOfFile);case 8:return this.buffer.copy(e,t,i,i+u),a.abrupt("return",u);case 10:case"end":return a.stop()}},null,this)}},{key:"readToken",value:function(e,t){var n;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return this.position=t||this.position,r.prev=1,n=this.peekToken(e,this.position),this.position+=e.len,r.abrupt("return",n);case 7:throw r.prev=7,r.t0=r.catch(1),this.position+=this.buffer.length-t,r.t0;case 11:case"end":return r.stop()}},null,this,[[1,7]])}},{key:"peekToken",value:function(e){var t,n=arguments;return regeneratorRuntime.async(function(i){for(;;)switch(i.prev=i.next){case 0:if(t=n.length>1&&void 0!==n[1]?n[1]:this.position,!(this.buffer.length-t<e.len)){i.next=3;break}throw new Error(r.endOfFile);case 3:return i.abrupt("return",e.get(this.buffer,t));case 4:case"end":return i.stop()}},null,this)}},{key:"readNumber",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.readToken(e));case 1:case"end":return t.stop()}},null,this)}},{key:"peekNumber",value:function(e){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.peekToken(e));case 1:case"end":return t.stop()}},null,this)}},{key:"ignore",value:function(e){var t;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return t=Math.min(this.buffer.length-this.position,e),this.position+=t,n.abrupt("return",t);case 3:case"end":return n.stop()}},null,this)}},{key:"close",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}})}}]),t}();exports.BufferTokenizer=i;
},{"./type":"2Fe+"}],"tvmF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./ReadStreamTokenizer"),r=require("./BufferTokenizer");function t(r,t){return new e.ReadStreamTokenizer(r,t)}function n(e){return new r.BufferTokenizer(e)}exports.fromStream=t,exports.fromBuffer=n;
},{"./ReadStreamTokenizer":"h40E","./BufferTokenizer":"FUZC"}],"2TDI":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var r=require("buffer").Buffer;function t(r){return o(r)||e(r)||n()}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}function o(r){if(Array.isArray(r)){for(var t=0,n=new Array(r.length);t<r.length;t++)n[t]=r[t];return n}}exports.stringToBytes=function(r){return t(r).map(function(r){return r.charCodeAt(0)})};var i=function(r,n,e){return String.fromCharCode.apply(String,t(r.slice(n,e)))};exports.readUInt64LE=function(r){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=r[t],e=1,o=0;++o<8;)e*=256,n+=r[t+o]*e;return n},exports.tarHeaderChecksumMatches=function(r){if(r.length<512)return!1;for(var t=256,n=0,e=0;e<148;e++){var o=r[e];t+=o,n+=128&o}for(var f=156;f<512;f++){var a=r[f];t+=a,n+=128&a}var u=parseInt(i(r,148,154),8);return u===t||u===t-(n<<1)},exports.multiByteIndexOf=function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r&&r.isBuffer(t))return t.indexOf(r.from(n),e);for(var o=function(r,t,n){for(var e=1;e<t.length;e++)if(t[e]!==r[n+e])return!1;return!0},i=t.indexOf(n[0],e);i>=0;){if(o(t,n,i))return i;i=t.indexOf(n[0],i+1)}return-1},exports.uint8ArrayUtf8ByteString=i;
},{"buffer":"z1tx"}],"N/j2":[function(require,module,exports) {
"use strict";module.exports={extensions:["jpg","png","apng","gif","webp","flif","cr2","orf","arw","dng","nef","rw2","raf","tif","bmp","jxr","psd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","wmv","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","msi","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","wmv","wma","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-canon-cr2","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-wma","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-msi","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/ktx","application/dicom","audio/x-musepack","text/calendar","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a"]};
},{}],"gPQA":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var Buffer=require("buffer").Buffer;function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _require=require("./util"),multiByteIndexOf=_require.multiByteIndexOf,stringToBytes=_require.stringToBytes,readUInt64LE=_require.readUInt64LE,tarHeaderChecksumMatches=_require.tarHeaderChecksumMatches,uint8ArrayUtf8ByteString=_require.uint8ArrayUtf8ByteString,supported=require("./supported"),xpiZipFilename=stringToBytes("META-INF/mozilla.rsa"),oxmlContentTypes=stringToBytes("[Content_Types].xml"),oxmlRels=stringToBytes("_rels/.rels"),fileType=function(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw new TypeError("Expected the `input` argument to be of type `Uint8Array` or `Buffer` or `ArrayBuffer`, got `".concat(_typeof(e),"`"));var t=e instanceof Uint8Array?e:new Uint8Array(e);if(t&&t.length>1){var i=function(e,i){i={offset:0,...i};for(var r=0;r<e.length;r++)if(i.mask){if(e[r]!==(i.mask[r]&t[r+i.offset]))return!1}else if(e[r]!==t[r+i.offset])return!1;return!0},r=function(e,t){return i(stringToBytes(e),t)};if(i([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(i([137,80,78,71,13,10,26,10])){var m=t.findIndex(function(e,i){return i>=33&&73===t[i]&&68===t[i+1]&&65===t[i+2]&&84===t[i+3]}),o=t.subarray(33,m);return o.findIndex(function(e,t){return 97===o[t]&&99===o[t+1]&&84===o[t+2]&&76===o[t+3]})>=0?{ext:"apng",mime:"image/apng"}:{ext:"png",mime:"image/png"}}if(i([71,73,70]))return{ext:"gif",mime:"image/gif"};if(i([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(i([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((i([73,73,42,0])||i([77,77,0,42]))&&i([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(i([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(i([73,73,42,0])&&(i([16,251,134,1],{offset:4})||i([8,0,0,0,19,0],{offset:4})||i([8,0,0,0,18,0],{offset:4})))return{ext:"arw",mime:"image/x-sony-arw"};if(i([73,73,42,0,8,0,0,0])&&(i([45,0,254,0],{offset:8})||i([39,0,254,0],{offset:8})))return{ext:"dng",mime:"image/x-adobe-dng"};if(i([73,73,42,0])&&i([28,0,254,0],{offset:8}))return{ext:"nef",mime:"image/x-nikon-nef"};if(i([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(r("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(i([73,73,42,0])||i([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(i([66,77]))return{ext:"bmp",mime:"image/bmp"};if(i([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(i([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};var n=[80,75,3,4];if(i(n)){if(i([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(i(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(r("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(r("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(r("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};var a,f=0,p=!1;do{var s=f+30;if(p||(p=i(oxmlContentTypes,{offset:s})||i(oxmlRels,{offset:s})),a||(r("word/",{offset:s})?a={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:r("ppt/",{offset:s})?a={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:r("xl/",{offset:s})&&(a={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),p&&a)return a;f=multiByteIndexOf(t,n,s)}while(f>=0);if(a)return a}if(i([80,75])&&(3===t[2]||5===t[2]||7===t[2])&&(4===t[3]||6===t[3]||8===t[3]))return{ext:"zip",mime:"application/zip"};if(i([48,48,48,48,48,48],{offset:148,mask:[248,248,248,248,248,248]})&&tarHeaderChecksumMatches(t))return{ext:"tar",mime:"application/x-tar"};if(i([82,97,114,33,26,7])&&(0===t[6]||1===t[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(i([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(i([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(i([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(i([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(i([102,114,101,101],{offset:4})||i([109,100,97,116],{offset:4})||i([109,111,111,118],{offset:4})||i([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(i([102,116,121,112],{offset:4})&&0!=(96&t[8])&&0!=(96&t[9])&&0!=(96&t[10])&&0!=(96&t[11])){var u=uint8ArrayUtf8ByteString(t,8,12);switch(u){case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt  ":return{ext:"mov",mime:"video/quicktime"};case"M4V ":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P ":return{ext:"m4p",mime:"video/mp4"};case"M4B ":return{ext:"m4b",mime:"audio/mp4"};case"M4A ":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V ":return{ext:"f4v",mime:"video/mp4"};case"F4P ":return{ext:"f4p",mime:"video/mp4"};case"F4A ":return{ext:"f4a",mime:"audio/mp4"};case"F4B ":return{ext:"f4b",mime:"audio/mp4"};default:return u.startsWith("3g")?u.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(i([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(i([26,69,223,163])){var x=t.subarray(4,4100),c=x.findIndex(function(e,t,i){return 66===i[t]&&130===i[t+1]});if(-1!==c){var l=c+3,d=function(e){return _toConsumableArray(e).every(function(e,t){return x[l+t]===e.charCodeAt(0)})};if(d("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(d("webm"))return{ext:"webm",mime:"video/webm"}}}if(i([82,73,70,70])){if(i([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(i([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(i([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(i([48,38,178,117,142,102,207,17,166,217])){var g=30;do{var v=readUInt64LE(t,g+16);if(i([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:g})){if(i([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:g+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(i([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:g+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}g+=v}while(g+24<=t.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(i([0,0,1,186])||i([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};for(var y=0;y<2&&y<t.length-16;y++){if(i([73,68,51],{offset:y})||i([255,226],{offset:y,mask:[255,230]}))return{ext:"mp3",mime:"audio/mpeg"};if(i([255,228],{offset:y,mask:[255,230]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,248],{offset:y,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,240],{offset:y,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(i([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(i([79,103,103,83]))return i([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:i([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:i([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:i([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:i([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(i([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(i([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(i([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(i([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(i([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(i([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===t[0]||70===t[0])&&i([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(i([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(i([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(i([119,79,70,70])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(i([119,79,70,50])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(i([76,80],{offset:34})&&(i([0,0,1],{offset:8})||i([1,0,2],{offset:8})||i([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(i([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(i([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(i([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(i([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(i([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(i([37,33]))return{ext:"ps",mime:"application/postscript"};if(i([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(i([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(i([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(i([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(i([77,83,67,70])||i([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(i([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(i([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(i([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(i([31,160])||i([31,157]))return{ext:"Z",mime:"application/x-compress"};if(i([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(i([208,207,17,224,161,177,26,225,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62]))return{ext:"msi",mime:"application/x-msi"};if(i([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(i([71],{offset:4})&&(i([71],{offset:192})||i([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(i([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(i([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(i([0,0,0,12,106,80,32,32,13,10,135,10])){if(i([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(i([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(i([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(i([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}return i([70,79,82,77])?{ext:"aif",mime:"audio/aiff"}:r("<?xml ")?{ext:"xml",mime:"application/xml"}:i([66,79,79,75,77,79,66,73],{offset:60})?{ext:"mobi",mime:"application/x-mobipocket-ebook"}:i([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:i([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:i([77,80,43])?{ext:"mpc",mime:"audio/x-musepack"}:i([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:i([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:i([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:i([212,195,178,161])||i([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:i([68,83,68,32])?{ext:"dsf",mime:"audio/x-dsf"}:i([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70])?{ext:"lnk",mime:"application/x.ms.shortcut"}:i([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0])?{ext:"alias",mime:"application/x.apple.alias"}:r("Creative Voice File")?{ext:"voc",mime:"audio/x-voc"}:i([11,119])?{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"}:void 0}};module.exports=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),fileType.stream=function(readableStream){return new Promise(function(resolve,reject){var stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",function(){var e=new stream.PassThrough,t=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{e.fileType=fileType(t)}catch(i){reject(i)}readableStream.unshift(t),stream.pipeline?resolve(stream.pipeline(readableStream,e,function(){})):resolve(readableStream.pipe(e))})})},Object.defineProperty(fileType,"extensions",{get:function(){return new Set(supported.extensions)}}),Object.defineProperty(fileType,"mimeTypes",{get:function(){return new Set(supported.mimeTypes)}});
},{"./util":"2TDI","./supported":"N/j2","buffer":"z1tx"}],"UNrW":[function(require,module,exports) {
"use strict";var e=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,r=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,t=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,n=/\\([\u000b\u0020-\u00ff])/g,a=/([\\"])/g,o=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function i(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var r=e.parameters,n=e.type;if(!n||!o.test(n))throw new TypeError("invalid type");var a=n;if(r&&"object"==typeof r)for(var i,u=Object.keys(r).sort(),f=0;f<u.length;f++){if(i=u[f],!t.test(i))throw new TypeError("invalid parameter name");a+="; "+i+"="+s(r[i])}return a}function u(r){if(!r)throw new TypeError("argument string is required");var t="object"==typeof r?f(r):r;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var a=t.indexOf(";"),i=-1!==a?t.substr(0,a).trim():t.trim();if(!o.test(i))throw new TypeError("invalid media type");var u=new p(i.toLowerCase());if(-1!==a){var s,y,w;for(e.lastIndex=a;y=e.exec(t);){if(y.index!==a)throw new TypeError("invalid parameter format");a+=y[0].length,s=y[1].toLowerCase(),'"'===(w=y[2])[0]&&(w=w.substr(1,w.length-2).replace(n,"$1")),u.parameters[s]=w}if(a!==t.length)throw new TypeError("invalid parameter format")}return u}function f(e){var r;if("function"==typeof e.getHeader?r=e.getHeader("content-type"):"object"==typeof e.headers&&(r=e.headers&&e.headers["content-type"]),"string"!=typeof r)throw new TypeError("content-type header is missing from object");return r}function s(e){var n=String(e);if(t.test(n))return n;if(n.length>0&&!r.test(n))throw new TypeError("invalid parameter value");return'"'+n.replace(a,"\\$1")+'"'}function p(e){this.parameters=Object.create(null),this.type=e}exports.format=i,exports.parse=u;
},{}],"atBn":[function(require,module,exports) {
"use strict";var r=/^[A-Za-z0-9][A-Za-z0-9!#$&^_.-]{0,126}$/,e=/^[A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126}$/,t=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;function i(t){if(!t||"object"!=typeof t)throw new TypeError("argument obj is required");var i=t.subtype,s=t.suffix,n=t.type;if(!n||!e.test(n))throw new TypeError("invalid type");if(!i||!r.test(i))throw new TypeError("invalid subtype");var o=n+"/"+i;if(s){if(!e.test(s))throw new TypeError("invalid suffix");o+="+"+s}return o}function s(r){if(!r)throw new TypeError("argument string is required");if("string"!=typeof r)throw new TypeError("argument string is required to be a string");return t.test(r.toLowerCase())}function n(r){if(!r)throw new TypeError("argument string is required");if("string"!=typeof r)throw new TypeError("argument string is required to be a string");var e=t.exec(r.toLowerCase());if(!e)throw new TypeError("invalid media type");var i,s=e[1],n=e[2],a=n.lastIndexOf("+");return-1!==a&&(i=n.substr(a+1),n=n.substr(0,a)),new o(s,n,i)}function o(r,e,t){this.type=r,this.subtype=e,this.suffix=t}exports.format=i,exports.parse=n,exports.test=s;
},{}],"Wlj4":[function(require,module,exports) {
"use strict";function i(i){return exports.commonTags.hasOwnProperty(i)&&!exports.commonTags[i].multiple}function l(i){return!exports.commonTags[i].multiple||exports.commonTags[i].unique}Object.defineProperty(exports,"__esModule",{value:!0}),exports.commonTags={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!0,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!1},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},description:{multiple:!0}},exports.isSingleton=i,exports.isUnique=l;
},{}],"0BDm":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,r,o){return r&&n(e.prototype,r),o&&n(e,o),e}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function n(){e(this,n)}return r(n,null,[{key:"decode",value:function(e){var r="";for(var o in e)e.hasOwnProperty(o)&&(r+=n.codePointToString(n.singleByteDecoder(e[o])));return r}},{key:"inRange",value:function(e,n,r){return n<=e&&e<=r}},{key:"codePointToString",value:function(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}},{key:"singleByteDecoder",value:function(e){if(n.inRange(e,0,127))return e;var r=n.windows1252[e-128];if(null===r)throw Error("invaliding encoding");return r}}]),n}();o.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],exports.Windows1292Decoder=o;
},{}],"5e0M":[function(require,module,exports) {
"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("assert"),u=require("./Windows1292Decoder"),o=function(){function r(){e(this,r)}return t(r,null,[{key:"findZero",value:function(e,r,t,n){var u=r;if("utf16"===n){for(;0!==e[u]||0!==e[u+1];){if(u>=t)return t;u+=2}return u}for(;0!==e[u];){if(u>=t)return t;u++}return u}},{key:"trimRightNull",value:function(e){var r=e.indexOf("\0");return-1===r?e:e.substr(0,r)}},{key:"swapBytes",value:function(e){var r=e.length;n.ok(0==(1&r),"Buffer length must be even");for(var t=0;t<r;t+=2){var u=e[t];e[t]=e[t+1],e[t+1]=u}return e}},{key:"readUTF16String",value:function(e){var t=0;return 254===e[0]&&255===e[1]?(e=r.swapBytes(e),t=2):255===e[0]&&254===e[1]&&(t=2),e.toString("ucs2",t)}},{key:"decodeString",value:function(e,t){if(255===e[0]&&254===e[1]&&254===e[2]&&255===e[3]&&(e=e.slice(2)),"utf16le"===t||"utf16"===t)return r.readUTF16String(e);if("utf8"===t)return e.toString("utf8");if("iso-8859-1"===t)return u.Windows1292Decoder.decode(e);throw Error(t+" encoding is not supported!")}},{key:"stripNulls",value:function(e){return e=(e=e.replace(/^\x00+/g,"")).replace(/\x00+$/g,"")}},{key:"getBitAllignedNumber",value:function(e,t,n,u){var o=n%8,i=e[t+~~(n/8)];i&=255>>o;var a=8-o,f=u-a;return f<0?i>>=8-o-u:f>0&&(i<<=f,i|=r.getBitAllignedNumber(e,t,n+a,f)),i}},{key:"isBitSet",value:function(e,t,n){return 1===r.getBitAllignedNumber(e,t,n,1)}},{key:"a2hex",value:function(e){for(var r=[],t=0,n=e.length;t<n;t++){var u=Number(e.charCodeAt(t)).toString(16);r.push(1===u.length?"0"+u:u)}return r.join(" ")}}]),r}();function i(e){return 10*Math.log10(e)}function a(e){return Math.pow(10,e/10)}function f(e){var r=e.split(" ").map(function(e){return e.trim().toLowerCase()});if(r.length>=1){var t=parseFloat(r[0]);return 2===r.length&&"db"===r[1]?{dB:t,ratio:a(t)}:{dB:i(t),ratio:t}}}o.strtokBITSET={get:function(e,r,t){return 0!=(e[r]&1<<t)},len:1},exports.default=o,exports.ratioToDb=i,exports.dbToRatio=a,exports.toRatio=f;
},{"assert":"TfPC","./Windows1292Decoder":"0BDm"}],"1rOY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("assert"),t=(e,t,n,r)=>{if(t+n>e.length){if("function"!=typeof r)throw new Error("Buffer out of space and no valid flush() function found");return r(e,t),0}return t};exports.UINT8={len:1,get:(e,t)=>e.readUInt8(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=0&&o<=255),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeUInt8(o,u),u-r+this.len}},exports.UINT16_LE={len:2,get:(e,t)=>e.readUInt16LE(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=0&&o<=65535),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeUInt16LE(o,u),u-r+this.len}},exports.UINT16_BE={len:2,get:(e,t)=>e.readUInt16BE(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=0&&o<=65535),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeUInt16BE(o,u),u-r+this.len}},exports.UINT24_LE={len:3,get:(e,t)=>e.readUIntLE(t,3),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=0&&o<=16777215),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeUIntLE(o,u,3),u-r+this.len}},exports.UINT24_BE={len:3,get:(e,t)=>e.readUIntBE(t,3),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=0&&o<=16777215),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeUIntBE(o,u,3),u-r+this.len}},exports.UINT32_LE={len:4,get:(e,t)=>e.readUInt32LE(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=0&&o<=4294967295),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeUInt32LE(o,u),u-r+this.len}},exports.UINT32_BE={len:4,get:(e,t)=>e.readUInt32BE(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=0&&o<=4294967295),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeUInt32BE(o,u),u-r+this.len}},exports.INT8={len:1,get:(e,t)=>e.readInt8(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=-128&&o<=127),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeInt8(o,u),u-r+this.len}},exports.INT16_BE={len:2,get:(e,t)=>e.readInt16BE(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=-32768&&o<=32767),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeInt16BE(o,u),u-r+this.len}},exports.INT16_LE={len:2,get:(e,t)=>e.readInt16LE(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=-32768&&o<=32767),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeInt16LE(o,u),u-r+this.len}},exports.INT24_LE={len:3,get:(e,t)=>e.readIntLE(t,3),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=-8388608&&o<=8388607),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeIntLE(o,u,3),u-r+this.len}},exports.INT24_BE={len:3,get:(e,t)=>e.readIntBE(t,3),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=-8388608&&o<=8388607),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeIntBE(o,u,3),u-r+this.len}},exports.INT32_BE={len:4,get:(e,t)=>e.readInt32BE(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=-2147483648&&o<=2147483647),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeInt32BE(o,u),u-r+this.len}},exports.INT32_LE={len:4,get:(e,t)=>e.readInt32LE(t),put(n,r,o,l){e.equal(typeof r,"number"),e.equal(typeof o,"number"),e.ok(o>=-2147483648&&o<=2147483647),e.ok(r>=0),e.ok(this.len<=n.length);const u=t(n,r,this.len,l);return n.writeInt32LE(o,u),u-r+this.len}},exports.UINT64_LE={len:8,get(e,t){return u(e,t,this.len)},put(e,t,n){return s(e,n,t,this.len)}},exports.INT64_LE={len:8,get(e,t){return i(e,t,this.len)},put(e,t,n){return p(e,n,t,this.len)}},exports.UINT64_BE={len:8,get(e,t){return h(e,t,this.len)},put(e,t,n){return a(e,n,t,this.len)}},exports.INT64_BE={len:8,get(e,t){return f(e,t,this.len)},put(e,t,n){return c(e,n,t,this.len)}};class n{constructor(e){this.len=e}get(e,t){return null}}exports.IgnoreType=n;class r{constructor(e){this.len=e}get(e,t){return e.slice(t,t+this.len)}}exports.BufferType=r;class o{constructor(e,t){this.len=e,this.encoding=t}get(e,t){return e.toString(this.encoding,t,t+this.len)}}exports.StringType=o;class l{constructor(e){this.len=e}static decode(e,t,n){let r="";for(let o=t;o<n;++o)r+=l.codePointToString(l.singleByteDecoder(e[o]));return r}static inRange(e,t,n){return t<=e&&e<=n}static codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}static singleByteDecoder(e){if(l.inRange(e,0,127))return e;const t=l.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return l.decode(e,t,t+this.len)}}function u(e,t,n){n>>>=0;let r=e[t>>>=0],o=1,l=0;for(;++l<n&&(o*=256);)r+=e[t+l]*o;return r}function s(e,t,n,r){t=+t,r>>>=0;let o=1,l=0;for(e[n>>>=0]=255&t;++l<r&&(o*=256);)e[n+l]=t/o&255;return n+r}function i(e,t,n){n>>>=0;let r=e[t>>>=0],o=1,l=0;for(;++l<n&&(o*=256);)r+=e[t+l]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*n)),r}function p(e,t,n,r){t=+t;let o=0,l=1,u=0;for(e[n>>>=0]=255&t;++o<r&&(l*=256);)t<0&&0===u&&0!==e[n+o-1]&&(u=1),e[n+o]=(t/l>>0)-u&255;return n+r}function h(e,t,n){n>>>=0;let r=e[(t>>>=0)+--n],o=1;for(;n>0&&(o*=256);)r+=e[t+--n]*o;return r}function a(e,t,n,r){t=+t;let o=(r>>>=0)-1,l=1;for(e[(n>>>=0)+o]=255&t;--o>=0&&(l*=256);)e[n+o]=t/l&255;return n+r}function f(e,t,n){let r=n>>>=0,o=1,l=e[(t>>>=0)+--r];for(;r>0&&(o*=256);)l+=e[t+--r]*o;return l>=(o*=128)&&(l-=Math.pow(2,8*n)),l}function c(e,t,n,r){t=+t;let o=r-1,l=1,u=0;for(e[(n>>>=0)+o]=255&t;--o>=0&&(l*=256);)t<0&&0===u&&0!==e[n+o+1]&&(u=1),e[n+o]=(t/l>>0)-u&255;return n+r}l.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255],exports.AnsiStringType=l,exports.writeIntLE=p,exports.readUIntBE=h,exports.writeUIntBE=a,exports.readIntBE=f,exports.writeIntBE=c;
},{"assert":"TfPC"}],"O0hF":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function t(){e(this,t),this.warnings=[]}return n(t,[{key:"init",value:function(e,t,n){return this.metadata=e,this.tokenizer=t,this.options=n,this}}]),t}();exports.BasicParser=r;
},{}],"WTnS":[function(require,module,exports) {
"use strict";function e(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(l){return void r(l)}u.done?t(c):Promise.resolve(c).then(n,o)}function t(t){return function(){var r=this,n=arguments;return new Promise(function(o,a){var i=t.apply(r,n);function u(t){e(i,o,a,u,c,"next",t)}function c(t){e(i,o,a,u,c,"throw",t)}u(void 0)})}}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=l(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var h=require("debug"),k=require("../common/Util"),y=require("token-types"),g=require("../common/BasicParser"),d=h("music-metadata:parser:ID3v1");exports.Genres=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"];var m={len:128,get:function(e,t){var r=new b(3).get(e,t);return"TAG"===r?{header:r,title:new b(30).get(e,t+3),artist:new b(30).get(e,t+33),album:new b(30).get(e,t+63),year:new b(4).get(e,t+93),comment:new b(28).get(e,t+97),zeroByte:y.UINT8.get(e,t+127),track:y.UINT8.get(e,t+126),genre:y.UINT8.get(e,t+127)}:null}},b=function(e){function t(e){return n(this,t),i(this,s(t).call(this,e,"binary"))}return p(t,y.StringType),a(t,[{key:"get",value:function(e,r){var n=c(s(t.prototype),"get",this).call(this,e,r);return(n=(n=k.default.trimRightNull(n)).trim()).length>0?n:void 0}}]),t}(),v=function(e){function r(){return n(this,r),i(this,s(r).apply(this,arguments))}return p(r,g.BasicParser),a(r,[{key:"parse",value:function(){var e=t(regeneratorRuntime.mark(function e(){var t,n,o,a,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tokenizer.fileSize){e.next=3;break}return d("Skip checking for ID3v1 because the file-size is unknown"),e.abrupt("return");case 3:if(t=this.tokenizer.fileSize-m.len,!(this.tokenizer.position>t)){e.next=7;break}return d("Already consumed the last 128 bytes"),e.abrupt("return");case 7:return e.next=9,this.tokenizer.readToken(m,t);case 9:if(n=e.sent){for(d("ID3v1 header found at: pos=%s",this.tokenizer.fileSize-m.len),o=["title","artist","album","comment","track","year"],a=0;a<o.length;a++)n[i=o[a]]&&""!==n[i]&&this.addTag(i,n[i]);(u=r.getGenre(n.genre))&&this.addTag("genre",u)}else d("ID3v1 header not found at: pos=%s",this.tokenizer.fileSize-m.len);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addTag",value:function(e,t){this.metadata.addTag("ID3v1",e,t)}}],[{key:"getGenre",value:function(e){if(e<exports.Genres.length)return exports.Genres[e]}}]),r}();exports.ID3v1Parser=v;
},{"debug":"j+D9","../common/Util":"5e0M","token-types":"1rOY","../common/BasicParser":"O0hF"}],"QsE/":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("../id3v1/ID3v1Parser"),a=function(){function t(r,n){e(this,t),this.tagTypes=r,this.tagMap=n}return r(t,[{key:"mapGenericTag",value:function(e){e={id:e.id,value:e.value},this.postMap(e);var t=this.getCommonName(e.id);return t?{id:t,value:e.value}:null}},{key:"getCommonName",value:function(e){return this.tagMap[e]}},{key:"postMap",value:function(e){}}],[{key:"parseGenre",value:function(e){var t=e.trim().split(/\((.*?)\)/g).filter(function(e){return""!==e}),r=[],a=!0,i=!1,u=void 0;try{for(var o,l=t[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=o.value;/^\d+$/.test(s)&&!isNaN(parseInt(s,10))&&(s=n.Genres[s]),r.push(s)}}catch(c){i=!0,u=c}finally{try{a||null==l.return||l.return()}finally{if(i)throw u}}return r.filter(function(e){return void 0!==e}).join("/")}},{key:"fixPictureMimeType",value:function(e){switch(e=e.toLocaleLowerCase()){case"image/jpg":return"image/jpeg"}return e}},{key:"toIntOrNull",value:function(e){var t=parseInt(e,10);return isNaN(t)?null:t}},{key:"normalizeTrack",value:function(e){var t=e.toString().split("/");return{no:parseInt(t[0],10)||null,of:parseInt(t[1],10)||null}}}]),t}();a.maxRatingScore=1,exports.CommonTagMapper=a;
},{"../id3v1/ID3v1Parser":"WTnS"}],"oC4z":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(e,o){return!o||"object"!==t(o)&&"function"!=typeof o?r(e):o}function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(exports,"__esModule",{value:!0});var u=require("../common/GenericTagMapper"),f={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"},a=function(t){function r(){return e(this,r),o(this,n(r).call(this,["ID3v1"],f))}return c(r,u.CommonTagMapper),r}();exports.ID3v1TagMapper=a;
},{"../common/GenericTagMapper":"QsE/"}],"39L3":[function(require,module,exports) {
"use strict";function e(r){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(r,i){return!i||"object"!==e(i)&&"function"!=typeof i?t(r):i}function t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,r){for(var i=0;i<r.length;i++){var t=r[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function o(e,r,i){return r&&n(e.prototype,r),i&&n(e,i),e}function u(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&s(e,r)}function s(e,r){return(s=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}Object.defineProperty(exports,"__esModule",{value:!0});var c=require("../common/GenericTagMapper"),X=require("../common/Util"),T={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer","USLT:description":"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:replaygain_track_peak":"replaygain_track_peak","TXXX:replaygain_track_gain":"replaygain_track_gain"},l=function(e){function t(){return r(this,t),i(this,a(t).call(this,["ID3v2.3","ID3v2.4"],T))}return u(t,c.CommonTagMapper),o(t,null,[{key:"toRating",value:function(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*c.CommonTagMapper.maxRatingScore:void 0}}}]),o(t,[{key:"postMap",value:function(e){switch(e.id){case"UFID":"http://musicbrainz.org"===e.value.owner_identifier&&(e.id+=":"+e.value.owner_identifier,e.value=X.default.decodeString(e.value.identifier,"iso-8859-1"));break;case"PRIV":switch(e.value.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=":"+e.value.owner_identifier,e.value=4===e.value.data.length?e.value.data.readUInt32LE(0):null}break;case"COMM":e.value=e.value?e.value.text:null;break;case"POPM":e.value=t.toRating(e.value)}}}]),t}();exports.ID3v24TagMapper=l;
},{"../common/GenericTagMapper":"QsE/","../common/Util":"5e0M"}],"+BSV":[function(require,module,exports) {
"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(e)}function e(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function t(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}function i(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function n(r){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}function o(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function a(r,e,t){return e&&o(r.prototype,e),t&&o(r,t),r}function u(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&s(r,e)}function s(r,e){return(s=Object.setPrototypeOf||function(r,e){return r.__proto__=e,r})(r,e)}Object.defineProperty(exports,"__esModule",{value:!0});var c=require("../common/GenericTagMapper"),l={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"},M=function(r){function i(){return e(this,i),t(this,n(i).call(this,["asf"],l))}return u(i,c.CommonTagMapper),a(i,null,[{key:"toRating",value:function(r){return{rating:parseFloat(r+1)/5}}}]),a(i,[{key:"postMap",value:function(r){switch(r.id){case"WM/SharedUserRating":var e=r.id.split(":");r.value=i.toRating(r.value),r.id=e[0]}}}]),i}();exports.AsfTagMapper=M;
},{"../common/GenericTagMapper":"QsE/"}],"xe48":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(e,o){return!o||"object"!==t(o)&&"function"!=typeof o?r(e):o}function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(exports,"__esModule",{value:!0});var u=require("../common/GenericTagMapper");exports.id3v22TagMap={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"work",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website","COM:iTunPGAP":"gapless"};var a=function(t){function r(){return e(this,r),o(this,n(r).call(this,["ID3v2.2"],exports.id3v22TagMap))}return i(r,u.CommonTagMapper),r}();exports.ID3v22TagMapper=a;
},{"../common/GenericTagMapper":"QsE/"}],"8e34":[function(require,module,exports) {
"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(e)}function e(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function t(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function i(r,e,i){return e&&t(r.prototype,e),i&&t(r,i),r}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?n(e):t}function n(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function a(r){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}function c(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&u(r,e)}function u(r,e){return(u=Object.setPrototypeOf||function(r,e){return r.__proto__=e,r})(r,e)}Object.defineProperty(exports,"__esModule",{value:!0});var s=require("../common/GenericTagMapper"),l={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website"},p=function(r){function t(){e(this,t);var r={};for(var i in l)r[i.toUpperCase()]=l[i];return o(this,a(t).call(this,["APEv2"],r))}return c(t,s.CommonTagMapper),i(t,[{key:"getCommonName",value:function(r){return this.tagMap[r.toUpperCase()]}}]),t}();exports.APEv2TagMapper=p;
},{"../common/GenericTagMapper":"QsE/"}],"a2T+":[function(require,module,exports) {
"use strict";function e(i){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(i)}function i(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function t(i,t){return!t||"object"!==e(t)&&"function"!=typeof t?o(i):t}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(i&&i.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),i&&s(e,i)}function s(e,i){return(s=Object.setPrototypeOf||function(e,i){return e.__proto__=i,e})(e,i)}Object.defineProperty(exports,"__esModule",{value:!0});var p=require("../common/GenericTagMapper"),a={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear",desc:"description",ldes:"description"};exports.tagType="iTunes";var c=function(e){function o(){return i(this,o),t(this,n(o).call(this,[exports.tagType],a))}return r(o,p.CommonTagMapper),o}();exports.MP4TagMapper=c;
},{"../common/GenericTagMapper":"QsE/"}],"ZM9N":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(e,r){return!r||"object"!==t(r)&&"function"!=typeof r?i(e):r}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(exports,"__esModule",{value:!0});var c=require("../../common/GenericTagMapper"),S={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak"},u=function(t){function i(){return e(this,i),r(this,o(i).call(this,["vorbis"],S))}return s(i,c.CommonTagMapper),a(i,null,[{key:"toRating",value:function(t,e){return{source:t?t.toLowerCase():t,rating:parseFloat(e)*c.CommonTagMapper.maxRatingScore}}}]),a(i,[{key:"postMap",value:function(t){if(0===t.id.indexOf("RATING:")){var e=t.id.split(":");t.value=i.toRating(e[1],t.value),t.id=e[0]}}}]),i}();exports.VorbisTagMapper=u;
},{"../../common/GenericTagMapper":"QsE/"}],"WbCo":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?o(t):n}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var f=require("../common/GenericTagMapper");exports.riffInfoTagMap={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};var u=function(e){function o(){return t(this,o),n(this,r(o).call(this,["exif"],exports.riffInfoTagMap))}return i(o,f.CommonTagMapper),o}();exports.RiffInfoTagMapper=u;
},{"../common/GenericTagMapper":"QsE/"}],"CeTJ":[function(require,module,exports) {
"use strict";function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e,r){for(var a=0;a<r.length;a++){var p=r[a];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(e,p.key,p)}}function a(e,a,p){return a&&r(e.prototype,a),p&&r(e,p),e}Object.defineProperty(exports,"__esModule",{value:!0});var p=require("../id3v1/ID3v1TagMap"),n=require("../id3v2/ID3v24TagMapper"),t=require("../asf/AsfTagMapper"),i=require("../id3v2/ID3v22TagMapper"),o=require("../apev2/APEv2TagMapper"),g=require("../mp4/MP4TagMapper"),f=require("../ogg/vorbis/VorbisTagMapper"),u=require("../riff/RiffInfoTagMap"),s=function(){function r(){var a=this;e(this,r),this.tagMappers={},[new p.ID3v1TagMapper,new i.ID3v22TagMapper,new n.ID3v24TagMapper,new g.MP4TagMapper,new g.MP4TagMapper,new f.VorbisTagMapper,new o.APEv2TagMapper,new t.AsfTagMapper,new u.RiffInfoTagMapper].forEach(function(e){a.registerTagMapper(e)})}return a(r,[{key:"mapTag",value:function(e,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(r);throw new Error("No generic tag mapper defined for tag-format: "+e)}},{key:"registerTagMapper",value:function(e){var r=!0,a=!1,p=void 0;try{for(var n,t=e.tagTypes[Symbol.iterator]();!(r=(n=t.next()).done);r=!0){var i=n.value;this.tagMappers[i]=e}}catch(o){a=!0,p=o}finally{try{r||null==t.return||t.return()}finally{if(a)throw p}}}}]),r}();exports.CombinedTagMapper=s;
},{"../id3v1/ID3v1TagMap":"oC4z","../id3v2/ID3v24TagMapper":"39L3","../asf/AsfTagMapper":"+BSV","../id3v2/ID3v22TagMapper":"xe48","../apev2/APEv2TagMapper":"8e34","../mp4/MP4TagMapper":"a2T+","../ogg/vorbis/VorbisTagMapper":"ZM9N","../riff/RiffInfoTagMap":"WbCo"}],"34Xp":[function(require,module,exports) {
"use strict";function t(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function i(t,i){for(var a=0;a<i.length;a++){var e=i[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function a(t,a,e){return a&&i(t.prototype,a),e&&i(t,e),t}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("debug"),o=require("./GenericTagTypes"),r=require("./CombinedTagMapper"),n=require("./GenericTagMapper"),s=require("./Util"),c=e("music-metadata:collector"),u=["APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","ID3v1"],l=function(){function i(a){t(this,i),this.opts=a,this.format={tagTypes:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null}},this.commonOrigin={},this.originPriority={},this.tagMapper=new r.CombinedTagMapper;for(var e=1,o=0;o<u.length;o++){var n=u[o];this.originPriority[n]=e++}this.originPriority.artificial=500,this.originPriority.id3v1=600}return a(i,[{key:"hasAny",value:function(){for(var t in this.native)return!0;return!1}},{key:"setFormat",value:function(t,i){c("format: ".concat(t," = ").concat(i)),this.format[t]=i,this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:t,value:i}})}},{key:"addTag",value:function(t,i,a){c("tag ".concat(t,".").concat(i," = ").concat(a)),this.native[t]||(this.format.tagTypes.push(t),this.native[t]=[]),this.native[t].push({id:i,value:a}),this.toCommon(t,i,a)}},{key:"getNativeMetadata",value:function(){return{format:this.format,native:this.native}}},{key:"postMap",value:function(t,i){switch(i.id){case"artist":if(this.commonOrigin.artist===this.originPriority[t])return this.postMap("artificial",{id:"artists",value:i.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:i.value});break;case"artists":if(!(this.common.artist&&this.commonOrigin.artist!==this.originPriority.artificial||this.common.artists&&-1!==this.common.artists.indexOf(i.value))){var a={id:"artist",value:m((this.common.artists||[]).concat([i.value]))};this.setGenericTag("artificial",a)}break;case"genre":i.value=n.CommonTagMapper.parseGenre(i.value);break;case"picture":i.value.format=n.CommonTagMapper.fixPictureMimeType(i.value.format);break;case"totaltracks":return void(this.common.track.of=n.CommonTagMapper.toIntOrNull(i.value));case"totaldiscs":return void(this.common.disk.of=n.CommonTagMapper.toIntOrNull(i.value));case"track":case"disk":var e=this.common[i.id].of;return this.common[i.id]=n.CommonTagMapper.normalizeTrack(i.value),void(this.common[i.id].of=null!=e?e:this.common[i.id].of);case"year":case"originalyear":i.value=parseInt(i.value,10);break;case"date":var o=parseInt(i.value.substr(0,4),10);o&&!isNaN(o)&&(this.common.year=o);break;case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":i.value="string"==typeof i.value?parseInt(i.value,10):i.value;break;case"replaygain_track_gain":case"replaygain_track_peak":i.value=s.toRatio(i.value);break;case"gapless":i.value="1"===i.value}this.setGenericTag(t,i)}},{key:"toCommonMetadata",value:function(){return{format:this.format,native:this.opts.native?this.native:void 0,common:this.common}}},{key:"toCommon",value:function(t,i,a){var e={id:i,value:a},o=this.tagMapper.mapTag(t,e);o&&this.postMap(t,o)}},{key:"setGenericTag",value:function(t,i){c("common.".concat(i.id," = ").concat(i.value));var a=this.commonOrigin[i.id]||1e3,e=this.originPriority[t];if(o.isSingleton(i.id)){if(!(e<=a))return c("Ignore native tag (singleton): ".concat(t,".").concat(i.id," = ").concat(i.value));this.common[i.id]=i.value,this.commonOrigin[i.id]=e}else if(e===a)o.isUnique(i.id)&&-1!==this.common[i.id].indexOf(i.value)?c("Ignore duplicate value: ".concat(t,".").concat(i.id," = ").concat(i.value)):this.common[i.id].push(i.value);else{if(!(e<a))return c("Ignore native tag (list): ".concat(t,".").concat(i.id," = ").concat(i.value));this.common[i.id]=[i.value],this.commonOrigin[i.id]=e}this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:i.id,value:i.value}})}}]),i}();function m(t){return t.length>2?t.slice(0,t.length-1).join(", ")+" & "+t[t.length-1]:t.join(" & ")}exports.MetadataCollector=l,exports.joinArtists=m;
},{"debug":"j+D9","./GenericTagTypes":"Wlj4","./CombinedTagMapper":"CeTJ","./GenericTagMapper":"QsE/","./Util":"5e0M"}],"3ujr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("token-types"),r=require("../common/Util");!function(e){e[e.Other=0]="Other",e[e["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",e[e["Other file icon"]=2]="Other file icon",e[e["Cover (front)"]=3]="Cover (front)",e[e["Cover (back)"]=4]="Cover (back)",e[e["Leaflet page"]=5]="Leaflet page",e[e["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",e[e["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",e[e["Artist/performer"]=8]="Artist/performer",e[e.Conductor=9]="Conductor",e[e["Band/Orchestra"]=10]="Band/Orchestra",e[e.Composer=11]="Composer",e[e["Lyricist/text writer"]=12]="Lyricist/text writer",e[e["Recording Location"]=13]="Recording Location",e[e["During recording"]=14]="During recording",e[e["During performance"]=15]="During performance",e[e["Movie/video screen capture"]=16]="Movie/video screen capture",e[e["A bright coloured fish"]=17]="A bright coloured fish",e[e.Illustration=18]="Illustration",e[e["Band/artist logotype"]=19]="Band/artist logotype",e[e["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"}(e=exports.AttachedPictureType||(exports.AttachedPictureType={})),exports.UINT32SYNCSAFE={get:function(e,t){return 127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21},len:4},exports.ID3v2Header={len:10,get:function(e,o){return{fileIdentifier:new t.StringType(3,"ascii").get(e,o),version:{major:t.INT8.get(e,o+3),revision:t.INT8.get(e,o+4)},flags:{raw:t.INT8.get(e,o+4),unsynchronisation:r.default.strtokBITSET.get(e,o+5,7),isExtendedHeader:r.default.strtokBITSET.get(e,o+5,6),expIndicator:r.default.strtokBITSET.get(e,o+5,5),footer:r.default.strtokBITSET.get(e,o+5,4)},size:exports.UINT32SYNCSAFE.get(e,o+6)}}},exports.ExtendedHeader={len:10,get:function(e,o){return{size:t.UINT32_BE.get(e,o),extendedFlags:t.UINT16_BE.get(e,o+4),sizeOfPadding:t.UINT32_BE.get(e,o+6),crcDataPresent:r.default.strtokBITSET.get(e,o+4,31)}}},exports.TextEncodingToken={len:1,get:function(e,t){switch(e.readUInt8(t)){case 0:return{encoding:"iso-8859-1"};case 1:return{encoding:"utf16",bom:!0};case 2:return{encoding:"utf16",bom:!1};case 3:default:return{encoding:"utf8",bom:!1}}}};
},{"token-types":"1rOY","../common/Util":"5e0M"}],"toCx":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function a(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function t(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var i=require("debug"),n=require("token-types"),c=require("../common/Util"),d=require("./ID3v2Token"),u=i("music-metadata:id3v2:frame-parser"),s="iso-8859-1",l=function(){function t(){a(this,t)}return r(t,null,[{key:"readData",value:function(a,r,i,l){var o,f=d.TextEncodingToken.get(a,0),g=f.encoding,p=f.bom,T=a.length,v=0,k=[],b=t.getNullTerminatorLength(g),m={};switch(u("Parsing tag type=".concat(r,", encoding=").concat(g,", bom=").concat(p)),"TXXX"!==r&&"T"===r[0]?"T*":r){case"T*":case"IPLS":var S=c.default.decodeString(a.slice(1),g).replace(/\x00+$/,"");switch(r){case"TMCL":case"TIPL":case"IPLS":k=t.splitValue(4,S),k=t.functionList(k);break;case"TRK":case"TRCK":case"TPOS":k=S;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":k=t.splitValue(i,S);break;default:k=i>=4?t.splitValue(i,S):[S]}break;case"TXXX":k={description:(k=t.readIdentifierAndData(a,v+1,T,g)).id,text:t.splitValue(i,c.default.decodeString(k.data,g).replace(/\x00+$/,""))};break;case"PIC":case"APIC":if(l){var y={};switch(v+=1,i){case 2:y.format=c.default.decodeString(a.slice(v,v+3),g),v+=3;break;case 3:case 4:o=c.default.findZero(a,v,T,s),y.format=c.default.decodeString(a.slice(v,o),s),v=o+1;break;default:throw new Error("Warning: unexpected major versionIndex: "+i)}y.format=t.fixPictureMimeType(y.format),y.type=d.AttachedPictureType[a[v]],v+=1,o=c.default.findZero(a,v,T,g),y.description=c.default.decodeString(a.slice(v,o),g),v=o+b,y.data=e.from(a.slice(v,T)),k=y}break;case"CNT":case"PCNT":k=n.UINT32_BE.get(a,0);break;case"SYLT":for(v+=7,k=[];v<T;){var P=a.slice(v,v=c.default.findZero(a,v,T,g));v+=5,k.push(c.default.decodeString(P,g))}break;case"ULT":case"USLT":case"COM":case"COMM":v+=1,m.language=c.default.decodeString(a.slice(v,v+3),s),v+=3,o=c.default.findZero(a,v,T,g),m.description=c.default.decodeString(a.slice(v,o),g),v=o+b,m.text=c.default.decodeString(a.slice(v,T),g).replace(/\x00+$/,""),k=[m];break;case"UFID":k={owner_identifier:(k=t.readIdentifierAndData(a,v,T,s)).id,identifier:k.data};break;case"PRIV":k={owner_identifier:(k=t.readIdentifierAndData(a,v,T,s)).id,data:k.data};break;case"POPM":o=c.default.findZero(a,v,T,s);var h=c.default.decodeString(a.slice(v,o),s),I=T-(v=o+1);k={email:h,rating:a.readUInt8(v),counter:I>=5?a.readUInt32BE(v+1):void 0};break;case"GEOB":o=c.default.findZero(a,v+1,T,g);var O=c.default.decodeString(a.slice(v+1,o),s);v=o+1,o=c.default.findZero(a,v,T-v,g);var w=c.default.decodeString(a.slice(v+1,o),s);v=o+1,o=c.default.findZero(a,v,T-v,g),k={type:O,filename:w,description:c.default.decodeString(a.slice(v+1,o),s),data:a.slice(v+1,T)};break;case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":k=c.default.decodeString(a.slice(v,o),g);break;case"WXXX":o=c.default.findZero(a,v+1,T,g);var x=c.default.decodeString(a.slice(v+1,o),s);v=o+1,o=c.default.findZero(a,v,T-v,g),k={description:x,url:c.default.decodeString(a.slice(v,T-v),g)};break;case"MCDI":k=a.slice(0,T);break;default:u("Warning: unsupported id3v2-tag-type: "+r)}return k}},{key:"fixPictureMimeType",value:function(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}},{key:"functionList",value:function(e){for(var a={},t=0;t+1<e.length;t+=2){var r=e[t+1].split(",");a[e[t]]=a.hasOwnProperty(e[t])?a[e[t]].concat(r):r}return a}},{key:"splitValue",value:function(e,a){var r=a.split(e>=4?/\x00/g:/\//g);return t.trimArray(r)}},{key:"trimArray",value:function(e){for(var a=0;a<e.length;++a)e[a]=e[a].replace(/\x00+$/,"").trim();return e}},{key:"readIdentifierAndData",value:function(e,a,r,i){var n=c.default.findZero(e,a,r,i),d=c.default.decodeString(e.slice(a,n),i);return a=n+t.getNullTerminatorLength(i),{id:d,data:e.slice(a,r)}}},{key:"getTextEncoding",value:function(e){switch(u("encoding=".concat(e)),e){case 0:return"iso-8859-1";case 1:case 2:return"utf16";case 3:default:return"utf8"}}},{key:"getNullTerminatorLength",value:function(e){switch(e){case"utf16":return 2;default:return 1}}}]),t}();exports.default=l;
},{"debug":"j+D9","token-types":"1rOY","../common/Util":"5e0M","./ID3v2Token":"3ujr","buffer":"z1tx"}],"pIqu":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function r(e,r,t,a,n,i,s){try{var o=e[i](s),u=o.value}catch(c){return void t(c)}o.done?r(u):Promise.resolve(u).then(a,n)}function t(e){return function(){var t=this,a=arguments;return new Promise(function(n,i){var s=e.apply(t,a);function o(e){r(s,n,i,o,u,"next",e)}function u(e){r(s,n,i,o,u,"throw",e)}o(void 0)})}}function a(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function n(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function i(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}Object.defineProperty(exports,"__esModule",{value:!0});var s=require("token-types"),o=require("../common/Util"),u=require("./FrameParser"),c=require("./ID3v2Token"),d=function(){function r(){a(this,r)}return i(r,[{key:"parse",value:function(){var e=t(regeneratorRuntime.mark(function e(r,t,a){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.tokenizer=t,this.metadata=r,this.options=a,e.next=5,this.tokenizer.readToken(c.ID3v2Header);case 5:if("ID3"===(n=e.sent).fileIdentifier){e.next=8;break}throw new Error("expected ID3-header file-identifier 'ID3' was not found");case 8:if(this.id3Header=n,this.headerType="ID3v2."+n.version.major,!n.flags.isExtendedHeader){e.next=14;break}return e.abrupt("return",this.parseExtendedHeader());case 14:return e.abrupt("return",this.parseId3Data(n.size));case 15:case"end":return e.stop()}},e,this)}));return function(r,t,a){return e.apply(this,arguments)}}()},{key:"parseExtendedHeader",value:function(){var e=t(regeneratorRuntime.mark(function e(){var r,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(c.ExtendedHeader);case 2:if(r=e.sent,!((t=r.size-c.ExtendedHeader.len)>0)){e.next=8;break}return e.abrupt("return",this.parseExtendedHeaderData(t,r.size));case 8:return e.abrupt("return",this.parseId3Data(this.id3Header.size-r.size));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseExtendedHeaderData",value:function(){var r=t(regeneratorRuntime.mark(function r(t,a){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.alloc(t),r.next=3,this.tokenizer.readBuffer(n,0,t);case 3:return r.abrupt("return",this.parseId3Data(this.id3Header.size-a));case 4:case"end":return r.stop()}},r,this)}));return function(e,t){return r.apply(this,arguments)}}()},{key:"parseId3Data",value:function(){var a=t(regeneratorRuntime.mark(function t(a){var n,i,s,o,u,c,d,f,l,v,h,p,k,g,m,x,y,b,T,w,I,E,D,H,S;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.alloc(a),t.next=3,this.tokenizer.readBuffer(n,0,a);case 3:i=!0,s=!1,o=void 0,t.prev=6,u=this.parseMetadata(n)[Symbol.iterator]();case 8:if(i=(c=u.next()).done){t.next=80;break}if("TXXX"!==(d=c.value).id){t.next=32;break}for(f=!0,l=!1,v=void 0,t.prev=14,h=d.value.text[Symbol.iterator]();!(f=(p=h.next()).done);f=!0)k=p.value,this.addTag(r.makeDescriptionTagName(d.id,d.value.description),k);t.next=22;break;case 18:t.prev=18,t.t0=t.catch(14),l=!0,v=t.t0;case 22:t.prev=22,t.prev=23,f||null==h.return||h.return();case 25:if(t.prev=25,!l){t.next=28;break}throw v;case 28:return t.finish(25);case 29:return t.finish(22);case 30:t.next=77;break;case 32:if("COM"!==d.id){t.next=54;break}for(g=!0,m=!1,x=void 0,t.prev=36,y=d.value[Symbol.iterator]();!(g=(b=y.next()).done);g=!0)T=b.value,this.addTag(r.makeDescriptionTagName(d.id,T.description),T.text);t.next=44;break;case 40:t.prev=40,t.t1=t.catch(36),m=!0,x=t.t1;case 44:t.prev=44,t.prev=45,g||null==y.return||y.return();case 47:if(t.prev=47,!m){t.next=50;break}throw x;case 50:return t.finish(47);case 51:return t.finish(44);case 52:t.next=77;break;case 54:if(!Array.isArray(d.value)){t.next=76;break}for(w=!0,I=!1,E=void 0,t.prev=58,D=d.value[Symbol.iterator]();!(w=(H=D.next()).done);w=!0)S=H.value,this.addTag(d.id,S);t.next=66;break;case 62:t.prev=62,t.t2=t.catch(58),I=!0,E=t.t2;case 66:t.prev=66,t.prev=67,w||null==D.return||D.return();case 69:if(t.prev=69,!I){t.next=72;break}throw E;case 72:return t.finish(69);case 73:return t.finish(66);case 74:t.next=77;break;case 76:this.addTag(d.id,d.value);case 77:i=!0,t.next=8;break;case 80:t.next=86;break;case 82:t.prev=82,t.t3=t.catch(6),s=!0,o=t.t3;case 86:t.prev=86,t.prev=87,i||null==u.return||u.return();case 89:if(t.prev=89,!s){t.next=92;break}throw o;case 92:return t.finish(89);case 93:return t.finish(86);case 94:case"end":return t.stop()}},t,this,[[6,82,86,94],[14,18,22,30],[23,,25,29],[36,40,44,52],[45,,47,51],[58,62,66,74],[67,,69,73],[87,,89,93]])}));return function(e){return a.apply(this,arguments)}}()},{key:"addTag",value:function(e,r){this.metadata.addTag(this.headerType,e,r)}},{key:"parseMetadata",value:function(e){for(var t=0,a=[];t!==e.length;){var n=r.getFrameHeaderLength(this.id3Header.version.major);if(t+n>e.length)break;var i=e.slice(t,t+=n),s=r.readFrameHeader(i,this.id3Header.version.major);if(""===s.id||"\0\0\0\0"===s.id||-1==="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(s.id[0]))break;var o=e.slice(t,t+=s.length),u=r.readFrameData(o,s,this.id3Header.version.major,!this.options.skipCovers);a.push({id:s.id,value:u})}return a}}],[{key:"removeUnsyncBytes",value:function(e){for(var r=0,t=0;r<e.length-1;)r!==t&&(e[t]=e[r]),r+=255===e[r]&&0===e[r+1]?2:1,t++;return r<e.length&&(e[t++]=e[r++]),e.slice(0,t)}},{key:"readFrameHeader",value:function(e,t){var a;switch(t){case 2:a={id:e.toString("ascii",0,3),length:s.UINT24_BE.get(e,3)};break;case 3:a={id:e.toString("ascii",0,4),length:s.UINT32_BE.get(e,4),flags:r.readFrameFlags(e.slice(8,10))};break;case 4:a={id:e.toString("ascii",0,4),length:c.UINT32SYNCSAFE.get(e,4),flags:r.readFrameFlags(e.slice(8,10))};break;default:throw new Error("Unexpected majorVer: "+t)}return a}},{key:"getFrameHeaderLength",value:function(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}},{key:"readFrameFlags",value:function(e){return{status:{tag_alter_preservation:o.default.strtokBITSET.get(e,0,6),file_alter_preservation:o.default.strtokBITSET.get(e,0,5),read_only:o.default.strtokBITSET.get(e,0,4)},format:{grouping_identity:o.default.strtokBITSET.get(e,1,7),compression:o.default.strtokBITSET.get(e,1,3),encryption:o.default.strtokBITSET.get(e,1,2),unsynchronisation:o.default.strtokBITSET.get(e,1,1),data_length_indicator:o.default.strtokBITSET.get(e,1,0)}}}},{key:"readFrameData",value:function(e,t,a,n){switch(a){case 2:return u.default.readData(e,t.id,a,n);case 3:case 4:return t.flags.format.unsynchronisation&&(e=r.removeUnsyncBytes(e)),t.flags.format.data_length_indicator&&(e=e.slice(4,e.length)),u.default.readData(e,t.id,a,n);default:throw new Error("Unexpected majorVer: "+a)}}},{key:"makeDescriptionTagName",value:function(e,r){return e+(r?":"+r:"")}}]),r}();exports.ID3v2Parser=d;
},{"token-types":"1rOY","../common/Util":"5e0M","./FrameParser":"toCx","./ID3v2Token":"3ujr","buffer":"z1tx"}],"P2sd":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var r=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Util"),n=/^[\w-©][\w-\x000-3]/;exports.FourCcToken={len:4,get:function(r,t){var o=r.toString("binary",t,t+exports.FourCcToken.len);if(!o.match(n))throw new Error("FourCC contains invalid characters: ".concat(e.default.a2hex(o)));return o},put:function(e,n,t){var o=r.from(t,"binary");if(4!==o.length)throw new Error("Invalid length");return o.copy(e,n)}};
},{"./Util":"5e0M","buffer":"z1tx"}],"Hvar":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function r(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("token-types"),a=require("assert"),i=require("../common/FourCC"),o=function(){function n(r,t){e(this,n),this.isAifc=t;var i=t?22:18;a.ok(r.chunkSize>=i,"COMMON CHUNK size should always be at least ".concat(i)),this.len=r.chunkSize}return r(n,[{key:"get",value:function(e,n){var r=e.readUInt16BE(n+8)-16398,a=e.readUInt16BE(n+8+2),o={numChannels:e.readUInt16BE(n),numSampleFrames:e.readUInt32BE(n+2),sampleSize:e.readUInt16BE(n+6),sampleRate:r<0?a>>Math.abs(r):a<<r};if(this.isAifc){if(o.compressionType=i.FourCcToken.get(e,n+18),this.len>22){var s=e.readInt8(n+22);if(23+s+(s+1)%2!==this.len)throw new Error("Illegal pstring length");o.compressionName=new t.StringType(s,"binary").get(e,n+23)}}else o.compressionName="PCM";return o}}]),n}();exports.Common=o;
},{"token-types":"1rOY","assert":"TfPC","../common/FourCC":"P2sd"}],"rTYW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../common/FourCC");exports.Header={len:8,get:function(r,t){return{chunkID:e.FourCcToken.get(r,t),chunkSize:r.readUInt32BE(t+4)}}};
},{"../common/FourCC":"P2sd"}],"iFTO":[function(require,module,exports) {
var process = require("process");
var n=require("process");function e(e,r,t,c){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,l,u=arguments.length;switch(u){case 0:case 1:return n.nextTick(e);case 2:return n.nextTick(function(){e.call(null,r)});case 3:return n.nextTick(function(){e.call(null,r,t)});case 4:return n.nextTick(function(){e.call(null,r,t,c)});default:for(i=new Array(u-1),l=0;l<i.length;)i[l++]=arguments[l];return n.nextTick(function(){e.apply(null,i)})}}!n.version||0===n.version.indexOf("v0.")||0===n.version.indexOf("v1.")&&0!==n.version.indexOf("v1.8.")?module.exports={nextTick:e}:module.exports=n;
},{"process":"g5I+"}],"wIHY":[function(require,module,exports) {
"use strict";var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function r(e){console&&console.warn&&console.warn(e)}e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}module.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function f(e,t,n,i){var o,s,f;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),f=s[t]),void 0===f)f=s[t]=n,++e._eventsCount;else if("function"==typeof f?f=s[t]=i?[n,f]:[f,n]:i?f.unshift(n):f.push(n),(o=u(e))>0&&f.length>o&&!f.warned){f.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=e,p.type=t,p.count=f.length,r(p)}return e}function p(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,n(this.listener,this.target,e))}function v(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=p.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?y(i):c(i,i.length)}function a(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function c(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function l(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function y(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var f=o[e];if(void 0===f)return!1;if("function"==typeof f)n(f,this,t);else{var p=f.length,v=c(f,p);for(r=0;r<p;++r)n(v[r],this,t)}return!0},o.prototype.addListener=function(e,t){return f(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return f(this,e,t,!0)},o.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,v(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,v(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():l(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):a.call(e,t)},o.prototype.listenerCount=a,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};
},{}],"o232":[function(require,module,exports) {
module.exports=require("events").EventEmitter;
},{"events":"wIHY"}],"gI/y":[function(require,module,exports) {

var r=require("buffer"),e=r.Buffer;function n(r,e){for(var n in r)e[n]=r[n]}function o(r,n,o){return e(r,n,o)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?module.exports=r:(n(r,exports),exports.Buffer=o),n(e,o),o.from=function(r,n,o){if("number"==typeof r)throw new TypeError("Argument must not be a number");return e(r,n,o)},o.alloc=function(r,n,o){if("number"!=typeof r)throw new TypeError("Argument must be a number");var f=e(r);return void 0!==n?"string"==typeof o?f.fill(n,o):f.fill(n):f.fill(0),f},o.allocUnsafe=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return e(r)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)};
},{"buffer":"z1tx"}],"kj8s":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var r=require("buffer").Buffer;function t(r){return Array.isArray?Array.isArray(r):"[object Array]"===a(r)}function e(r){return"boolean"==typeof r}function n(r){return null===r}function o(r){return null==r}function i(r){return"number"==typeof r}function u(r){return"string"==typeof r}function s(r){return"symbol"==typeof r}function f(r){return void 0===r}function p(r){return"[object RegExp]"===a(r)}function c(r){return"object"==typeof r&&null!==r}function l(r){return"[object Date]"===a(r)}function y(r){return"[object Error]"===a(r)||r instanceof Error}function x(r){return"function"==typeof r}function b(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r}function a(r){return Object.prototype.toString.call(r)}exports.isArray=t,exports.isBoolean=e,exports.isNull=n,exports.isNullOrUndefined=o,exports.isNumber=i,exports.isString=u,exports.isSymbol=s,exports.isUndefined=f,exports.isRegExp=p,exports.isObject=c,exports.isDate=l,exports.isError=y,exports.isFunction=x,exports.isPrimitive=b,exports.isBuffer=r.isBuffer;
},{"buffer":"z1tx"}],"sC8V":[function(require,module,exports) {

},{}],"m36/":[function(require,module,exports) {

"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var n=require("safe-buffer").Buffer,e=require("util");function i(t,n,e){t.copy(n,e)}module.exports=function(){function e(){t(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(t){var n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length},e.prototype.unshift=function(t){var n={data:t,next:this.head};0===this.length&&(this.tail=n),this.head=n,++this.length},e.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(t){if(0===this.length)return"";for(var n=this.head,e=""+n.data;n=n.next;)e+=t+n.data;return e},e.prototype.concat=function(t){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var e=n.allocUnsafe(t>>>0),h=this.head,a=0;h;)i(h.data,e,a),a+=h.data.length,h=h.next;return e},e}(),e&&e.inspect&&e.inspect.custom&&(module.exports.prototype[e.inspect.custom]=function(){var t=e.inspect({length:this.length});return this.constructor.name+" "+t});
},{"safe-buffer":"gI/y","util":"sC8V"}],"Umu+":[function(require,module,exports) {
"use strict";var t=require("process-nextick-args");function e(e,a){var r=this,s=this._readableState&&this._readableState.destroyed,d=this._writableState&&this._writableState.destroyed;return s||d?(a?a(e):!e||this._writableState&&this._writableState.errorEmitted||t.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!a&&e?(t.nextTick(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):a&&a(e)}),this)}function a(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function i(t,e){t.emit("error",e)}module.exports={destroy:e,undestroy:a};
},{"process-nextick-args":"iFTO"}],"hQaz":[function(require,module,exports) {
var global = arguments[3];
var r=arguments[3];function t(r,t){if(e("noDeprecation"))return r;var n=!1;return function(){if(!n){if(e("throwDeprecation"))throw new Error(t);e("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return r.apply(this,arguments)}}function e(t){try{if(!r.localStorage)return!1}catch(n){return!1}var e=r.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}module.exports=t;
},{}],"pX9p":[function(require,module,exports) {
var process = require("process");

var global = arguments[3];
var e=require("process"),t=arguments[3],n=require("process-nextick-args");function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){W(t,e)}}module.exports=g;var o,s=n.nextTick;g.WritableState=y;var f=require("core-util-is");f.inherits=require("inherits");var u={deprecate:require("util-deprecate")},a=require("./internal/streams/stream"),c=require("safe-buffer").Buffer,l=t.Uint8Array||function(){};function d(e){return c.from(e)}function h(e){return c.isBuffer(e)||e instanceof l}var b,p=require("./internal/streams/destroy");function w(){}function y(e,t){o=o||require("./_stream_duplex"),e=e||{};var n=t instanceof o;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,s=e.writableHighWaterMark,f=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(s||0===s)?s:f,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===e.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){S(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function g(e){if(o=o||require("./_stream_duplex"),!(b.call(g,this)||this instanceof o))return new g(e);this._writableState=new y(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function k(e,t){var r=new Error("write after end");e.emit("error",r),n.nextTick(t,r)}function v(e,t,r,i){var o=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),n.nextTick(i,s),o=!1),o}function q(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n)),t}function _(e,t,n,r,i,o){if(!n){var s=q(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var f=t.objectMode?1:r.length;t.length+=f;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var a=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},a?a.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else m(e,t,!1,f,r,i,o);return u}function m(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function R(e,t,r,i,o){--t.pendingcb,r?(n.nextTick(o,i),n.nextTick(T,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(o(i),e._writableState.errorEmitted=!0,e.emit("error",i),T(e,t))}function x(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function S(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(x(n),t)R(e,n,r,t,i);else{var o=E(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||j(e,n),r?s(M,e,n,o,i):M(e,n,o,i)}}function M(e,t,n,r){n||B(e,t),t.pendingcb--,r(),T(e,t)}function B(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function j(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,o=new Array(r),s=t.corkedRequestsFree;s.entry=n;for(var f=0,u=!0;n;)o[f]=n,n.isBuf||(u=!1),n=n.next,f+=1;o.allBuffers=u,m(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;n;){var a=n.chunk,c=n.encoding,l=n.callback;if(m(e,t,!1,t.objectMode?1:a.length,a,c,l),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function E(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),T(e,t)})}function P(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,n.nextTick(C,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function T(e,t){var n=E(t);return n&&(P(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}function F(e,t,r){t.ending=!0,T(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function W(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}f.inherits(g,a),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:u.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(b=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(e){return!!b.call(this,e)||this===g&&(e&&e._writableState instanceof y)}})):b=function(e){return e instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(e,t,n){var r=this._writableState,i=!1,o=!r.objectMode&&h(e);return o&&!c.isBuffer(e)&&(e=d(e)),"function"==typeof t&&(n=t,t=null),o?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=w),r.ended?k(this,n):(o||v(this,r,e,n))&&(r.pendingcb++,i=_(this,r,o,e,t,n)),i},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||j(this,e))},g.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||F(this,r,n)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),g.prototype.destroy=p.destroy,g.prototype._undestroy=p.undestroy,g.prototype._destroy=function(e,t){this.end(),t(e)};
},{"process-nextick-args":"iFTO","core-util-is":"kj8s","inherits":"v3DX","util-deprecate":"hQaz","./internal/streams/stream":"o232","safe-buffer":"gI/y","./internal/streams/destroy":"Umu+","./_stream_duplex":"6gYn","process":"g5I+"}],"6gYn":[function(require,module,exports) {
"use strict";var e=require("process-nextick-args"),t=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=l;var r=require("core-util-is");r.inherits=require("inherits");var i=require("./_stream_readable"),a=require("./_stream_writable");r.inherits(l,i);for(var o=t(a.prototype),s=0;s<o.length;s++){var n=o[s];l.prototype[n]||(l.prototype[n]=a.prototype[n])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||e.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),l.prototype._destroy=function(t,r){this.push(null),this.end(),e.nextTick(r,t)};
},{"process-nextick-args":"iFTO","core-util-is":"kj8s","inherits":"v3DX","./_stream_readable":"KTao","./_stream_writable":"pX9p"}],"jreP":[function(require,module,exports) {

"use strict";var t=require("safe-buffer").Buffer,e=t.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function i(i){var a=s(i);if("string"!=typeof a&&(t.isEncoding===e||!e(i)))throw new Error("Unknown encoding: "+i);return a||i}function a(e){var s;switch(this.encoding=i(e),this.encoding){case"utf16le":this.text=c,this.end=f,s=4;break;case"utf8":this.fillLast=l,s=4;break;case"base64":this.text=d,this.end=g,s=3;break;default:return this.write=N,void(this.end=v)}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(s)}function r(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function n(t,e,s){var i=e.length-1;if(i<s)return 0;var a=r(e[i]);return a>=0?(a>0&&(t.lastNeed=a-1),a):--i<s||-2===a?0:(a=r(e[i]))>=0?(a>0&&(t.lastNeed=a-2),a):--i<s||-2===a?0:(a=r(e[i]))>=0?(a>0&&(2===a?a=0:t.lastNeed=a-3),a):0}function h(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}function l(t){var e=this.lastTotal-this.lastNeed,s=h(this,t,e);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){var s=n(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=s;var i=t.length-(s-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function o(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function c(t,e){if((t.length-e)%2==0){var s=t.toString("utf16le",e);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function f(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,s)}return e}function d(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function g(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function N(t){return t.toString(this.encoding)}function v(t){return t&&t.length?this.write(t):""}exports.StringDecoder=a,a.prototype.write=function(t){if(0===t.length)return"";var e,s;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},a.prototype.end=o,a.prototype.text=u,a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};
},{"safe-buffer":"gI/y"}],"KTao":[function(require,module,exports) {

var global = arguments[3];
var process = require("process");
var e=arguments[3],t=require("process"),n=require("process-nextick-args");module.exports=_;var r,i=require("isarray");_.ReadableState=w;var a=require("events").EventEmitter,d=function(e,t){return e.listeners(t).length},o=require("./internal/streams/stream"),s=require("safe-buffer").Buffer,u=e.Uint8Array||function(){};function l(e){return s.from(e)}function h(e){return s.isBuffer(e)||e instanceof u}var p=require("core-util-is");p.inherits=require("inherits");var f=require("util"),c=void 0;c=f&&f.debuglog?f.debuglog("stream"):function(){};var g,b=require("./internal/streams/BufferList"),m=require("./internal/streams/destroy");p.inherits(_,o);var v=["error","close","destroy","pause","resume"];function y(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?i(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function w(e,t){e=e||{};var n=t instanceof(r=r||require("./_stream_duplex"));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,a=e.readableHighWaterMark,d=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(a||0===a)?a:d,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new b,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(g||(g=require("string_decoder/").StringDecoder),this.decoder=new g(e.encoding),this.encoding=e.encoding)}function _(e){if(r=r||require("./_stream_duplex"),!(this instanceof _))return new _(e);this._readableState=new w(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function M(e,t,n,r,i){var a,d=e._readableState;null===t?(d.reading=!1,x(e,d)):(i||(a=k(d,t)),a?e.emit("error",a):d.objectMode||t&&t.length>0?("string"==typeof t||d.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=l(t)),r?d.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):S(e,d,t,!0):d.ended?e.emit("error",new Error("stream.push() after EOF")):(d.reading=!1,d.decoder&&!n?(t=d.decoder.write(t),d.objectMode||0!==t.length?S(e,d,t,!1):C(e,d)):S(e,d,t,!1))):r||(d.reading=!1));return j(d)}function S(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&q(e)),C(e,t)}function k(e,t){var n;return h(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function j(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=m.destroy,_.prototype._undestroy=m.undestroy,_.prototype._destroy=function(e,t){this.push(null),t(e)},_.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=s.from(e,t),t=""),n=!0),M(this,e,t,!1,n)},_.prototype.unshift=function(e){return M(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){return g||(g=require("string_decoder/").StringDecoder),this._readableState.decoder=new g(e),this._readableState.encoding=e,this};var R=8388608;function E(e){return e>=R?e=R:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function L(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=E(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,q(e)}}function q(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(W,e):W(e))}function W(e){c("emit readable"),e.emit("readable"),B(e)}function C(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(D,e,t))}function D(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(c("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function O(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&d(e,"data")&&(t.flowing=!0,B(e))}}function T(e){c("readable nexttick read 0"),e.read(0)}function U(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(P,e,t))}function P(e,t){t.reading||(c("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),B(e),t.flowing&&!t.reading&&e.read(0)}function B(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function H(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=I(e,t.buffer,t.decoder),n);var n}function I(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?A(e,t):F(e,t),r}function A(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var a=n.data,d=e>a.length?a.length:e;if(d===a.length?i+=a:i+=a.slice(0,e),0===(e-=d)){d===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(d));break}++r}return t.length-=r,i}function F(e,t){var n=s.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var a=r.data,d=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,d),0===(e-=d)){d===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(d));break}++i}return t.length-=i,n}function z(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(G,t,e))}function G(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function J(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}_.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?z(this):q(this),null;if(0===(e=L(e,t))&&t.ended)return 0===t.length&&z(this),null;var r,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=L(n,t))),null===(r=e>0?H(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&z(this)),null!==r&&this.emit("data",r),r},_.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(e,r){var i=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,c("pipe count=%d opts=%j",a.pipesCount,r);var o=(!r||!1!==r.end)&&e!==t.stdout&&e!==t.stderr?u:v;function s(t,n){c("onunpipe"),t===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,c("cleanup"),e.removeListener("close",b),e.removeListener("finish",m),e.removeListener("drain",l),e.removeListener("error",g),e.removeListener("unpipe",s),i.removeListener("end",u),i.removeListener("end",v),i.removeListener("data",f),h=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){c("onend"),e.end()}a.endEmitted?n.nextTick(o):i.once("end",o),e.on("unpipe",s);var l=O(i);e.on("drain",l);var h=!1;var p=!1;function f(t){c("ondata"),p=!1,!1!==e.write(t)||p||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==J(a.pipes,e))&&!h&&(c("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,p=!0),i.pause())}function g(t){c("onerror",t),v(),e.removeListener("error",g),0===d(e,"error")&&e.emit("error",t)}function b(){e.removeListener("finish",m),v()}function m(){c("onfinish"),e.removeListener("close",b),v()}function v(){c("unpipe"),i.unpipe(e)}return i.on("data",f),y(e,"error",g),e.once("close",b),e.once("finish",m),e.emit("pipe",i),a.flowing||(c("pipe resume"),i.resume()),e},_.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,n);return this}var d=J(t.pipes,e);return-1===d?this:(t.pipes.splice(d,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},_.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&q(this):n.nextTick(T,this))}return r},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!0,U(this,e)),this},_.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",function(){if(c("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){(c("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<v.length;a++)e.on(v[a],this.emit.bind(this,v[a]));return this._read=function(t){c("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=H;
},{"process-nextick-args":"iFTO","isarray":"aq/z","events":"wIHY","./internal/streams/stream":"o232","safe-buffer":"gI/y","core-util-is":"kj8s","inherits":"v3DX","util":"sC8V","./internal/streams/BufferList":"m36/","./internal/streams/destroy":"Umu+","./_stream_duplex":"6gYn","string_decoder/":"jreP","process":"g5I+"}],"PxOV":[function(require,module,exports) {
"use strict";module.exports=n;var t=require("./_stream_duplex"),r=require("core-util-is");function e(t,r){var e=this._transformState;e.transforming=!1;var n=e.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));e.writechunk=null,e.writecb=null,null!=r&&this.push(r),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function n(r){if(!(this instanceof n))return new n(r);t.call(this,r),this._transformState={afterTransform:e.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",i)}function i(){var t=this;"function"==typeof this._flush?this._flush(function(r,e){a(t,r,e)}):a(this,null,null)}function a(t,r,e){if(r)return t.emit("error",r);if(null!=e&&t.push(e),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}r.inherits=require("inherits"),r.inherits(n,t),n.prototype.push=function(r,e){return this._transformState.needTransform=!1,t.prototype.push.call(this,r,e)},n.prototype._transform=function(t,r,e){throw new Error("_transform() is not implemented")},n.prototype._write=function(t,r,e){var n=this._transformState;if(n.writecb=e,n.writechunk=t,n.writeencoding=r,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},n.prototype._read=function(t){var r=this._transformState;null!==r.writechunk&&r.writecb&&!r.transforming?(r.transforming=!0,this._transform(r.writechunk,r.writeencoding,r.afterTransform)):r.needTransform=!0},n.prototype._destroy=function(r,e){var n=this;t.prototype._destroy.call(this,r,function(t){e(t),n.emit("close")})};
},{"./_stream_duplex":"6gYn","core-util-is":"kj8s","inherits":"v3DX"}],"pumY":[function(require,module,exports) {
"use strict";module.exports=i;var r=require("./_stream_transform"),e=require("core-util-is");function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e.inherits=require("inherits"),e.inherits(i,r),i.prototype._transform=function(r,e,i){i(null,r)};
},{"./_stream_transform":"PxOV","core-util-is":"kj8s","inherits":"v3DX"}],"17Yv":[function(require,module,exports) {
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js");
},{"./lib/_stream_readable.js":"KTao","./lib/_stream_writable.js":"pX9p","./lib/_stream_duplex.js":"6gYn","./lib/_stream_transform.js":"PxOV","./lib/_stream_passthrough.js":"pumY"}],"Zy6X":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function o(e,n){return!n||"object"!==t(n)&&"function"!=typeof n?u(e):n}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(exports,"__esModule",{value:!0});var a=require("stream"),l=function(t){function n(t){var r;return e(this,n),(r=o(this,i(n).call(this))).buf=t,r}return f(n,a.Readable),r(n,[{key:"_read",value:function(){this.push(this.buf),this.push(null)}}]),n}();exports.ID3Stream=l;
},{"stream":"17Yv"}],"C2dR":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,a,o,s){try{var i=e[o](s),u=i.value}catch(c){return void r(c)}i.done?t(u):Promise.resolve(u).then(n,a)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(a,o){var s=e.apply(r,n);function i(e){t(s,a,o,i,u,"next",e)}function u(e){t(s,a,o,i,u,"throw",e)}i(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function s(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?i(t):r}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var p=require("token-types"),f=require("debug"),h=require("strtok3/lib/type"),l=require("strtok3/lib/core"),d=require("../id3v2/ID3v2Parser"),b=require("../common/FourCC"),k=require("../common/BasicParser"),y=require("./AiffToken"),v=require("../iff"),F=require("../id3v2/ID3Stream"),w=f("music-metadata:parser:aiff"),x=function(e){function t(){return n(this,t),s(this,u(t).apply(this,arguments))}return c(t,k.BasicParser),o(t,[{key:"parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(v.Header);case 2:if("FORM"===e.sent.chunkID){e.next=5;break}throw new Error("Invalid Chunk-ID, expected 'FORM'");case 5:return e.next=7,this.tokenizer.readToken(b.FourCcToken);case 7:t=e.sent,e.t0=t,e.next="AIFF"===e.t0?11:"AIFC"===e.t0?14:17;break;case 11:return this.metadata.setFormat("container",t),this.isCompressed=!1,e.abrupt("break",18);case 14:return this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0,e.abrupt("break",18);case 17:throw Error("Unsupported AIFF type: "+t);case 18:this.metadata.setFormat("lossless",!this.isCompressed),e.prev=19;case 20:return e.next=22,this.tokenizer.readToken(v.Header);case 22:return r=e.sent,w("Chunk id=".concat(r.chunkID)),n=2*Math.round(r.chunkSize/2),e.next=27,this.readData(r);case 27:return a=e.sent,e.next=30,this.tokenizer.ignore(n-a);case 30:e.next=20;break;case 31:e.next=37;break;case 33:if(e.prev=33,e.t1=e.catch(19),e.t1.message===h.endOfFile){e.next=37;break}throw e.t1;case 37:case"end":return e.stop()}},e,this,[[19,33]])}));return function(){return e.apply(this,arguments)}}()},{key:"readData",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r,n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.chunkID,e.next="COMM"===e.t0?3:"ID3 "===e.t0?13:"SSND"===e.t0?21:23;break;case 3:return e.next=5,this.tokenizer.readToken(new y.Common(t,this.isCompressed));case 5:return r=e.sent,this.metadata.setFormat("bitsPerSample",r.sampleSize),this.metadata.setFormat("sampleRate",r.sampleRate),this.metadata.setFormat("numberOfChannels",r.numChannels),this.metadata.setFormat("numberOfSamples",r.numSampleFrames),this.metadata.setFormat("duration",r.numSampleFrames/r.sampleRate),this.metadata.setFormat("codec",r.compressionName),e.abrupt("return",t.chunkSize);case 13:return e.next=15,this.tokenizer.readToken(new p.BufferType(t.chunkSize));case 15:return n=e.sent,a=new F.ID3Stream(n),o=l.fromStream(a),e.next=20,(new d.ID3v2Parser).parse(this.metadata,o,this.options);case 20:return e.abrupt("return",t.chunkSize);case 21:return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*t.chunkSize/this.metadata.format.duration),e.abrupt("return",0);case 23:return e.abrupt("return",0);case 24:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}();exports.AIFFParser=x;
},{"token-types":"1rOY","debug":"j+D9","strtok3/lib/type":"2Fe+","strtok3/lib/core":"tvmF","../id3v2/ID3v2Parser":"pIqu","../common/FourCC":"P2sd","../common/BasicParser":"O0hF","./AiffToken":"Hvar","../iff":"rTYW","../id3v2/ID3Stream":"Zy6X"}],"xQQP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("token-types"),r=require("../common/FourCC");function a(e){return{containsHeader:n(e,31),containsFooter:n(e,30),isHeader:n(e,31),readOnly:n(e,0),dataType:(6&e)>>1}}function n(e,t){return 0!=(e&1<<t)}!function(e){e[e.text_utf8=0]="text_utf8",e[e.binary=1]="binary",e[e.external_info=2]="external_info",e[e.reserved=3]="reserved"}(e=exports.DataType||(exports.DataType={})),exports.DescriptorParser={len:52,get:function(e,a){return{ID:r.FourCcToken.get(e,a),version:t.UINT32_LE.get(e,a+4)/1e3,descriptorBytes:t.UINT32_LE.get(e,a+8),headerBytes:t.UINT32_LE.get(e,a+12),seekTableBytes:t.UINT32_LE.get(e,a+16),headerDataBytes:t.UINT32_LE.get(e,a+20),apeFrameDataBytes:t.UINT32_LE.get(e,a+24),apeFrameDataBytesHigh:t.UINT32_LE.get(e,a+28),terminatingDataBytes:t.UINT32_LE.get(e,a+32),fileMD5:new t.BufferType(16).get(e,a+36)}}},exports.Header={len:24,get:function(e,r){return{compressionLevel:t.UINT16_LE.get(e,r),formatFlags:t.UINT16_LE.get(e,r+2),blocksPerFrame:t.UINT32_LE.get(e,r+4),finalFrameBlocks:t.UINT32_LE.get(e,r+8),totalFrames:t.UINT32_LE.get(e,r+12),bitsPerSample:t.UINT16_LE.get(e,r+16),channel:t.UINT16_LE.get(e,r+18),sampleRate:t.UINT32_LE.get(e,r+20)}}},exports.TagFooter={len:32,get:function(e,r){return{ID:new t.StringType(8,"ascii").get(e,r),version:t.UINT32_LE.get(e,r+8),size:t.UINT32_LE.get(e,r+12),fields:t.UINT32_LE.get(e,r+16),flags:a(t.UINT32_LE.get(e,r+20))}}},exports.TagItemHeader={len:8,get:function(e,r){return{size:t.UINT32_LE.get(e,r),flags:a(t.UINT32_LE.get(e,r+4))}}},exports.TagField=function(e){return new t.BufferType(e.size-exports.TagFooter.len)},exports.parseTagFlags=a,exports.isBitSet=n;
},{"token-types":"1rOY","../common/FourCC":"P2sd"}],"IhDz":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function n(e){return function(){var t=this,n=arguments;return new Promise(function(a,o){var i=e.apply(t,n);function s(e){r(i,a,o,s,u,"next",e)}function u(e){r(i,a,o,s,u,"throw",e)}s(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function s(e,r){return!r||"object"!==t(r)&&"function"!=typeof r?u(e):r}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var l=require("debug"),d=require("file-type"),m=require("token-types"),y=require("assert"),h=require("../common/Util"),v=require("../common/BasicParser"),g=require("./APEv2Token"),b=l("music-metadata:parser:APEv2"),k="APEv2",T="APETAGEX",x=function(t){function r(){var e;return a(this,r),(e=s(this,c(r).apply(this,arguments))).ape={},e}return f(r,v.BasicParser),i(r,[{key:"parse",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(g.DescriptorParser);case 2:return t=e.sent,y.strictEqual(t.ID,"MAC ","descriptor.ID"),this.ape.descriptor=t,n=t.descriptorBytes-g.DescriptorParser.len,e.next=8,n>0?this.parseDescriptorExpansion(n):this.parseHeader();case 8:return a=e.sent,e.next=11,this.tokenizer.readToken(new m.IgnoreType(a.forwardBytes));case 11:return e.abrupt("return",r.parseTagHeader(this.metadata,this.tokenizer,this.options));case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseDescriptorExpansion",value:function(){var e=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(new m.IgnoreType(t));case 2:return e.abrupt("return",this.parseHeader());case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseHeader",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(g.Header);case 2:return t=e.sent,this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",t.bitsPerSample),this.metadata.setFormat("sampleRate",t.sampleRate),this.metadata.setFormat("numberOfChannels",t.channel),this.metadata.setFormat("duration",r.calculateDuration(t)),e.abrupt("return",{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}],[{key:"calculateDuration",value:function(e){var t=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return(t+=e.finalFrameBlocks)/e.sampleRate}},{key:"parseTagHeader",value:function(){var t=n(regeneratorRuntime.mark(function t(n,a,o){var i,s,u,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a.fileSize&&a.fileSize-a.position<g.TagFooter.len)){t.next=3;break}return b("No APEv2 header found, end-of-file reached"),t.abrupt("return");case 3:return t.next=5,a.peekToken(g.TagFooter);case 5:if((i=t.sent).ID!==T){t.next=15;break}return t.next=9,a.ignore(g.TagFooter.len);case 9:return t.next=11,a.readToken(g.TagField(i));case 11:s=t.sent,r.parseTags(n,i,s,0,!o.skipCovers),t.next=22;break;case 15:if(b("APEv2 header not found at offset=".concat(a.position)),!a.fileSize){t.next=22;break}return u=a.fileSize-a.position,c=e.alloc(u),t.next=21,a.readBuffer(c);case 21:return t.abrupt("return",r.parseTagFooter(n,c,!o.skipCovers));case 22:case"end":return t.stop()}},t)}));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"parseTagFooter",value:function(e,t,r){var n=g.TagFooter.get(t,t.length-g.TagFooter.len);y.strictEqual(n.ID,T,"APEv2 Footer preamble"),this.parseTags(e,n,t,t.length-n.size,r)}},{key:"parseTags",value:function(t,r,n,a,o){for(var i=0;i<r.fields;i++){var s=g.TagItemHeader.get(n,a);a+=g.TagItemHeader.len;var u=h.default.findZero(n,a,n.length),c=n.toString("ascii",a,u);switch(a=u+1,s.flags.dataType){case g.DataType.text_utf8:var f=n.toString("utf8",a,a+=s.size).split(/\x00/g),p=!0,l=!1,m=void 0;try{for(var y,v=f[Symbol.iterator]();!(p=(y=v.next()).done);p=!0){var T=y.value;t.addTag(k,c,T)}}catch(S){l=!0,m=S}finally{try{p||null==v.return||v.return()}finally{if(l)throw m}}break;case g.DataType.binary:if(o){var x=n.slice(a,a+s.size),w=0;u=h.default.findZero(x,w,x.length);var P=x.toString("utf8",w,u);w=u+1;var F=e.from(x.slice(w)),E=d(F);if(E)if(0===E.mime.indexOf("image/")){var D={description:P,data:F,format:E.mime};a+=s.size,t.addTag(k,c,D)}else b("Unexpected binary tag of type': ".concat(E.mime));else b("Failed to determine file type for binary tag: ".concat(c))}break;case g.DataType.external_info:b("Ignore external info ".concat(c));break;default:throw new Error("Unexpected data-type: ".concat(s.flags.dataType))}}}}]),r}();exports.APEv2Parser=x;
},{"debug":"j+D9","file-type":"gPQA","token-types":"1rOY","assert":"TfPC","../common/Util":"5e0M","../common/BasicParser":"O0hF","./APEv2Token":"xQQP","buffer":"z1tx"}],"SsVx":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function n(e){t(this,n),this.str=e}return r(n,[{key:"equals",value:function(e){return this.str===e.str}},{key:"toBin",value:function(){return n.encode(this.str)}}],[{key:"fromBin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new n(this.decode(e,t))}},{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e.readUInt32LE(t).toString(16)+"-"+e.readUInt16LE(t+4).toString(16)+"-"+e.readUInt16LE(t+6).toString(16)+"-"+e.readUInt16BE(t+8).toString(16)+"-"+e.slice(t+10,t+16).toString("hex")).toUpperCase()}},{key:"decodeMediaType",value:function(e){switch(e.str){case n.AudioMedia.str:return"audio";case n.VideoMedia.str:return"video";case n.CommandMedia.str:return"command";case n.Degradable_JPEG_Media.str:return"degradable-jpeg";case n.FileTransferMedia.str:return"file-transfer";case n.BinaryMedia.str:return"binary"}}},{key:"encode",value:function(t){var n=e.alloc(16);return n.writeUInt32LE(parseInt(t.slice(0,8),16),0),n.writeUInt16LE(parseInt(t.slice(9,13),16),4),n.writeUInt16LE(parseInt(t.slice(14,18),16),6),e.from(t.slice(19,23),"hex").copy(n,8),e.from(t.slice(24),"hex").copy(n,10),n}}]),n}();a.HeaderObject=new a("75B22630-668E-11CF-A6D9-00AA0062CE6C"),a.DataObject=new a("75B22636-668E-11CF-A6D9-00AA0062CE6C"),a.SimpleIndexObject=new a("33000890-E5B1-11CF-89F4-00A0C90349CB"),a.IndexObject=new a("D6E229D3-35DA-11D1-9034-00A0C90349BE"),a.MediaObjectIndexObject=new a("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C"),a.TimecodeIndexObject=new a("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C"),a.FilePropertiesObject=new a("8CABDCA1-A947-11CF-8EE4-00C00C205365"),a.StreamPropertiesObject=new a("B7DC0791-A9B7-11CF-8EE6-00C00C205365"),a.HeaderExtensionObject=new a("5FBF03B5-A92E-11CF-8EE3-00C00C205365"),a.CodecListObject=new a("86D15240-311D-11D0-A3A4-00A0C90348F6"),a.ScriptCommandObject=new a("1EFB1A30-0B62-11D0-A39B-00A0C90348F6"),a.MarkerObject=new a("F487CD01-A951-11CF-8EE6-00C00C205365"),a.BitrateMutualExclusionObject=new a("D6E229DC-35DA-11D1-9034-00A0C90349BE"),a.ErrorCorrectionObject=new a("75B22635-668E-11CF-A6D9-00AA0062CE6C"),a.ContentDescriptionObject=new a("75B22633-668E-11CF-A6D9-00AA0062CE6C"),a.ExtendedContentDescriptionObject=new a("D2D0A440-E307-11D2-97F0-00A0C95EA850"),a.ContentBrandingObject=new a("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E"),a.StreamBitratePropertiesObject=new a("7BF875CE-468D-11D1-8D82-006097C9A2B2"),a.ContentEncryptionObject=new a("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E"),a.ExtendedContentEncryptionObject=new a("298AE614-2622-4C17-B935-DAE07EE9289C"),a.DigitalSignatureObject=new a("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E"),a.PaddingObject=new a("1806D474-CADF-4509-A4BA-9AABCB96AAE8"),a.ExtendedStreamPropertiesObject=new a("14E6A5CB-C672-4332-8399-A96952065B5A"),a.AdvancedMutualExclusionObject=new a("A08649CF-4775-4670-8A16-6E35357566CD"),a.GroupMutualExclusionObject=new a("D1465A40-5A79-4338-B71B-E36B8FD6C249"),a.StreamPrioritizationObject=new a("D4FED15B-88D3-454F-81F0-ED5C45999E24"),a.BandwidthSharingObject=new a("A69609E6-517B-11D2-B6AF-00C04FD908E9"),a.LanguageListObject=new a("7C4346A9-EFE0-4BFC-B229-393EDE415C85"),a.MetadataObject=new a("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA"),a.MetadataLibraryObject=new a("44231C94-9498-49D1-A141-1D134E457054"),a.IndexParametersObject=new a("D6E229DF-35DA-11D1-9034-00A0C90349BE"),a.MediaObjectIndexParametersObject=new a("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7"),a.TimecodeIndexParametersObject=new a("F55E496D-9797-4B5D-8C8B-604DFE9BFB24"),a.CompatibilityObject=new a("26F18B5D-4584-47EC-9F5F-0E651F0452C9"),a.AdvancedContentEncryptionObject=new a("43058533-6981-49E6-9B74-AD12CB86D58C"),a.AudioMedia=new a("F8699E40-5B4D-11CF-A8FD-00805F5C442B"),a.VideoMedia=new a("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B"),a.CommandMedia=new a("59DACFC0-59E6-11D0-A3AC-00A0C90348F6"),a.JFIF_Media=new a("B61BE100-5B4E-11CF-A8FD-00805F5C442B"),a.Degradable_JPEG_Media=new a("35907DE0-E415-11CF-A917-00805F5C442B"),a.FileTransferMedia=new a("91BD222C-F21C-497A-8B6D-5AA86BFC0185"),a.BinaryMedia=new a("3AFB65E2-47EF-40F2-AC2C-70A90D71D343"),a.ASF_Index_Placeholder_Object=new a("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2"),exports.default=a;
},{"buffer":"z1tx"}],"VWU3":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var r=require("buffer").Buffer;function e(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function t(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function n(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}Object.defineProperty(exports,"__esModule",{value:!0});var a=require("../common/Util"),o=require("token-types"),u=function(){function t(){e(this,t)}return n(t,null,[{key:"getParserForAttr",value:function(r){return t.attributeParsers[r]}},{key:"parseUnicodeAttr",value:function(r){return a.default.stripNulls(a.default.decodeString(r,"utf16le"))}},{key:"parseByteArrayAttr",value:function(e){var t=r.alloc(e.length);return e.copy(t),t}},{key:"parseBoolAttr",value:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 1===t.parseWordAttr(r,e)}},{key:"parseDWordAttr",value:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r.readUInt32LE(e)}},{key:"parseQWordAttr",value:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return o.UINT64_LE.get(r,e)}},{key:"parseWordAttr",value:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r.readUInt16LE(e)}}]),t}();u.attributeParsers=[u.parseUnicodeAttr,u.parseByteArrayAttr,u.parseBoolAttr,u.parseDWordAttr,u.parseQWordAttr,u.parseWordAttr,u.parseByteArrayAttr],exports.AsfUtil=u;
},{"../common/Util":"5e0M","token-types":"1rOY","buffer":"z1tx"}],"RkL5":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,r){return!r||"object"!==t(r)&&"function"!=typeof r?n(e):r}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var f,l=require("../common/Util"),d=require("token-types"),p=require("./GUID"),g=require("./AsfUtil"),b=require("../id3v2/ID3v2Token");!function(e){e[e.UnicodeString=0]="UnicodeString",e[e.ByteArray=1]="ByteArray",e[e.Bool=2]="Bool",e[e.DWord=3]="DWord",e[e.QWord=4]="QWord",e[e.Word=5]="Word"}(f=exports.DataType||(exports.DataType={})),exports.TopLevelHeaderObjectToken={len:30,get:function(e,t){return{objectId:p.default.fromBin(new d.BufferType(16).get(e,t)),objectSize:d.UINT64_LE.get(e,t+16),numberOfHeaderObjects:d.UINT32_LE.get(e,t+24)}}},exports.HeaderObjectToken={len:24,get:function(e,t){return{objectId:p.default.fromBin(new d.BufferType(16).get(e,t)),objectSize:d.UINT64_LE.get(e,t+16)}}};var v=function(){function e(t){u(this,e),this.len=t.objectSize-exports.HeaderObjectToken.len}return c(e,[{key:"postProcessTag",value:function(e,t,r,n){if("WM/Picture"===t)e.push({id:t,value:j.fromBuffer(n)});else{var a=g.AsfUtil.getParserForAttr(r);if(!a)throw new Error("unexpected value headerType: "+r);e.push({id:t,value:a(n)})}}}]),e}();exports.State=v;var y=function(e){function t(e){return u(this,t),r(this,a(t).call(this,e))}return o(t,v),c(t,[{key:"get",value:function(e,t){return null}}]),t}();exports.IgnoreObjectState=y;var E=function(e){function t(e){return u(this,t),r(this,a(t).call(this,e))}return o(t,v),c(t,[{key:"get",value:function(e,t){return{fileId:p.default.fromBin(e,t),fileSize:d.UINT64_LE.get(e,t+16),creationDate:d.UINT64_LE.get(e,t+24),dataPacketsCount:d.UINT64_LE.get(e,t+32),playDuration:d.UINT64_LE.get(e,t+40),sendDuration:d.UINT64_LE.get(e,t+48),preroll:d.UINT64_LE.get(e,t+56),flags:{broadcast:l.default.strtokBITSET.get(e,t+64,24),seekable:l.default.strtokBITSET.get(e,t+64,25)},minimumDataPacketSize:d.UINT32_LE.get(e,t+68),maximumDataPacketSize:d.UINT32_LE.get(e,t+72),maximumBitrate:d.UINT32_LE.get(e,t+76)}}}]),t}();E.guid=p.default.FilePropertiesObject,exports.FilePropertiesObject=E;var m=function(e){function t(e){return u(this,t),r(this,a(t).call(this,e))}return o(t,v),c(t,[{key:"get",value:function(e,t){return{streamType:p.default.decodeMediaType(p.default.fromBin(e,t)),errorCorrectionType:p.default.fromBin(e,t+8)}}}]),t}();m.guid=p.default.StreamPropertiesObject,exports.StreamPropertiesObject=m;var I=function(){function e(){u(this,e),this.len=22}return c(e,[{key:"get",value:function(e,t){e.readUInt32LE(t+18);return{reserved1:p.default.fromBin(e,t),reserved2:e.readUInt16LE(t+16),extensionDataSize:e.readUInt32LE(t+18)}}}]),e}();I.guid=p.default.HeaderExtensionObject,exports.HeaderExtensionObject=I;var h=function(e){function t(e){return u(this,t),r(this,a(t).call(this,e))}return o(t,v),c(t,[{key:"get",value:function(e,r){for(var n=[],a=r+10,o=0;o<t.contentDescTags.length;++o){var i=e.readUInt16LE(r+2*o);if(i>0){var u=t.contentDescTags[o],s=a+i;n.push({id:u,value:g.AsfUtil.parseUnicodeAttr(e.slice(a,s))}),a=s}}return n}}]),t}();h.guid=p.default.ContentDescriptionObject,h.contentDescTags=["Title","Author","Copyright","Description","Rating"],exports.ContentDescriptionObjectState=h;var T=function(e){function t(e){return u(this,t),r(this,a(t).call(this,e))}return o(t,v),c(t,[{key:"get",value:function(e,t){for(var r=[],n=e.readUInt16LE(t),a=t+2,o=0;o<n;o+=1){var i=e.readUInt16LE(a);a+=2;var u=g.AsfUtil.parseUnicodeAttr(e.slice(a,a+i));a+=i;var s=e.readUInt16LE(a);a+=2;var c=e.readUInt16LE(a);a+=2;var f=e.slice(a,a+c);a+=c,this.postProcessTag(r,u,s,f)}return r}}]),t}();T.guid=p.default.ExtendedContentDescriptionObject,exports.ExtendedContentDescriptionObjectState=T;var L=function(e){function t(e){return u(this,t),r(this,a(t).call(this,e))}return o(t,v),c(t,[{key:"get",value:function(e,t){return{startTime:d.UINT64_LE.get(e,t),endTime:d.UINT64_LE.get(e,t+8),dataBitrate:e.readInt32LE(t+12),bufferSize:e.readInt32LE(t+16),initialBufferFullness:e.readInt32LE(t+20),alternateDataBitrate:e.readInt32LE(t+24),alternateBufferSize:e.readInt32LE(t+28),alternateInitialBufferFullness:e.readInt32LE(t+32),maximumObjectSize:e.readInt32LE(t+36),flags:{reliableFlag:l.default.strtokBITSET.get(e,t+40,0),seekableFlag:l.default.strtokBITSET.get(e,t+40,1),resendLiveCleanpointsFlag:l.default.strtokBITSET.get(e,t+40,2)},streamNumber:e.readInt16LE(t+42),streamLanguageId:e.readInt16LE(t+44),averageTimePerFrame:e.readInt32LE(t+52),streamNameCount:e.readInt32LE(t+54),payloadExtensionSystems:e.readInt32LE(t+56),streamNames:[],streamPropertiesObject:null}}}]),t}();L.guid=p.default.ExtendedStreamPropertiesObject,exports.ExtendedStreamPropertiesObjectState=L;var U=function(e){function t(e){return u(this,t),r(this,a(t).call(this,e))}return o(t,v),c(t,[{key:"get",value:function(e,t){for(var r=[],n=e.readUInt16LE(t),a=t+2,o=0;o<n;o+=1){a+=4;var i=e.readUInt16LE(a);a+=2;var u=e.readUInt16LE(a);a+=2;var s=e.readUInt32LE(a);a+=4;var c=g.AsfUtil.parseUnicodeAttr(e.slice(a,a+i));a+=i;var f=e.slice(a,a+s);if(a+=s,!g.AsfUtil.getParserForAttr(u))throw new Error("unexpected value headerType: "+u);this.postProcessTag(r,c,u,f)}return r}}]),t}();U.guid=p.default.MetadataObject,exports.MetadataObjectState=U;var S=function(e){function t(e){return u(this,t),r(this,a(t).call(this,e))}return o(t,U),t}();S.guid=p.default.MetadataLibraryObject,exports.MetadataLibraryObjectState=S;var j=function(){function t(e){u(this,t),this.len=e}return c(t,[{key:"get",value:function(e,t){for(var r=e.readUInt8(t++),n=e.readInt32LE(t),a=5;0!==e.readUInt16BE(a);)a+=2;for(var o=e.slice(5,a).toString("utf16le");0!==e.readUInt16BE(a);)a+=2;var i=e.slice(5,a).toString("utf16le");return{type:b.AttachedPictureType[r],format:o,description:i,size:n,data:e.slice(a+4)}}}],[{key:"fromBase64",value:function(t){return this.fromBuffer(e.from(t,"base64"))}},{key:"fromBuffer",value:function(e){return new t(e.length).get(e,0)}}]),t}();exports.WmPictureToken=j;
},{"../common/Util":"5e0M","token-types":"1rOY","./GUID":"SsVx","./AsfUtil":"VWU3","../id3v2/ID3v2Token":"3ujr","buffer":"z1tx"}],"EvYH":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,a)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(a,o){var i=e.apply(r,n);function s(e){t(i,a,o,s,c,"next",e)}function c(e){t(i,a,o,s,c,"throw",e)}s(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function i(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?s(t):r}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var d=require("./GUID"),p=require("./AsfObject"),f=require("debug"),k=require("../common/BasicParser"),j=f("music-metadata:parser:ASF"),h="asf",l=function(e){function t(){return n(this,t),i(this,c(t).apply(this,arguments))}return u(t,k.BasicParser),o(t,[{key:"parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(p.TopLevelHeaderObjectToken);case 2:if((t=e.sent).objectId.equals(d.default.HeaderObject)){e.next=5;break}throw new Error("expected asf header; but was not found; got: "+t.objectId.str);case 5:return e.prev=5,e.next=8,this.parseObjectHeader(t.numberOfHeaderObjects);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),j("Error while parsing ASF: %s",e.t0);case 13:case"end":return e.stop()}},e,this,[[5,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"parseObjectHeader",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r,n,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(p.HeaderObjectToken);case 2:n=e.sent,j("header GUID=%s",n.objectId.str),e.t0=n.objectId.str,e.next=e.t0===p.FilePropertiesObject.guid.str?7:e.t0===p.StreamPropertiesObject.guid.str?13:e.t0===p.HeaderExtensionObject.guid.str?18:e.t0===p.ContentDescriptionObjectState.guid.str?24:e.t0===p.ExtendedContentDescriptionObjectState.guid.str?29:e.t0===d.default.CodecListObject.str?34:e.t0===d.default.StreamBitratePropertiesObject.str?37:e.t0===d.default.PaddingObject.str?40:44;break;case 7:return e.next=9,this.tokenizer.readToken(new p.FilePropertiesObject(n));case 9:return a=e.sent,this.metadata.setFormat("duration",a.playDuration/1e7),this.metadata.setFormat("bitrate",a.maximumBitrate),e.abrupt("break",48);case 13:return e.next=15,this.tokenizer.readToken(new p.StreamPropertiesObject(n));case 15:return o=e.sent,this.metadata.setFormat("container","ASF/"+o.streamType),e.abrupt("break",48);case 18:return e.next=20,this.tokenizer.readToken(new p.HeaderExtensionObject);case 20:return i=e.sent,e.next=23,this.parseExtensionObject(i.extensionDataSize);case 23:return e.abrupt("break",48);case 24:return e.next=26,this.tokenizer.readToken(new p.ContentDescriptionObjectState(n));case 26:return r=e.sent,this.addTags(r),e.abrupt("break",48);case 29:return e.next=31,this.tokenizer.readToken(new p.ExtendedContentDescriptionObjectState(n));case 31:return r=e.sent,this.addTags(r),e.abrupt("break",48);case 34:return e.next=36,this.tokenizer.ignore(n.objectSize-p.HeaderObjectToken.len);case 36:return e.abrupt("break",48);case 37:return e.next=39,this.tokenizer.ignore(n.objectSize-p.HeaderObjectToken.len);case 39:return e.abrupt("break",48);case 40:return j("Padding: %s bytes",n.objectSize-p.HeaderObjectToken.len),e.next=43,this.tokenizer.ignore(n.objectSize-p.HeaderObjectToken.len);case 43:return e.abrupt("break",48);case 44:return this.warnings.push("Ignore ASF-Object-GUID: "+n.objectId.str),j("Ignore ASF-Object-GUID: %s",n.objectId.str),e.next=48,this.tokenizer.readToken(new p.IgnoreObjectState(n));case 48:if(--t){e.next=0;break}case 49:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addTags",value:function(e){var t=this;e.forEach(function(e){t.metadata.addTag(h,e.id,e.value)})}},{key:"parseExtensionObject",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(p.HeaderObjectToken);case 2:r=e.sent,e.t0=r.objectId.str,e.next=e.t0===p.ExtendedStreamPropertiesObjectState.guid.str?6:e.t0===p.MetadataObjectState.guid.str?10:e.t0===p.MetadataLibraryObjectState.guid.str?15:e.t0===d.default.PaddingObject.str?20:e.t0===d.default.CompatibilityObject.str?23:e.t0===d.default.ASF_Index_Placeholder_Object.str?25:28;break;case 6:return e.next=8,this.tokenizer.readToken(new p.ExtendedStreamPropertiesObjectState(r));case 8:return e.sent,e.abrupt("break",32);case 10:return e.next=12,this.tokenizer.readToken(new p.MetadataObjectState(r));case 12:return n=e.sent,this.addTags(n),e.abrupt("break",32);case 15:return e.next=17,this.tokenizer.readToken(new p.MetadataLibraryObjectState(r));case 17:return a=e.sent,this.addTags(a),e.abrupt("break",32);case 20:return e.next=22,this.tokenizer.ignore(r.objectSize-p.HeaderObjectToken.len);case 22:return e.abrupt("break",32);case 23:return this.tokenizer.ignore(r.objectSize-p.HeaderObjectToken.len),e.abrupt("break",32);case 25:return e.next=27,this.tokenizer.ignore(r.objectSize-p.HeaderObjectToken.len);case 27:return e.abrupt("break",32);case 28:return this.warnings.push("Ignore ASF-Object-GUID: "+r.objectId.str),e.next=31,this.tokenizer.readToken(new p.IgnoreObjectState(r));case 31:return e.abrupt("break",32);case 32:t-=r.objectSize;case 33:if(t>0){e.next=0;break}case 34:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}();exports.AsfParser=l;
},{"./GUID":"SsVx","./AsfObject":"RkL5","debug":"j+D9","../common/BasicParser":"O0hF"}],"IGPB":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0});var o=require("token-types"),i=require("../../id3v2/ID3v2Token"),a=function(){function r(e){t(this,r),this.len=e}return n(r,[{key:"get",value:function(t,r){var n=i.AttachedPictureType[o.UINT32_BE.get(t,r)],a=o.UINT32_BE.get(t,r+=4),u=t.toString("utf-8",r+=4,r+a),f=o.UINT32_BE.get(t,r+=a),c=t.toString("utf-8",r+=4,r+f),l=o.UINT32_BE.get(t,r+=f),d=o.UINT32_BE.get(t,r+=4),s=o.UINT32_BE.get(t,r+=4),g=o.UINT32_BE.get(t,r+=4),p=o.UINT32_BE.get(t,r+=4);return{type:n,format:u,description:c,width:l,height:d,colour_depth:s,indexed_color:g,data:e.from(t.slice(r+=4,r+p))}}}],[{key:"fromBase64",value:function(t){return this.fromBuffer(e.from(t,"base64"))}},{key:"fromBuffer",value:function(e){return new r(e.length).get(e,0)}}]),r}();exports.VorbisPictureToken=a,exports.CommonHeader={len:7,get:function(e,t){return{packetType:e.readUInt8(t),vorbis:new o.StringType(6,"ascii").get(e,t+1)}}},exports.IdentificationHeader={len:23,get:function(e,t){return{version:e.readUInt32LE(t+0),channelMode:e.readUInt8(t+4),sampleRate:e.readUInt32LE(t+5),bitrateMax:e.readUInt32LE(t+9),bitrateNominal:e.readUInt32LE(t+13),bitrateMin:e.readUInt32LE(t+17)}}};
},{"token-types":"1rOY","../../id3v2/ID3v2Token":"3ujr","buffer":"z1tx"}],"Tc8M":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,o)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(o,i){var a=e.apply(r,n);function s(e){t(a,o,i,s,u,"next",e)}function u(e){t(a,o,i,s,u,"throw",e)}s(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function a(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?s(t):r}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var p=require("strtok3/lib/type"),h=require("./ID3v2Token"),l=require("./ID3v2Parser"),v=require("../id3v1/ID3v1Parser"),y=require("debug"),d=require("../common/BasicParser"),b=y("music-metadata:parser:ID3"),m=function(e){function t(){var e;return n(this,t),(e=a(this,u(t).apply(this,arguments))).id3parser=new l.ID3v2Parser,e}return c(t,d.BasicParser),i(t,[{key:"parse",value:function(){return this.parseID3v2().catch(function(e){if(e.message!==p.endOfFile)throw e})}},{key:"finalize",value:function(){}},{key:"parseID3v2",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tryReadId3v2Headers();case 2:return b("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),e.next=5,this._parse();case 5:if(!this.options.skipPostHeaders||!this.metadata.hasAny()){e.next=9;break}this.finalize(),e.next=13;break;case 9:return t=new v.ID3v1Parser,e.next=12,t.init(this.metadata,this.tokenizer,this.options).parse();case 12:this.finalize();case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"tryReadId3v2Headers",value:function(){var e=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.peekToken(h.ID3v2Header);case 2:if("ID3"!==e.sent.fileIdentifier){e.next=8;break}return b("Found ID3v2 header, pos=%s",this.tokenizer.position),e.next=7,this.id3parser.parse(this.metadata,this.tokenizer,this.options);case 7:return e.abrupt("return",this.tryReadId3v2Headers());case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}],[{key:"startsWithID3v2Header",value:function(){var e=r(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.peekToken(h.ID3v2Header);case 2:return e.t0=e.sent.fileIdentifier,e.abrupt("return","ID3"===e.t0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),t}();exports.AbstractID3Parser=m;
},{"strtok3/lib/type":"2Fe+","./ID3v2Token":"3ujr","./ID3v2Parser":"pIqu","../id3v1/ID3v1Parser":"WTnS","debug":"j+D9","../common/BasicParser":"O0hF"}],"lnZi":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(a,o){var i=e.apply(r,n);function s(e){t(i,a,o,s,u,"next",e)}function u(e){t(i,a,o,s,u,"throw",e)}s(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function i(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?s(t):r}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var l,p=require("../common/Util"),m=require("token-types"),h=require("../ogg/vorbis/Vorbis"),d=require("../id3v2/AbstractID3Parser"),g=require("../common/FourCC"),k=require("debug"),y=k("music-metadata:parser:FLAC");!function(e){e[e.STREAMINFO=0]="STREAMINFO",e[e.PADDING=1]="PADDING",e[e.APPLICATION=2]="APPLICATION",e[e.SEEKTABLE=3]="SEEKTABLE",e[e.VORBIS_COMMENT=4]="VORBIS_COMMENT",e[e.CUESHEET=5]="CUESHEET",e[e.PICTURE=6]="PICTURE"}(l||(l={}));var b=function(e){function t(){var e;return n(this,t),(e=i(this,u(t).apply(this,arguments))).padding=0,e}return c(t,d.AbstractID3Parser),o(t,[{key:"_parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(g.FourCcToken);case 2:if("fLaC"===e.sent.toString()){e.next=5;break}throw new Error("Invalid FLAC preamble");case 5:return e.next=7,this.tokenizer.readToken(T.BlockHeader);case 7:return t=e.sent,e.next=10,this.parseDataBlock(t);case 10:if(!t.lastBlock){e.next=5;break}case 11:this.tokenizer.fileSize&&this.metadata.format.duration&&(r=this.tokenizer.fileSize-this.tokenizer.position,this.metadata.setFormat("bitrate",8*r/this.metadata.format.duration));case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addTag",value:function(e,t){this.metadata.addTag("vorbis",e,t)}},{key:"parseDataBlock",value:function(e){switch(y("blockHeader type=".concat(e.type,", length=").concat(e.length)),e.type){case l.STREAMINFO:return this.parseBlockStreamInfo(e.length);case l.PADDING:this.padding+=e.length;break;case l.APPLICATION:case l.SEEKTABLE:break;case l.VORBIS_COMMENT:return this.parseComment(e.length);case l.CUESHEET:break;case l.PICTURE:return this.parsePicture(e.length);default:this.warnings.push("Unknown block type: "+e.type)}return this.tokenizer.readToken(new m.IgnoreType(e.length))}},{key:"parseBlockStreamInfo",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===T.BlockStreamInfo.len){e.next=2;break}throw new Error("Unexpected block-stream-info length");case 2:return e.next=4,this.tokenizer.readToken(T.BlockStreamInfo);case 4:r=e.sent,this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",r.channels),this.metadata.setFormat("bitsPerSample",r.bitsPerSample),this.metadata.setFormat("sampleRate",r.sampleRate),this.metadata.setFormat("duration",r.totalSamples/r.sampleRate);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseComment",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r,n,a,o,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(new m.BufferType(t));case 2:for(r=e.sent,(n=new v(r)).readStringUtf8(),a=n.readInt32(),o=0;o<a;o++)i=n.readStringUtf8(),s=i.split("="),this.addTag(s[0].toUpperCase(),s.splice(1).join("="));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parsePicture",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.options.skipCovers){e.next=4;break}return e.abrupt("return",this.tokenizer.ignore(t));case 4:return e.next=6,this.tokenizer.readToken(new h.VorbisPictureToken(t));case 6:r=e.sent,this.addTag("METADATA_BLOCK_PICTURE",r);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return new t}}]),t}();exports.FlacParser=b;var T=function e(){n(this,e)};T.BlockHeader={len:4,get:function(e,t){return{lastBlock:p.default.strtokBITSET.get(e,t,7),type:p.default.getBitAllignedNumber(e,t,1,7),length:m.UINT24_BE.get(e,t+1)}}},T.BlockStreamInfo={len:34,get:function(e,t){return{minimumBlockSize:m.UINT16_BE.get(e,t),maximumBlockSize:m.UINT16_BE.get(e,t+2)/1e3,minimumFrameSize:m.UINT24_BE.get(e,t+4),maximumFrameSize:m.UINT24_BE.get(e,t+7),sampleRate:m.UINT24_BE.get(e,t+10)>>4,channels:p.default.getBitAllignedNumber(e,t+12,4,3)+1,bitsPerSample:p.default.getBitAllignedNumber(e,t+12,7,5)+1,totalSamples:p.default.getBitAllignedNumber(e,t+13,4,36),fileMD5:new m.BufferType(16).get(e,t+18)}}};var v=function(){function e(t){n(this,e),this.data=t,this.offset=0}return o(e,[{key:"readInt32",value:function(){var e=m.UINT32_LE.get(this.data,this.offset);return this.offset+=4,e}},{key:"readStringUtf8",value:function(){var e=this.readInt32(),t=this.data.toString("utf8",this.offset,this.offset+e);return this.offset+=e,t}}]),e}();
},{"../common/Util":"5e0M","token-types":"1rOY","../ogg/vorbis/Vorbis":"IGPB","../id3v2/AbstractID3Parser":"Tc8M","../common/FourCC":"P2sd","debug":"j+D9"}],"wi0z":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function r(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?o(t):n}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var g=require("token-types"),s=require("../common/FourCC"),f=require("debug"),l=f("music-metadata:parser:MP4:atom");exports.Header={len:8,get:function(e,t){var n=g.UINT32_BE.get(e,t);if(n<0)throw new Error("Invalid atom header length");return{length:n,name:s.FourCcToken.get(e,t+4)}},put:function(e,t,n){return g.UINT32_BE.put(e,t,n.length),s.FourCcToken.put(e,t+4,n.name)}},exports.ExtendedSize=g.UINT64_BE,exports.ftyp={len:4,get:function(e,t){return{type:new g.StringType(4,"ascii").get(e,t)}}},exports.mhdr={len:8,get:function(e,t){return{version:g.UINT8.get(e,t+0),flags:g.UINT24_BE.get(e,t+1),nextItemID:g.UINT32_BE.get(e,t+4)}}};var T=function e(t,n,r){if(c(this,e),this.len=t,t<n)throw new Error("Atom ".concat(r," expected to be ").concat(n,", but specifies ").concat(t," bytes long."));t>n&&l("Warning: atom ".concat(r," expected to be ").concat(n,", but was actually ").concat(t," bytes long."))};exports.FixedLengthAtom=T;var p=function(e){function t(e){var n;return c(this,t),(n=r(this,i(t).call(this,e,24,"mdhd"))).len=e,n}return u(t,T),n(t,[{key:"get",value:function(e,t){return{version:g.UINT8.get(e,t+0),flags:g.UINT24_BE.get(e,t+1),creationTime:g.UINT32_BE.get(e,t+4),modificationTime:g.UINT32_BE.get(e,t+8),timeScale:g.UINT32_BE.get(e,t+12),duration:g.UINT32_BE.get(e,t+16),language:g.UINT16_BE.get(e,t+20),quality:g.UINT16_BE.get(e,t+22)}}}]),t}();exports.MdhdAtom=p;var I=function(e){function t(e){var n;return c(this,t),(n=r(this,i(t).call(this,e,100,"mvhd"))).len=e,n}return u(t,T),n(t,[{key:"get",value:function(e,t){return{version:g.UINT8.get(e,t+0),flags:g.UINT24_BE.get(e,t+1),creationTime:g.UINT32_BE.get(e,t+4),modificationTime:g.UINT32_BE.get(e,t+8),timeScale:g.UINT32_BE.get(e,t+12),duration:g.UINT32_BE.get(e,t+16),preferredRate:g.UINT32_BE.get(e,t+20),preferredVolume:g.UINT16_BE.get(e,t+24),previewTime:g.UINT32_BE.get(e,t+72),previewDuration:g.UINT32_BE.get(e,t+76),posterTime:g.UINT32_BE.get(e,t+80),selectionTime:g.UINT32_BE.get(e,t+84),selectionDuration:g.UINT32_BE.get(e,t+88),currentTime:g.UINT32_BE.get(e,t+92),nextTrackID:g.UINT32_BE.get(e,t+96)}}}]),t}();exports.MvhdAtom=I;var _=function(){function e(t){c(this,e),this.len=t}return n(e,[{key:"get",value:function(e,t){return{type:{set:g.UINT8.get(e,t+0),type:g.UINT24_BE.get(e,t+1)},locale:g.UINT24_BE.get(e,t+4),value:new g.BufferType(this.len-8).get(e,t+8)}}}]),e}();exports.DataAtom=_;var m=function(){function e(t){c(this,e),this.len=t}return n(e,[{key:"get",value:function(e,t){return{version:g.UINT8.get(e,t),flags:g.UINT24_BE.get(e,t+1),name:new g.StringType(this.len-4,"utf-8").get(e,t+4)}}}]),e}();exports.NameAtom=m;var E=function(){function e(t){c(this,e),this.len=t}return n(e,[{key:"get",value:function(e,t){return{version:g.UINT8.get(e,t),flags:g.UINT24_BE.get(e,t+1),creationTime:g.UINT32_BE.get(e,t+4),modificationTime:g.UINT32_BE.get(e,t+8),trackId:g.UINT32_BE.get(e,t+12),duration:g.UINT32_BE.get(e,t+20),layer:g.UINT16_BE.get(e,t+24),alternateGroup:g.UINT16_BE.get(e,t+26),volume:g.UINT16_BE.get(e,t+28)}}}]),e}();exports.TrackHeaderAtom=E;var N={len:8,get:function(e,t){return{version:g.UINT8.get(e,t+0),flags:g.UINT24_BE.get(e,t+1),numberOfEntries:g.UINT32_BE.get(e,t+4)}}},B=function(){function e(t){c(this,e),this.len=t}return n(e,[{key:"get",value:function(e,t){return{dataFormat:s.FourCcToken.get(e,t),dataReferenceIndex:g.UINT16_BE.get(e,t+10),description:new g.BufferType(this.len-12).get(e,t+12)}}}]),e}(),U=function(){function e(t){c(this,e),this.len=t}return n(e,[{key:"get",value:function(e,t){var n=N.get(e,t);t+=N.len;for(var r=[],o=0;o<n.numberOfEntries;++o){var i=g.UINT32_BE.get(e,t);t+=g.UINT32_BE.len,r.push(new B(i).get(e,t)),t+=i}return{header:n,table:r}}}]),e}();exports.StsdAtom=U,exports.SoundSampleDescriptionVersion={len:8,get:function(e,t){return{version:g.INT16_BE.get(e,t),revision:g.INT16_BE.get(e,t+2),vendor:g.INT32_BE.get(e,t+4)}}},exports.SoundSampleDescriptionV0={len:12,get:function(e,t){return{numAudioChannels:g.INT16_BE.get(e,t+0),sampleSize:g.INT16_BE.get(e,t+2),compressionId:g.INT16_BE.get(e,t+4),packetSize:g.INT16_BE.get(e,t+6),sampleRate:g.UINT16_BE.get(e,t+8)+g.UINT16_BE.get(e,t+10)/1e4}}};
},{"token-types":"1rOY","../common/FourCC":"P2sd","debug":"j+D9"}],"0TSH":[function(require,module,exports) {
"use strict";function e(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(c){return void r(c)}u.done?t(s):Promise.resolve(s).then(n,a)}function t(t){return function(){var r=this,n=arguments;return new Promise(function(a,i){var o=t.apply(r,n);function u(t){e(o,a,i,u,s,"next",t)}function s(t){e(o,a,i,u,s,"throw",t)}u(void 0)})}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var i=require("strtok3/lib/type"),o=require("debug"),u=require("token-types"),s=require("./AtomToken"),c=o("music-metadata:parser:MP4:Atom"),h=function(){function e(t,n,a){r(this,e),this.header=t,this.extended=n,this.parent=a,this.children=[],this.atomPath=(this.parent?this.parent.atomPath+"/":"")+this.header.name,this.dataLen=this.header.length-(n?16:8)}return a(e,[{key:"readAtoms",value:function(){var e=t(regeneratorRuntime.mark(function e(t,r,n){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readAtom(t,r);case 2:if(a=e.sent,this.children.push(a),void 0!==n){e.next=6;break}return e.abrupt("return",this.readAtoms(t,r,n).catch(function(e){if(e.message!==i.endOfFile)throw e;c("Reached end-of-file")}));case 6:if(!((n-=a.header.length)>0)){e.next=9;break}return e.abrupt("return",this.readAtoms(t,r,n));case 9:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"readAtom",value:function(){var r=t(regeneratorRuntime.mark(function t(r,n){var a,i,o,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.position,t.next=3,r.readToken(s.Header);case 3:if(i=t.sent,!(o=1===i.length)){t.next=9;break}return t.next=8,r.readToken(s.ExtendedSize);case 8:i.length=t.sent;case 9:return u=new e(i,o,this),c("parse atom name=".concat(u.atomPath,", extended=").concat(u.extended,", offset=").concat(a,", len=").concat(u.header.length)),t.next=13,u.readData(r,n);case 13:return t.abrupt("return",u);case 14:case"end":return t.stop()}},t,this)}));return function(e,t){return r.apply(this,arguments)}}()},{key:"readData",value:function(){var e=t(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.header.name,e.next="moov"===e.t0?3:"udta"===e.t0?3:"trak"===e.t0?3:"mdia"===e.t0?3:"minf"===e.t0?3:"stbl"===e.t0?3:"<id>"===e.t0?3:"ilst"===e.t0?3:"meta"===e.t0?4:"mdhd"===e.t0?7:"mvhd"===e.t0?7:"tkhd"===e.t0?7:"stsz"===e.t0?7:(e.t0,7);break;case 3:return e.abrupt("return",this.readAtoms(t,r,this.dataLen));case 4:return e.next=6,t.readToken(new u.IgnoreType(4));case 6:return e.abrupt("return",this.readAtoms(t,r,this.dataLen-4));case 7:return e.abrupt("return",r(this));case 8:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()}]),e}();exports.Atom=h;
},{"strtok3/lib/type":"2Fe+","debug":"j+D9","token-types":"1rOY","./AtomToken":"wi0z"}],"eyoP":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,r,a,n,o,s){try{var i=e[o](s),u=i.value}catch(c){return void r(c)}i.done?t(u):Promise.resolve(u).then(a,n)}function a(e){return function(){var t=this,a=arguments;return new Promise(function(n,o){var s=e.apply(t,a);function i(e){r(s,n,o,i,u,"next",e)}function u(e){r(s,n,o,i,u,"throw",e)}i(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function i(e,r){return!r||"object"!==t(r)&&"function"!=typeof r?u(e):r}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var d=require("debug"),f=require("token-types"),l=require("../common/BasicParser"),h=require("./Atom"),y=require("./AtomToken"),v=require("../id3v1/ID3v1Parser"),b=d("music-metadata:parser:MP4"),k="iTunes",g={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function w(e,t,r){return r.indexOf(e)===t}var x=function(t){function r(){return n(this,r),i(this,c(r).apply(this,arguments))}return p(r,l.BasicParser),s(r,[{key:"parse",value:function(){var e=a(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.formatList=[],t=new h.Atom({name:"mp4",length:this.tokenizer.fileSize},!1,null),e.next=4,t.readAtoms(this.tokenizer,function(){var e=a(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.parent){e.next=10;break}e.t0=t.parent.header.name,e.next="ilst"===e.t0?4:"<id>"===e.t0?4:"stbl"===e.t0?5:10;break;case 4:return e.abrupt("return",r.parseMetadataItemData(t));case 5:e.t1=t.header.name,e.next="stsd"===e.t1?8:9;break;case 8:return e.abrupt("return",r.parseAtom_stsd(t.dataLen));case 9:b("Ignore: stbl/".concat(t.header.name," atom"));case 10:e.t2=t.header.name,e.next="ftyp"===e.t2?13:"mdhd"===e.t2?20:"mvhd"===e.t2?21:"mdat"===e.t2?22:25;break;case 13:return e.next=15,r.parseAtom_ftyp(t.dataLen);case 15:return a=e.sent,b("ftyp: ".concat(a.join("/"))),n=a.filter(w).join("/"),r.metadata.setFormat("container",n),e.abrupt("return");case 20:return e.abrupt("return",r.parseAtom_mdhd(t));case 21:return e.abrupt("return",r.parseAtom_mvhd(t));case 22:return r.audioLengthInBytes=t.dataLen,r.calculateBitRate(),e.abrupt("break",25);case 25:return e.next=27,r.tokenizer.readToken(new f.IgnoreType(t.dataLen));case 27:b("Ignore atom data: path=".concat(t.atomPath,", payload-len=").concat(t.dataLen));case 28:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.tokenizer.fileSize);case 4:this.metadata.setFormat("codec",this.formatList.filter(w).join("+"));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"calculateBitRate",value:function(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}},{key:"addTag",value:function(e,t){this.metadata.addTag(k,e,t)}},{key:"addWarning",value:function(e){b("Warning:"+e),this.warnings.push(e)}},{key:"parseMetadataItemData",value:function(e){var t=this,r=e.header.name;return e.readAtoms(this.tokenizer,function(){var e=a(regeneratorRuntime.mark(function e(a){var n,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=a.header.name,e.next="data"===e.t0?3:"name"===e.t0?4:"mean"===e.t0?9:14;break;case 3:return e.abrupt("return",t.parseValueAtom(r,a));case 4:return e.next=6,t.tokenizer.readToken(new y.NameAtom(a.dataLen));case 6:return n=e.sent,r+=":"+n.name,e.abrupt("break",18);case 9:return e.next=11,t.tokenizer.readToken(new y.NameAtom(a.dataLen));case 11:return o=e.sent,r+=":"+o.name,e.abrupt("break",18);case 14:return e.next=16,t.tokenizer.readToken(new f.BufferType(a.dataLen));case 16:s=e.sent,t.addWarning("Unsupported meta-item: "+r+"["+a.header.name+"] => value="+s.toString("hex")+" ascii="+s.toString("ascii"));case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),e.dataLen)}},{key:"parseValueAtom",value:function(){var t=a(regeneratorRuntime.mark(function t(a,n){var o,s,i,u,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.tokenizer.readToken(new y.DataAtom(n.header.length-y.Header.len));case 2:if(0===(o=t.sent).type.set){t.next=5;break}throw new Error("Unsupported type-set != 0: "+o.type.set);case 5:t.t0=o.type.type,t.next=0===t.t0?8:1===t.t0?20:18===t.t0?20:13===t.t0?22:14===t.t0?26:21===t.t0?30:22===t.t0?32:65===t.t0?34:66===t.t0?36:67===t.t0?38:40;break;case 8:t.t1=a,t.next="trkn"===t.t1?11:"disk"===t.t1?11:"gnre"===t.t1?15:19;break;case 11:return s=f.UINT8.get(o.value,3),i=f.UINT8.get(o.value,5),this.addTag(a,s+"/"+i),t.abrupt("break",19);case 15:return u=f.UINT8.get(o.value,1),c=v.Genres[u-1],this.addTag(a,c),t.abrupt("break",19);case 19:return t.abrupt("break",41);case 20:return this.addTag(a,o.value.toString("utf-8")),t.abrupt("break",41);case 22:if(!this.options.skipCovers){t.next=24;break}return t.abrupt("break",41);case 24:return this.addTag(a,{format:"image/jpeg",data:e.from(o.value)}),t.abrupt("break",41);case 26:if(!this.options.skipCovers){t.next=28;break}return t.abrupt("break",41);case 28:return this.addTag(a,{format:"image/png",data:e.from(o.value)}),t.abrupt("break",41);case 30:return this.addTag(a,r.read_BE_Signed_Integer(o.value)),t.abrupt("break",41);case 32:return this.addTag(a,r.read_BE_Unsigned_Integer(o.value)),t.abrupt("break",41);case 34:return this.addTag(a,o.value.readInt8(0)),t.abrupt("break",41);case 36:return this.addTag(a,o.value.readInt16BE(0)),t.abrupt("break",41);case 38:return this.addTag(a,o.value.readInt32BE(0)),t.abrupt("break",41);case 40:this.addWarning("atom key=".concat(a,", has unknown well-known-type (data-type): ").concat(o.type.type));case 41:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"parseAtom_mvhd",value:function(){var e=a(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(new y.MvhdAtom(t.dataLen));case 2:r=e.sent,this.parse_mxhd(r);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseAtom_mdhd",value:function(){var e=a(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(new y.MdhdAtom(t.dataLen));case 2:r=e.sent,this.parse_mxhd(r);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parse_mxhd",value:function(e){if(e.timeScale&&!this.metadata.format.duration){var t=e.duration/e.timeScale;this.metadata.setFormat("duration",t),this.calculateBitRate()}}},{key:"parseAtom_ftyp",value:function(){var e=a(regeneratorRuntime.mark(function e(t){var r,a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(y.ftyp);case 2:if(r=e.sent,!((t-=y.ftyp.len)>0)){e.next=11;break}return e.next=7,this.parseAtom_ftyp(t);case 7:return a=e.sent,(n=r.type.replace(/\W/g,"")).length>0&&a.push(n),e.abrupt("return",a);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseAtom_stsd",value:function(){var e=a(regeneratorRuntime.mark(function e(t){var r,a,n,o,s,i,u,c,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(new y.StsdAtom(t));case 2:for(r=e.sent,a=[],n=!0,o=!1,s=void 0,e.prev=7,i=r.table[Symbol.iterator]();!(n=(u=i.next()).done);n=!0)c=u.value,(p=g[c.dataFormat])?(this.parseSoundSampleDescription(c),this.metadata.setFormat("lossless",!p.lossy),a.push(p.format)):b("Warning: data-format '".concat(c.dataFormat,"' missing in MP4Parser.encoderDict"));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),o=!0,s=e.t0;case 15:e.prev=15,e.prev=16,n||null==i.return||i.return();case 18:if(e.prev=18,!o){e.next=21;break}throw s;case 21:return e.finish(18);case 22:return e.finish(15);case 23:a.length>0&&this.formatList.push(a.join("/"));case 24:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22]])}));return function(t){return e.apply(this,arguments)}}()},{key:"parseSoundSampleDescription",value:function(e){var t=0,r=y.SoundSampleDescriptionVersion.get(e.description,t);if(t+=y.SoundSampleDescriptionVersion.len,0===r.version||1===r.version){var a=y.SoundSampleDescriptionV0.get(e.description,t);this.metadata.setFormat("sampleRate",a.sampleRate),this.metadata.setFormat("bitsPerSample",a.sampleSize),this.metadata.setFormat("numberOfChannels",a.numAudioChannels)}else b("Warning: sound-sample-description ".concat(r," not implemented"))}}],[{key:"read_BE_Signed_Integer",value:function(e){return f.readIntBE(e,0,e.length)}},{key:"read_BE_Unsigned_Integer",value:function(e){return f.readUIntBE(e,0,e.length)}}]),r}();exports.MP4Parser=x;
},{"debug":"j+D9","token-types":"1rOY","../common/BasicParser":"O0hF","./Atom":"0TSH","./AtomToken":"wi0z","../id3v1/ID3v1Parser":"WTnS","buffer":"z1tx"}],"jtQL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("token-types");exports.InfoTagHeaderTag=new e.StringType(4,"ascii"),exports.LameEncoderVersion=new e.StringType(6,"ascii"),exports.XingInfoTag={len:136,get:function(t,r){return{headerFlags:new e.BufferType(4).get(t,r),numFrames:e.UINT32_BE.get(t,r+4),streamSize:e.UINT32_BE.get(t,r+8),vbrScale:e.UINT32_BE.get(t,r+112),codec:new e.StringType(9,"ascii").get(t,r+116),infoTagRevision:e.UINT8.get(t,r+125)>>4,vbrMethod:15&e.UINT8.get(t,r+125)}}};
},{"token-types":"1rOY"}],"7/3S":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,r,n,a,i,s){try{var o=e[i](s),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,a)}function n(e){return function(){var t=this,n=arguments;return new Promise(function(a,i){var s=e.apply(t,n);function o(e){r(s,a,i,o,u,"next",e)}function u(e){r(s,a,i,o,u,"throw",e)}o(void 0)})}}function a(e,r){return!r||"object"!==t(r)&&"function"!=typeof r?i(e):r}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var l=require("assert"),m=require("token-types"),d=require("strtok3/lib/type"),p=require("debug"),b=require("../common/Util"),g=require("../id3v2/AbstractID3Parser"),k=require("./XingTag"),y=p("music-metadata:parser:mpeg"),v=1024,x={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,void 0,void 0,-1]},F=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]],C=function(){function e(t,r){c(this,e),this.versionIndex=b.default.getBitAllignedNumber(t,r+1,3,2),this.layer=e.LayerDescription[b.default.getBitAllignedNumber(t,r+1,5,2)],this.versionIndex>1&&0===this.layer?this.parseAdtsHeader(t,r):this.parseMpegHeader(t,r),this.isProtectedByCRC=!b.default.isBitSet(t,r+1,7)}return h(e,[{key:"calcDuration",value:function(e){return e*this.calcSamplesPerFrame()/this.samplingRate}},{key:"calcSamplesPerFrame",value:function(){return e.samplesInFrameTable[1===this.version?0:1][this.layer]}},{key:"calculateSideInfoLength",value:function(){if(3!==this.layer)return 2;if(3===this.channelModeIndex){if(1===this.version)return 17;if(2===this.version||2.5===this.version)return 9}else{if(1===this.version)return 32;if(2===this.version||2.5===this.version)return 17}}},{key:"calcSlotSize",value:function(){return[null,4,1,1][this.layer]}},{key:"parseMpegHeader",value:function(t,r){this.container="MPEG",this.bitrateIndex=b.default.getBitAllignedNumber(t,r+2,0,4),this.sampRateFreqIndex=b.default.getBitAllignedNumber(t,r+2,4,2),this.padding=b.default.isBitSet(t,r+2,6),this.privateBit=b.default.isBitSet(t,r+2,7),this.channelModeIndex=b.default.getBitAllignedNumber(t,r+3,0,2),this.modeExtension=b.default.getBitAllignedNumber(t,r+3,2,2),this.isCopyrighted=b.default.isBitSet(t,r+3,4),this.isOriginalMedia=b.default.isBitSet(t,r+3,5),this.emphasis=b.default.getBitAllignedNumber(t,r+3,7,2),this.version=e.VersionID[this.versionIndex],this.channelMode=e.ChannelMode[this.channelModeIndex],this.codec="MP"+this.layer;var n=this.calcBitrate();if(!n)throw new Error("Cannot determine bit-rate");if(this.bitrate=null===n?null:1e3*n,this.samplingRate=this.calcSamplingRate(),null==this.samplingRate)throw new Error("Cannot determine sampling-rate")}},{key:"parseAdtsHeader",value:function(e,t){y("layer=0 => ADTS"),this.version=2===this.versionIndex?4:2,this.container="ADTS/MPEG-"+this.version;var r=b.default.getBitAllignedNumber(e,t+2,0,2);this.codec="AAC",this.codecProfile=x.AudioObjectTypes[r],y("MPEG-4 audio-codec=".concat(this.codec));var n=b.default.getBitAllignedNumber(e,t+2,2,4);this.samplingRate=x.SamplingFrequencies[n],y("sampling-rate=".concat(this.samplingRate));var a=b.default.getBitAllignedNumber(e,t+2,7,3);this.mp4ChannelConfig=F[a],y("channel-config=".concat(this.mp4ChannelConfig.join("+"))),this.frameLength=b.default.getBitAllignedNumber(e,t+3,6,2)<<11}},{key:"calcBitrate",value:function(){if(0===this.bitrateIndex)return null;if(15===this.bitrateIndex)return null;var t=this.version.toString()+this.layer;return e.bitrate_index[this.bitrateIndex][t]}},{key:"calcSamplingRate",value:function(){return 3===this.sampRateFreqIndex?null:e.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}]),e}();C.SyncByte1=255,C.SyncByte2=224,C.VersionID=[2.5,null,2,1],C.LayerDescription=[0,3,2,1],C.ChannelMode=["stereo","joint_stereo","dual_channel","mono"],C.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}},C.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}},C.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];var P={len:4,get:function(e,t){return new C(e,t)}};function S(e){return"V"+(100-e)/10}var w=function(t){function r(){var t;return c(this,r),(t=a(this,s(r).apply(this,arguments))).frameCount=0,t.syncFrameCount=-1,t.countSkipFrameData=0,t.totalDataLength=0,t.bitrates=[],t.calculateEofDuration=!1,t.buf_frame_header=e.alloc(4),t.syncPeek={buf:e.alloc(v),len:0},t}return o(r,g.AbstractID3Parser),h(r,[{key:"_parse",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.metadata.setFormat("lossless",!1),e.prev=1,t=!1;case 3:if(t){e.next=11;break}return e.next=6,this.sync();case 6:return e.next=8,this.parseCommonMpegHeader();case 8:t=e.sent,e.next=3;break;case 11:e.next=20;break;case 13:if(e.prev=13,e.t0=e.catch(1),e.t0.message!==d.endOfFile){e.next=19;break}this.calculateEofDuration&&(r=this.frameCount*this.samplesPerFrame,this.metadata.setFormat("numberOfSamples",r),n=r/this.metadata.format.sampleRate,y("Calculate duration at EOF: ".concat(n," sec."),n),this.metadata.setFormat("duration",n)),e.next=20;break;case 19:throw e.t0;case 20:case"end":return e.stop()}},e,this,[[1,13]])}));return function(){return e.apply(this,arguments)}}()},{key:"finalize",value:function(){var e=this.metadata.format,t=this.metadata.native.hasOwnProperty("ID3v1");if(e.duration&&this.tokenizer.fileSize){var r=this.tokenizer.fileSize-this.mpegOffset-(t?128:0);e.codecProfile&&"V"===e.codecProfile[0]&&this.metadata.setFormat("bitrate",8*r/e.duration)}else if(this.tokenizer.fileSize&&"CBR"===e.codecProfile){var n=this.tokenizer.fileSize-this.mpegOffset-(t?128:0),a=Math.round(n/this.frame_size)*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",a);var i=a/e.sampleRate;y("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}},{key:"sync",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!1;case 1:return r=0,e.next=5,this.tokenizer.peekBuffer(this.syncPeek.buf,0,v,this.tokenizer.position,!0);case 5:if(this.syncPeek.len=e.sent,!(this.syncPeek.len<=256)){e.next=8;break}throw new Error(d.endOfFile);case 8:if(0!==this.syncPeek.len){e.next=10;break}throw new Error(d.endOfFile);case 10:if(!t||224!=(224&this.syncPeek.buf[r])){e.next=22;break}return this.buf_frame_header[0]=C.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[r],e.next=16,this.tokenizer.ignore(r);case 16:return y("Sync at offset=".concat(this.tokenizer.position-1,", frameCount=").concat(this.frameCount)),this.syncFrameCount===this.frameCount&&(y("Re-synced MPEG stream, frameCount=".concat(this.frameCount)),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount,e.abrupt("return");case 22:if(t=!1,-1!==(r=this.syncPeek.buf.indexOf(C.SyncByte1,r))){e.next=32;break}if(!(this.syncPeek.len<this.syncPeek.buf.length)){e.next=27;break}throw new Error(d.endOfFile);case 27:return e.next=29,this.tokenizer.ignore(this.syncPeek.len);case 29:return e.abrupt("break",36);case 32:++r,t=!0;case 34:e.next=10;break;case 36:e.next=1;break;case 38:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseCommonMpegHeader",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return 0===this.frameCount&&(this.mpegOffset=this.tokenizer.position-1),e.next=3,this.tokenizer.peekBuffer(this.buf_frame_header,1,3);case 3:e.prev=3,t=P.get(this.buf_frame_header,0),e.next=13;break;case 7:return e.prev=7,e.t0=e.catch(3),e.next=11,this.tokenizer.ignore(1);case 11:return this.warnings.push("Parse error: "+e.t0.message),e.abrupt("return",!1);case 13:return e.next=15,this.tokenizer.ignore(3);case 15:if(this.metadata.setFormat("container",t.container),this.metadata.setFormat("codec",t.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",t.samplingRate),this.frameCount++,!(t.version>=2&&0===t.layer)){e.next=24;break}return e.abrupt("return",this.parseAdts(t));case 24:return e.abrupt("return",this.parseAudioFrameHeader(t));case 25:case"end":return e.stop()}},e,this,[[3,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"parseAudioFrameHeader",value:function(){var e=n(regeneratorRuntime.mark(function e(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.metadata.setFormat("numberOfChannels","mono"===t.channelMode?1:2),this.metadata.setFormat("bitrate",t.bitrate),this.frameCount<2e5&&y("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,t.layer,t.bitrate,t.samplingRate),null!==(r=t.calcSlotSize())){e.next=6;break}throw new Error("invalid slot_size");case 6:if(n=t.calcSamplesPerFrame(),y("samples_per_frame=".concat(n)),a=n/8*t.bitrate/t.samplingRate+(t.padding?r:0),this.frame_size=Math.floor(a),this.audioFrameHeader=t,this.bitrates.push(t.bitrate),1!==this.frameCount){e.next=18;break}return this.offset=P.len,e.next=17,this.skipSideInformation();case 17:return e.abrupt("return",!1);case 18:if(3!==this.frameCount){e.next=30;break}if(!this.areAllSame(this.bitrates)){e.next=26;break}if(this.samplesPerFrame=n,this.metadata.setFormat("codecProfile","CBR"),!this.tokenizer.fileSize){e.next=24;break}return e.abrupt("return",!0);case 24:e.next=28;break;case 26:if(!this.metadata.format.duration){e.next=28;break}return e.abrupt("return",!0);case 28:if(this.options.duration){e.next=30;break}return e.abrupt("return",!0);case 30:if(this.options.duration&&4===this.frameCount&&(this.samplesPerFrame=n,this.calculateEofDuration=!0),this.offset=4,!t.isProtectedByCRC){e.next=38;break}return e.next=35,this.parseCrc();case 35:return e.abrupt("return",!1);case 38:return e.next=40,this.skipSideInformation();case 40:return e.abrupt("return",!1);case 41:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseAdts",value:function(){var t=n(regeneratorRuntime.mark(function t(r){var n,a,i,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.alloc(3),t.next=3,this.tokenizer.readBuffer(n);case 3:if(r.frameLength+=b.default.getBitAllignedNumber(n,0,0,11),this.tokenizer.ignore(r.frameLength-7),this.totalDataLength+=r.frameLength,this.samplesPerFrame=1024,a=r.samplingRate/this.samplesPerFrame,i=0===this.frameCount?0:this.totalDataLength/this.frameCount,s=8*i*a+.5,this.metadata.setFormat("codecProfile",r.codecProfile),this.metadata.setFormat("bitrate",s),r.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",r.mp4ChannelConfig.length),y("frame-count=".concat(this.frameCount,", size=").concat(r.frameLength," bytes, bit-rate=").concat(s)),3!==this.frameCount){t.next=20;break}if(!this.options.duration){t.next=19;break}this.calculateEofDuration=!0,t.next=20;break;case 19:return t.abrupt("return",!0);case 20:return t.abrupt("return",!1);case 21:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"parseCrc",value:function(){var e=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readNumber(m.INT16_BE);case 2:return this.crc=e.sent,this.offset+=2,e.abrupt("return",this.skipSideInformation());case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"skipSideInformation",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.audioFrameHeader.calculateSideInfoLength(),e.next=3,this.tokenizer.readToken(new m.BufferType(t));case 3:return this.offset+=t,e.next=6,this.readXtraInfoHeader();case 6:return e.abrupt("return");case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"readXtraInfoHeader",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t,r,n,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(k.InfoTagHeaderTag);case 2:t=e.sent,this.offset+=k.InfoTagHeaderTag.len,e.t0=t,e.next="Info"===e.t0?7:"Xing"===e.t0?9:"Xtra"===e.t0?15:"LAME"===e.t0?16:24;break;case 7:return this.metadata.setFormat("codecProfile","CBR"),e.abrupt("return",this.readXingInfoHeader());case 9:return e.next=11,this.readXingInfoHeader();case 11:return r=e.sent,n=S(r.vbrScale),this.metadata.setFormat("codecProfile",n),e.abrupt("return",null);case 15:return e.abrupt("break",24);case 16:return e.next=18,this.tokenizer.readToken(k.LameEncoderVersion);case 18:return a=e.sent,this.offset+=k.LameEncoderVersion.len,this.metadata.setFormat("tool","LAME "+a),e.next=23,this.skipFrameData(this.frame_size-this.offset);case 23:return e.abrupt("return",null);case 24:if(!((i=this.frame_size-this.offset)<0)){e.next=29;break}this.warnings.push("Frame "+this.frameCount+"corrupt: negative frameDataLeft"),e.next=31;break;case 29:return e.next=31,this.skipFrameData(i);case 31:return e.abrupt("return",null);case 32:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"readXingInfoHeader",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(k.XingInfoTag);case 2:if(t=e.sent,this.offset+=k.XingInfoTag.len,this.metadata.setFormat("tool",b.default.stripNulls(t.codec)),1!=(1&t.headerFlags[3])){e.next=10;break}return r=this.audioFrameHeader.calcDuration(t.numFrames),this.metadata.setFormat("duration",r),y("Get duration from Xing header: %s",this.metadata.format.duration),e.abrupt("return",t);case 10:return n=this.frame_size-this.offset,e.next=13,this.skipFrameData(n);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"skipFrameData",value:function(){var e=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.ok(t>=0,"frame-data-left cannot be negative"),e.next=3,this.tokenizer.readToken(new m.IgnoreType(t));case 3:this.countSkipFrameData+=t;case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"areAllSame",value:function(e){var t=e[0];return e.every(function(e){return e===t})}}]),r}();exports.MpegParser=w;
},{"assert":"TfPC","token-types":"1rOY","strtok3/lib/type":"2Fe+","debug":"j+D9","../common/Util":"5e0M","../id3v2/AbstractID3Parser":"Tc8M","./XingTag":"jtQL","buffer":"z1tx"}],"yr5a":[function(require,module,exports) {
"use strict";function e(e,r,t,n,a,i,u){try{var o=e[i](u),s=o.value}catch(c){return void t(c)}o.done?r(s):Promise.resolve(s).then(n,a)}function r(r){return function(){var t=this,n=arguments;return new Promise(function(a,i){var u=r.apply(t,n);function o(r){e(u,a,i,o,s,"next",r)}function s(r){e(u,a,i,o,s,"throw",r)}o(void 0)})}}function t(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}Object.defineProperty(exports,"__esModule",{value:!0});var i=require("token-types"),u=require("../../common/Util"),o=require("debug"),s=o("music-metadata:parser:musepack:sv8"),c=new i.StringType(2,"binary"),l={len:5,get:function(e,r){return{crc:i.UINT32_LE.get(e,r),streamVersion:i.UINT8.get(e,r+4)}}},d={len:2,get:function(e,r){return{sampleFrequency:[44100,48e3,37800,32e3][u.default.getBitAllignedNumber(e,r,0,3)],maxUsedBands:u.default.getBitAllignedNumber(e,r,3,5),channelCount:u.default.getBitAllignedNumber(e,r+1,0,4)+1,msUsed:u.default.isBitSet(e,r+1,4),audioBlockFrames:u.default.getBitAllignedNumber(e,r+1,5,3)}}},f=function(){function e(r){t(this,e),this.tokenizer=r}return a(e,[{key:"readPacketHeader",value:function(){var e=r(regeneratorRuntime.mark(function e(){var r,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(c);case 2:return r=e.sent,e.next=5,this.readVariableSizeField();case 5:return t=e.sent,e.abrupt("return",{key:r,payloadLength:t.value-2-t.len});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"readStreamHeader",value:function(){var e=r(regeneratorRuntime.mark(function e(r){var t,n,a,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},s("Reading SH at offset=".concat(this.tokenizer.position)),e.next=4,this.tokenizer.readToken(l);case 4:return n=e.sent,r-=l.len,Object.assign(t,n),s("SH.streamVersion = ".concat(n.streamVersion)),e.next=10,this.readVariableSizeField();case 10:return a=e.sent,r-=a.len,t.sampleCount=a.value,e.next=15,this.readVariableSizeField();case 15:return i=e.sent,r-=i.len,t.beginningOfSilence=i.value,e.next=20,this.tokenizer.readToken(d);case 20:return u=e.sent,r-=d.len,Object.assign(t,u),e.next=25,this.tokenizer.ignore(r);case 25:return e.abrupt("return",t);case 26:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"readVariableSizeField",value:function(){var e=r(regeneratorRuntime.mark(function e(){var r,t,n,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>0&&void 0!==a[0]?a[0]:1,t=a.length>1&&void 0!==a[1]?a[1]:0,e.next=4,this.tokenizer.readToken(i.UINT8);case 4:if(0!=(128&(n=e.sent))){e.next=7;break}return e.abrupt("return",{len:r,value:t+n});case 7:return n&=127,n+=t,e.abrupt("return",this.readVariableSizeField(r+1,n<<7));case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();exports.StreamReader=f;
},{"token-types":"1rOY","../../common/Util":"5e0M","debug":"j+D9"}],"gbVp":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,a,o,u){try{var i=e[o](u),s=i.value}catch(c){return void r(c)}i.done?t(s):Promise.resolve(s).then(n,a)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(a,o){var u=e.apply(r,n);function i(e){t(u,a,o,i,s,"next",e)}function s(e){t(u,a,o,i,s,"throw",e)}i(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function u(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?i(t):r}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var f=require("debug"),h=require("assert"),m=require("../../common/BasicParser"),l=require("./StreamVersion8"),y=require("../../apev2/APEv2Parser"),d=require("../../common/FourCC"),b=f("music-metadata:parser:musepack"),k=function(e){function t(){var e;return n(this,t),(e=u(this,s(t).apply(this,arguments))).audioLength=0,e}return c(t,m.BasicParser),o(t,[{key:"parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(d.FourCcToken);case 2:return t=e.sent,h.equal(t,"MPCK","Magic number"),this.metadata.setFormat("container","Musepack, SV8"),e.abrupt("return",this.parsePacket());case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parsePacket",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=new l.StreamReader(this.tokenizer);case 1:return e.next=3,t.readPacketHeader();case 3:r=e.sent,b("packet-header key=".concat(r.key,", payloadLength=").concat(r.payloadLength)),e.t0=r.key,e.next="SH"===e.t0?8:"AP"===e.t0?16:"RG"===e.t0?20:"EI"===e.t0?20:"SO"===e.t0?20:"ST"===e.t0?20:"CT"===e.t0?20:"SE"===e.t0?23:25;break;case 8:return e.next=10,t.readStreamHeader(r.payloadLength);case 10:return n=e.sent,this.metadata.setFormat("numberOfSamples",n.sampleCount),this.metadata.setFormat("sampleRate",n.sampleFrequency),this.metadata.setFormat("duration",n.sampleCount/n.sampleFrequency),this.metadata.setFormat("numberOfChannels",n.channelCount),e.abrupt("break",26);case 16:return this.audioLength+=r.payloadLength,e.next=19,this.tokenizer.ignore(r.payloadLength);case 19:return e.abrupt("break",26);case 20:return e.next=22,this.tokenizer.ignore(r.payloadLength);case 22:return e.abrupt("break",26);case 23:return this.metadata.setFormat("bitrate",8*this.audioLength/this.metadata.format.duration),e.abrupt("return",y.APEv2Parser.parseTagHeader(this.metadata,this.tokenizer,this.options));case 25:throw new Error("Unexpected header: ".concat(r.key));case 26:e.next=1;break;case 27:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();exports.MpcSv8Parser=k;
},{"debug":"j+D9","assert":"TfPC","../../common/BasicParser":"O0hF","./StreamVersion8":"yr5a","../../apev2/APEv2Parser":"IhDz","../../common/FourCC":"P2sd"}],"6yVT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("token-types"),t=require("../../common/Util");exports.Header={len:24,get:function(i,r){var l={signature:i.toString("binary",r,r+3),streamMinorVersion:t.default.getBitAllignedNumber(i,r+3,0,4),streamMajorVersion:t.default.getBitAllignedNumber(i,r+3,4,4),frameCount:e.UINT32_LE.get(i,r+4),maxLevel:e.UINT16_LE.get(i,r+8),sampleFrequency:[44100,48e3,37800,32e3][t.default.getBitAllignedNumber(i,r+10,0,2)],link:t.default.getBitAllignedNumber(i,r+10,2,2),profile:t.default.getBitAllignedNumber(i,r+10,4,4),maxBand:t.default.getBitAllignedNumber(i,r+11,0,6),intensityStereo:t.default.isBitSet(i,r+11,6),midSideStereo:t.default.isBitSet(i,r+11,7),titlePeak:e.UINT16_LE.get(i,r+12),titleGain:e.UINT16_LE.get(i,r+14),albumPeak:e.UINT16_LE.get(i,r+16),albumGain:e.UINT16_LE.get(i,r+18),lastFrameLength:e.UINT32_LE.get(i,r+20)>>>20&2047,trueGapless:t.default.isBitSet(i,r+23,0)};return l.lastFrameLength=l.trueGapless?e.UINT32_LE.get(i,20)>>>20&2047:0,l}};
},{"token-types":"1rOY","../../common/Util":"5e0M"}],"qgDo":[function(require,module,exports) {
"use strict";function e(e,r,t,n,i,o,s){try{var a=e[o](s),u=a.value}catch(c){return void t(c)}a.done?r(u):Promise.resolve(u).then(n,i)}function r(r){return function(){var t=this,n=arguments;return new Promise(function(i,o){var s=r.apply(t,n);function a(r){e(s,i,o,a,u,"next",r)}function u(r){e(s,i,o,a,u,"throw",r)}a(void 0)})}}function t(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}Object.defineProperty(exports,"__esModule",{value:!0});var o=require("token-types"),s=function(){function e(r){t(this,e),this.tokenizer=r,this.pos=0,this.dword=void 0}return i(e,[{key:"read",value:function(){var e=r(regeneratorRuntime.mark(function e(r){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.dword){e.next=6;break}return e.next=3,this.tokenizer.readToken(o.UINT32_LE);case 3:this.dword=e.sent,e.next=0;break;case 6:if(t=this.dword,this.pos+=r,!(this.pos<32)){e.next=13;break}return t>>>=32-this.pos,e.abrupt("return",t&(1<<r)-1);case 13:if(this.pos-=32,0!==this.pos){e.next=19;break}return this.dword=void 0,e.abrupt("return",t&(1<<r)-1);case 19:return e.next=21,this.tokenizer.readToken(o.UINT32_LE);case 21:return this.dword=e.sent,this.pos&&(t<<=this.pos,t|=this.dword>>>32-this.pos),e.abrupt("return",t&(1<<r)-1);case 24:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"ignore",value:function(){var e=r(regeneratorRuntime.mark(function e(r){var t,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.pos>0&&(t=32-this.pos,this.dword=void 0,r-=t,this.pos=0),i=(r-(n=r%32))/32,e.next=5,this.tokenizer.ignore(4*i);case 5:return e.abrupt("return",this.read(n));case 6:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()}]),e}();exports.BitReader=s;
},{"token-types":"1rOY"}],"Kvit":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(a,o){var i=e.apply(r,n);function s(e){t(i,a,o,s,u,"next",e)}function u(e){t(i,a,o,s,u,"throw",e)}s(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function i(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?s(t):r}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var p=require("debug"),m=require("assert"),h=require("../../common/BasicParser"),d=require("./StreamVersion7"),l=require("../../apev2/APEv2Parser"),b=require("./BitReader"),y=p("music-metadata:parser:musepack"),v=function(e){function t(){var e;return n(this,t),(e=i(this,u(t).apply(this,arguments))).audioLength=0,e}return c(t,h.BasicParser),o(t,[{key:"parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(d.Header);case 2:return t=e.sent,m.equal(t.signature,"MP+","Magic number"),y("stream-version=".concat(t.streamMajorVersion,".").concat(t.streamMinorVersion)),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",t.sampleFrequency),r=1152*(t.frameCount-1)+t.lastFrameLength,this.metadata.setFormat("numberOfSamples",r),this.duration=r/t.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new b.BitReader(this.tokenizer),this.metadata.setFormat("numberOfChannels",t.midSideStereo||t.intensityStereo?2:1),e.next=15,this.bitreader.read(8);case 15:return n=e.sent,this.metadata.setFormat("codec",(n/100).toFixed(2)),e.next=19,this.skipAudioData(t.frameCount);case 19:return y("End of audio stream, switching to APEv2, offset=".concat(this.tokenizer.position)),e.abrupt("return",l.APEv2Parser.parseTagHeader(this.metadata,this.tokenizer,this.options));case 21:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"skipAudioData",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t-- >0)){e.next=9;break}return e.next=3,this.bitreader.read(20);case 3:return r=e.sent,this.audioLength+=20+r,e.next=7,this.bitreader.ignore(r);case 7:e.next=0;break;case 9:return e.next=11,this.bitreader.read(11);case 11:n=e.sent,this.audioLength+=n,this.metadata.setFormat("bitrate",this.audioLength/this.duration);case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}();exports.MpcSv7Parser=v;
},{"debug":"j+D9","assert":"TfPC","../../common/BasicParser":"O0hF","./StreamVersion7":"6yVT","../../apev2/APEv2Parser":"IhDz","./BitReader":"qgDo"}],"dsOL":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,o,u,i){try{var a=e[u](i),c=a.value}catch(s){return void r(s)}a.done?t(c):Promise.resolve(c).then(n,o)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(o,u){var i=e.apply(r,n);function a(e){t(i,o,u,a,c,"next",e)}function c(e){t(i,o,u,a,c,"throw",e)}a(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function i(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?a(t):r}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var f=require("debug"),l=require("token-types"),y=require("./sv8/MpcSv8Parser"),b=require("./sv7/MpcSv7Parser"),v=require("../id3v2/AbstractID3Parser"),h=f("music-metadata:parser:musepack"),m=function(e){function t(){return n(this,t),i(this,c(t).apply(this,arguments))}return s(t,v.AbstractID3Parser),u(t,[{key:"_parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.peekToken(new l.StringType(3,"binary"));case 2:t=e.sent,e.t0=t,e.next="MP+"===e.t0?6:"MPC"===e.t0?9:12;break;case 6:return h("Musepack stream-version 7"),r=new b.MpcSv7Parser,e.abrupt("break",13);case 9:return h("Musepack stream-version 8"),r=new y.MpcSv8Parser,e.abrupt("break",13);case 12:throw new Error("Invalid Musepack signature prefix");case 13:return r.init(this.metadata,this.tokenizer,this.options),e.abrupt("return",r.parse());case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();exports.default=m;
},{"debug":"j+D9","token-types":"1rOY","./sv8/MpcSv8Parser":"gbVp","./sv7/MpcSv7Parser":"Kvit","../id3v2/AbstractID3Parser":"Tc8M"}],"nYTK":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var s=require("token-types"),n=require("debug"),i=require("./Vorbis"),o=n("music-metadata:parser:ogg:vorbis1"),l=function(){function a(e,r){t(this,a),this.metadata=e,this.options=r,this.codecName="Vorbis I",this.pageSegments=[]}return r(a,[{key:"parsePage",value:function(t,a){if(t.headerType.firstPage)this.parseFirstPage(t,a);else{if(t.headerType.continued){if(0===this.pageSegments.length)throw new Error("Cannot continue on previous page");this.pageSegments.push(a)}if(t.headerType.lastPage||!t.headerType.continued){if(this.pageSegments.length>0){var r=e.concat(this.pageSegments);this.parseFullPage(r)}this.pageSegments=t.headerType.lastPage?[]:[a]}}t.headerType.lastPage&&this.calculateDuration(t)}},{key:"flush",value:function(){this.parseFullPage(e.concat(this.pageSegments))}},{key:"parseFirstPage",value:function(e,t){this.metadata.setFormat("codec","Vorbis I"),o("Parse first page");var a=i.CommonHeader.get(t,0);if("vorbis"!==a.vorbis)throw new Error("Metadata does not look like Vorbis");if(1!==a.packetType)throw new Error("First Ogg page should be type 1: the identification header");var r=i.IdentificationHeader.get(t,i.CommonHeader.len);this.metadata.setFormat("sampleRate",r.sampleRate),this.metadata.setFormat("bitrate",r.bitrateNominal),this.metadata.setFormat("numberOfChannels",r.channelMode),o("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",r.sampleRate,r.bitrateNominal,r.channelMode)}},{key:"parseFullPage",value:function(e){var t=i.CommonHeader.get(e,0);switch(o("Parse full page: type=%s, byteLength=%s",t.packetType,e.byteLength),t.packetType){case 3:return this.parseUserCommentList(e,i.CommonHeader.len)}}},{key:"calculateDuration",value:function(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate))}},{key:"parseUserCommentList",value:function(e,t){var a=s.UINT32_LE.get(e,t);t+=4;new s.StringType(a,"utf-8").get(e,t);t+=a;var r=s.UINT32_LE.get(e,t);for(t+=4;r-- >0;)t+=this.parseUserComment(e,t)}},{key:"parseUserComment",value:function(e,t){var a=s.UINT32_LE.get(e,t),r=new s.StringType(a,"utf-8").get(e,t+4),n=r.indexOf("="),l=r.slice(0,n).toUpperCase(),u=r.slice(n+1);return"METADATA_BLOCK_PICTURE"===l&&(u=this.options.skipCovers?null:i.VorbisPictureToken.fromBase64(u)),null!==u&&(o("Push tag: id=%s, value=%s",l,u),this.metadata.addTag("vorbis",l,u)),s.UINT32_LE.len+a}}]),a}();exports.VorbisParser=l;
},{"token-types":"1rOY","debug":"j+D9","./Vorbis":"IGPB","buffer":"z1tx"}],"rwC0":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("token-types"),a=function(){function n(t){if(e(this,n),this.len=t,t<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}return t(n,[{key:"get",value:function(e,n){return{magicSignature:new r.StringType(8,"ascii").get(e,n+0),version:e.readUInt8(n+8),channelCount:e.readUInt8(n+9),preSkip:e.readInt16LE(n+10),inputSampleRate:e.readInt32LE(n+12),outputGain:e.readInt16LE(n+16),channelMapping:e.readUInt8(n+18)}}}]),n}();exports.IdHeader=a;
},{"token-types":"1rOY"}],"Ja40":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function a(t,e,a){return e&&r(t.prototype,e),a&&r(t,a),t}function o(e,r){return!r||"object"!==t(r)&&"function"!=typeof r?n(e):r}function n(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(exports,"__esModule",{value:!0});var l=require("token-types"),c=require("./Opus"),f=require("../vorbis/VorbisParser"),p=function(t){function r(t,a,n){var s;return e(this,r),(s=o(this,i(r).call(this,t,a))).tokenizer=n,s.lastPos=-1,s}return s(r,f.VorbisParser),a(r,[{key:"parseFirstPage",value:function(t,e){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new c.IdHeader(e.length).get(e,0),"OpusHead"!==this.idHeader.magicSignature)throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}},{key:"parseFullPage",value:function(t){switch(new l.StringType(8,"ascii").get(t,0)){case"OpusTags":this.parseUserCommentList(t,8),this.lastPos=this.tokenizer.position}}},{key:"calculateDuration",value:function(t){if(this.metadata.format.sampleRate&&t.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",t.absoluteGranulePosition-this.idHeader.preSkip),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.idHeader.inputSampleRate),-1!==this.lastPos&&this.tokenizer.fileSize&&this.metadata.format.duration)){var e=this.tokenizer.fileSize-this.lastPos;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}}]),r}();exports.OpusParser=p;
},{"token-types":"1rOY","./Opus":"rwC0","../vorbis/VorbisParser":"nYTK"}],"PMZJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("token-types"),r=require("../../common/Util");exports.Header={len:80,get:function(t,n){return{speex:new e.StringType(8,"ascii").get(t,n+0),version:r.default.trimRightNull(new e.StringType(20,"ascii").get(t,n+8)),version_id:t.readInt32LE(n+28),header_size:t.readInt32LE(n+32),rate:t.readInt32LE(n+36),mode:t.readInt32LE(n+40),mode_bitstream_version:t.readInt32LE(n+44),nb_channels:t.readInt32LE(n+48),bitrate:t.readInt32LE(n+52),frame_size:t.readInt32LE(n+56),vbr:t.readInt32LE(n+60),frames_per_packet:t.readInt32LE(n+64),extra_headers:t.readInt32LE(n+68),reserved1:t.readInt32LE(n+72),reserved2:t.readInt32LE(n+76)}}};
},{"token-types":"1rOY","../../common/Util":"5e0M"}],"D7fj":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function o(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e}function n(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?a(t):r}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var s=require("debug"),f=require("./Speex"),p=require("../vorbis/VorbisParser"),l=s("music-metadata:parser:ogg:speex"),b=function(e){function r(e,o,a){var u;return t(this,r),(u=n(this,i(r).call(this,e,o))).tokenizer=a,u}return u(r,p.VorbisParser),o(r,[{key:"parseFirstPage",value:function(e,t){l("First Ogg/Speex page");var r=f.Header.get(t,0);this.metadata.setFormat("codec","Speex ".concat(r.version)),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),-1!==r.bitrate&&this.metadata.setFormat("bitrate",r.bitrate)}}]),r}();exports.SpeexParser=b;
},{"debug":"j+D9","./Speex":"PMZJ","../vorbis/VorbisParser":"nYTK"}],"/0Ar":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("token-types");exports.IdentificationHeader={len:42,get:function(t,r){return{id:new e.StringType(7,"ascii").get(t,r),vmaj:t.readUInt8(r+7),vmin:t.readUInt8(r+8),vrev:t.readUInt8(r+9),vmbw:t.readUInt16BE(r+10),vmbh:t.readUInt16BE(r+17),nombr:e.UINT24_BE.get(t,r+37),nqual:t.readUInt8(r+40)}}};
},{"token-types":"1rOY"}],"l43t":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("debug"),n=require("./Theora"),i=r("music-metadata:parser:ogg:theora"),o=function(){function t(a,r,n){e(this,t),this.metadata=a,this.tokenizer=n}return a(t,[{key:"parsePage",value:function(e,t){e.headerType.firstPage&&this.parseFirstPage(e,t)}},{key:"flush",value:function(){i("flush")}},{key:"parseFirstPage",value:function(e,t){i("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");var a=n.IdentificationHeader.get(t,0);this.metadata.setFormat("bitrate",a.nombr)}}]),t}();exports.TheoraParser=o;
},{"debug":"j+D9","./Theora":"/0Ar"}],"fxkA":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,a,o,s){try{var i=e[o](s),u=i.value}catch(c){return void r(c)}i.done?t(u):Promise.resolve(u).then(n,a)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(a,o){var s=e.apply(r,n);function i(e){t(s,a,o,i,u,"next",e)}function u(e){t(s,a,o,i,u,"throw",e)}i(void 0)})}}function n(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?a(t):r}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var g=require("token-types"),f=require("debug"),h=require("assert"),l=require("../common/Util"),b=require("../common/FourCC"),m=require("./vorbis/VorbisParser"),d=require("./opus/OpusParser"),y=require("./speex/SpeexParser"),P=require("../common/BasicParser"),k=require("./theora/TheoraParser"),v=f("music-metadata:parser:ogg"),S=function(){function e(t){u(this,e),this.len=t.page_segments}return p(e,null,[{key:"sum",value:function(e,t,r){for(var n=0,a=t;a<t+r;++a)n+=e[a];return n}}]),p(e,[{key:"get",value:function(t,r){return{totalPageSize:e.sum(t,r,this.len)}}}]),e}();exports.SegmentTable=S;var T=function(e){function t(){return u(this,t),n(this,o(t).apply(this,arguments))}return s(t,P.BasicParser),p(t,[{key:"parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){var r,n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:v("pos=%s, parsePage()",this.tokenizer.position),e.prev=1;case 2:return e.next=4,this.tokenizer.readToken(t.Header);case 4:return r=e.sent,h.strictEqual(r.capturePattern,"OggS","Ogg capture pattern"),this.metadata.setFormat("container","Ogg"),this.header=r,this.pageNumber=r.pageSequenceNo,v("page#=%s, Ogg.id=%s",r.pageSequenceNo,r.capturePattern),e.next=12,this.tokenizer.readToken(new S(r));case 12:return n=e.sent,v("totalPageSize=%s",n.totalPageSize),e.next=16,this.tokenizer.readToken(new g.BufferType(n.totalPageSize));case 16:if(a=e.sent,v("firstPage=%s, lastPage=%s, continued=%s",r.headerType.firstPage,r.headerType.lastPage,r.headerType.continued),!r.headerType.firstPage){e.next=36;break}o=new g.StringType(7,"ascii").get(a,0),e.t0=o,e.next="vorbis"===e.t0?23:"OpusHea"===e.t0?26:"Speex  "===e.t0?29:"\0theora"===e.t0?32:35;break;case 23:return v("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new m.VorbisParser(this.metadata,this.options),e.abrupt("break",36);case 26:return v("Set page consumer to Ogg/Opus"),this.pageConsumer=new d.OpusParser(this.metadata,this.options,this.tokenizer),e.abrupt("break",36);case 29:return v("Set page consumer to Ogg/Speex"),this.pageConsumer=new y.SpeexParser(this.metadata,this.options,this.tokenizer),e.abrupt("break",36);case 32:return v("Set page consumer to Ogg/Theora"),this.pageConsumer=new k.TheoraParser(this.metadata,this.options,this.tokenizer),e.abrupt("break",36);case 35:throw new Error("gg audio-codec not recognized (id="+o+")");case 36:this.pageConsumer.parsePage(r,a);case 37:if(!r.headerType.lastPage){e.next=2;break}case 38:e.next=51;break;case 40:if(e.prev=40,e.t1=e.catch(1),"End-Of-File"!==e.t1.message){e.next=46;break}return e.abrupt("return");case 46:if(!e.t1.message.startsWith("FourCC")){e.next=50;break}if(!(this.pageNumber>0)){e.next=50;break}return this.warnings.push("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),e.abrupt("return",this.pageConsumer.flush());case 50:throw e.t1;case 51:case"end":return e.stop()}},e,this,[[1,40]])}));return function(){return e.apply(this,arguments)}}()}]),t}();T.Header={len:27,get:function(e,t){return{capturePattern:b.FourCcToken.get(e,t),version:e.readUInt8(t+4),headerType:{continued:l.default.strtokBITSET.get(e,t+5,0),firstPage:l.default.strtokBITSET.get(e,t+5,1),lastPage:l.default.strtokBITSET.get(e,t+5,2)},absoluteGranulePosition:e.readIntLE(t+6,6),streamSerialNumber:g.UINT32_LE.get(e,t+14),pageSequenceNo:g.UINT32_LE.get(e,t+18),pageChecksum:g.UINT32_LE.get(e,t+22),page_segments:e.readUInt8(t+26)}}},exports.OggParser=T;
},{"token-types":"1rOY","debug":"j+D9","assert":"TfPC","../common/Util":"5e0M","../common/FourCC":"P2sd","./vorbis/VorbisParser":"nYTK","./opus/OpusParser":"Ja40","./speex/SpeexParser":"D7fj","../common/BasicParser":"O0hF","./theora/TheoraParser":"l43t"}],"JdqU":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("token-types"),i=require("../common/FourCC");exports.Header={len:8,get:function(e,n){return{chunkID:i.FourCcToken.get(e,n),chunkSize:e.readUInt32LE(n+4)}}};var o=function(){function n(t){e(this,n),this.tagHeader=t,this.len=t.chunkSize,this.len+=1&this.len}return t(n,[{key:"get",value:function(e,n){return new r.StringType(this.tagHeader.chunkSize,"ascii").get(e,n)}}]),n}();exports.ListInfoTagValue=o;
},{"token-types":"1rOY","../common/FourCC":"P2sd"}],"gDSg":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0});var r,a=require("assert");!function(e){e[e.PCM=1]="PCM",e[e.ADPCM=2]="ADPCM",e[e.IEEE_FLOAT=3]="IEEE_FLOAT",e[e.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",e[e.MPEG_LOAS=5634]="MPEG_LOAS",e[e.RAW_AAC1=255]="RAW_AAC1",e[e.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",e[e.DVM=8192]="DVM",e[e.RAW_SPORT=576]="RAW_SPORT",e[e.ESST_AC3=577]="ESST_AC3",e[e.DRM=9]="DRM",e[e.DTS2=8193]="DTS2",e[e.MPEG=80]="MPEG"}(r=exports.WaveFormat||(exports.WaveFormat={}));var o=function(){function n(t){e(this,n),a.ok(t.chunkSize>=16,"16 for PCM."),this.len=t.chunkSize}return t(n,[{key:"get",value:function(e,n){return{wFormatTag:e.readUInt16LE(n),nChannels:e.readUInt16LE(n+2),nSamplesPerSec:e.readUInt32LE(n+4),nAvgBytesPerSec:e.readUInt32LE(n+8),nBlockAlign:e.readUInt16LE(n+12),wBitsPerSample:e.readUInt16LE(n+14)}}}]),n}();exports.Format=o;var i=function(){function n(t){e(this,n),a.ok(t.chunkSize>=4,"minimum fact chunk size."),this.len=t.chunkSize}return t(n,[{key:"get",value:function(e,n){return{dwSampleLength:e.readUInt32LE(n)}}}]),n}();exports.FactChunk=i;
},{"assert":"TfPC"}],"UqqU":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(a,o){var i=e.apply(r,n);function s(e){t(i,a,o,s,u,"next",e)}function u(e){t(i,a,o,s,u,"throw",e)}s(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function i(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?s(t):r}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var f=require("strtok3/lib/type"),p=require("strtok3/lib/core"),m=require("token-types"),k=require("debug"),l=require("./RiffChunk"),d=require("./../wav/WaveChunk"),b=require("../id3v2/ID3v2Parser"),g=require("../common/Util"),y=require("../common/FourCC"),v=require("../common/BasicParser"),F=require("../id3v2/ID3Stream"),I=k("music-metadata:parser:RIFF"),w=function(e){function t(){return n(this,t),i(this,u(t).apply(this,arguments))}return c(t,v.BasicParser),o(t,[{key:"parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(l.Header);case 2:if(t=e.sent,I("pos=".concat(this.tokenizer.position,", parse: chunkID=").concat(t.chunkID)),"RIFF"===t.chunkID){e.next=6;break}return e.abrupt("return");case 6:return e.abrupt("return",this.parseRiffChunk().catch(function(e){if(e.message!==f.endOfFile)throw e}));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseRiffChunk",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(y.FourCcToken);case 2:t=e.sent,this.metadata.setFormat("container",t),e.t0=t,e.next="WAVE"===e.t0?7:8;break;case 7:return e.abrupt("return",this.readWaveChunk());case 8:throw new Error("Unsupported RIFF format: RIFF/".concat(t));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"readWaveChunk",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r,n,a,o,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(l.Header);case 2:t=e.sent,this.header=t,I("pos=".concat(this.tokenizer.position,", readChunk: chunkID=RIFF/WAVE/").concat(t.chunkID)),e.t0=t.chunkID,e.next="LIST"===e.t0?8:"fact"===e.t0?11:"fmt "===e.t0?16:"id3 "===e.t0?28:"ID3 "===e.t0?28:"data"===e.t0?36:44;break;case 8:return e.next=10,this.parseListTag(t);case 10:return e.abrupt("break",48);case 11:return this.metadata.setFormat("lossless",!1),e.next=14,this.tokenizer.readToken(new d.FactChunk(t));case 14:return this.fact=e.sent,e.abrupt("break",48);case 16:return e.next=18,this.tokenizer.readToken(new d.Format(t));case 18:return r=e.sent,(n=d.WaveFormat[r.wFormatTag])||(I("WAVE/non-PCM format="+r.wFormatTag),n="non-PCM ("+r.wFormatTag+")"),this.metadata.setFormat("codec",n),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign,e.abrupt("break",48);case 28:return e.next=30,this.tokenizer.readToken(new m.BufferType(t.chunkSize));case 30:return a=e.sent,o=new F.ID3Stream(a),i=p.fromStream(o),e.next=35,(new b.ID3v2Parser).parse(this.metadata,i,this.options);case 35:return e.abrupt("break",48);case 36:return!1!==this.metadata.format.lossless&&this.metadata.setFormat("lossless",!0),s=this.fact?this.fact.dwSampleLength:t.chunkSize/this.blockAlign,this.metadata.setFormat("numberOfSamples",s),this.metadata.setFormat("duration",s/this.metadata.format.sampleRate),this.metadata.setFormat("bitrate",this.metadata.format.numberOfChannels*this.blockAlign*this.metadata.format.sampleRate),e.next=43,this.tokenizer.ignore(t.chunkSize);case 43:return e.abrupt("break",48);case 44:return I("Ignore chunk: RIFF/".concat(t.chunkID," of ").concat(t.chunkSize," bytes")),this.warnings.push("Ignore chunk: RIFF/"+t.chunkID),e.next=48,this.tokenizer.ignore(t.chunkSize);case 48:if(this.header.chunkSize%2!=1){e.next=52;break}return I("Read odd padding byte"),e.next=52,this.tokenizer.ignore(1);case 52:e.next=0;break;case 53:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseListTag",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(y.FourCcToken);case 2:r=e.sent,I("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,r),e.t0=r,e.next="INFO"===e.t0?7:(e.t0,8);break;case 7:return e.abrupt("return",this.parseRiffInfoTags(t.chunkSize-4));case 8:return this.warnings.push("Ignore chunk: RIFF/WAVE/LIST/"+r),I("Ignoring chunkID=RIFF/WAVE/LIST/"+r),e.abrupt("return",this.tokenizer.ignore(t.chunkSize-4));case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"parseRiffInfoTags",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>=8)){e.next=12;break}return e.next=3,this.tokenizer.readToken(l.Header);case 3:return r=e.sent,n=new l.ListInfoTagValue(r),e.next=7,this.tokenizer.readToken(n);case 7:a=e.sent,this.addTag(r.chunkID,g.default.stripNulls(a)),t-=8+n.len,e.next=0;break;case 12:if(0===t){e.next=14;break}throw Error("Illegal remaining size: "+t);case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addTag",value:function(e,t){this.metadata.addTag("exif",e,t)}}]),t}();exports.WaveParser=w;
},{"strtok3/lib/type":"2Fe+","strtok3/lib/core":"tvmF","token-types":"1rOY","debug":"j+D9","./RiffChunk":"JdqU","./../wav/WaveChunk":"gDSg","../id3v2/ID3v2Parser":"pIqu","../common/Util":"5e0M","../common/FourCC":"P2sd","../common/BasicParser":"O0hF","../id3v2/ID3Stream":"Zy6X"}],"aBWN":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("token-types"),r=require("../common/FourCC"),o=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],l=function(){function t(){e(this,t)}return i(t,null,[{key:"isBitSet",value:function(e,i){return 1===t.getBitAllignedNumber(e,i,1)}},{key:"getBitAllignedNumber",value:function(e,t,i){return e>>>t&4294967295>>>32-i}}]),t}();l.BlockHeaderToken={len:32,get:function(e,t){var i=n.UINT32_LE.get(e,t+24),a={BlockID:r.FourCcToken.get(e,t),blockSize:n.UINT32_LE.get(e,t+4),version:n.UINT16_LE.get(e,t+8),totalSamples:(n.UINT8.get(e,t+11)<<32)+n.UINT32_LE.get(e,t+12),blockIndex:(n.UINT8.get(e,t+10)<<32)+n.UINT32_LE.get(e,t+16),blockSamples:n.UINT32_LE.get(e,t+20),flags:{bitsPerSample:8*(1+l.getBitAllignedNumber(i,0,2)),isMono:l.isBitSet(i,2),isHybrid:l.isBitSet(i,3),isJointStereo:l.isBitSet(i,4),crossChannel:l.isBitSet(i,5),hybridNoiseShaping:l.isBitSet(i,6),floatingPoint:l.isBitSet(i,7),samplingRate:o[l.getBitAllignedNumber(i,23,4)],isDSD:l.isBitSet(i,31)},crc:new n.BufferType(4).get(e,t+28)};return a.flags.isDSD&&(a.totalSamples*=8),a}},l.MetadataIdToken={len:1,get:function(e,t){return{functionId:l.getBitAllignedNumber(e[t],0,6),isOptional:l.isBitSet(e[t],5),isOddSize:l.isBitSet(e[t],6),largeBlock:l.isBitSet(e[t],7)}}},exports.WavPack=l;
},{"token-types":"1rOY","../common/FourCC":"P2sd"}],"0DiC":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t,a,r,n,o,i){try{var s=e[o](i),c=s.value}catch(u){return void a(u)}s.done?t(c):Promise.resolve(c).then(r,n)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function s(e){a(i,n,o,s,c,"next",e)}function c(e){a(i,n,o,s,c,"throw",e)}s(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,a){return t&&o(e.prototype,t),a&&o(e,a),e}function s(e,a){return!a||"object"!==t(a)&&"function"!=typeof a?c(e):a}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var k=require("token-types"),p=require("assert"),d=require("../apev2/APEv2Parser"),m=require("../common/FourCC"),b=require("../common/BasicParser"),h=require("./WavPackToken"),v=require("debug"),g=v("music-metadata:parser:WavPack"),y=function(t){function a(){return n(this,a),s(this,u(a).apply(this,arguments))}return l(a,b.BasicParser),i(a,[{key:"parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.audioDataSize=0,e.next=3,this.parseWavPackBlocks();case 3:return e.abrupt("return",d.APEv2Parser.parseTagHeader(this.metadata,this.tokenizer,this.options));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseWavPackBlocks",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.peekToken(m.FourCcToken);case 2:if("wvpk"===e.sent){e.next=5;break}return e.abrupt("break",21);case 5:return e.next=7,this.tokenizer.readToken(h.WavPack.BlockHeaderToken);case 7:if(t=e.sent,p.strictEqual(t.BlockID,"wvpk","WavPack Block-ID"),g("WavPack header blockIndex=".concat(t.blockIndex,", len=").concat(h.WavPack.BlockHeaderToken.len)),0!==t.blockIndex||this.metadata.format.container||(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!t.flags.isHybrid),this.metadata.setFormat("bitsPerSample",t.flags.bitsPerSample),t.flags.isDSD||(this.metadata.setFormat("sampleRate",t.flags.samplingRate),this.metadata.setFormat("duration",t.totalSamples/t.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",t.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",t.totalSamples),this.metadata.setFormat("codec",t.flags.isDSD?"DSD":"PCM")),a=t.blockSize-(h.WavPack.BlockHeaderToken.len-8),0!==t.blockIndex){e.next=17;break}return e.next=15,this.parseMetadataSubBlock(t,a);case 15:e.next=19;break;case 17:return e.next=19,this.tokenizer.ignore(a);case 19:t.blockSamples>0&&(this.audioDataSize+=t.blockSize);case 20:if(!this.tokenizer.fileSize||this.tokenizer.fileSize-this.tokenizer.position>=h.WavPack.BlockHeaderToken.len){e.next=0;break}case 21:this.metadata.setFormat("bitrate",8*this.audioDataSize/this.metadata.format.duration);case 22:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseMetadataSubBlock",value:function(){var t=r(regeneratorRuntime.mark(function t(a,r){var n,o,i,s,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r>h.WavPack.MetadataIdToken.len)){t.next=35;break}return t.next=3,this.tokenizer.readToken(h.WavPack.MetadataIdToken);case 3:return n=t.sent,t.next=6,this.tokenizer.readNumber(n.largeBlock?k.UINT24_LE:k.UINT8);case 6:return o=t.sent,i=e.alloc(2*o-(n.isOddSize?1:0)),t.next=10,this.tokenizer.readBuffer(i,0,i.length);case 10:g("Metadata Sub-Blocks functionId=0x".concat(n.functionId.toString(16),", id.largeBlock=").concat(n.largeBlock,",data-size=").concat(i.length)),t.t0=n.functionId,t.next=0===t.t0?14:14===t.t0?15:36===t.t0?22:38===t.t0?24:47===t.t0?26:28;break;case 14:return t.abrupt("break",30);case 15:return g("ID_DSD_BLOCK"),s=1<<i.readUInt8(0),c=a.flags.samplingRate*s*8,p.ok(a.flags.isDSD,"Only expect DSD block if DSD-flag is set"),this.metadata.setFormat("sampleRate",c),this.metadata.setFormat("duration",a.totalSamples/c),t.abrupt("break",30);case 22:return g("ID_ALT_TRAILER: trailer for non-wav files"),t.abrupt("break",30);case 24:return this.metadata.setFormat("audioMD5",i),t.abrupt("break",30);case 26:return g("ID_BLOCK_CHECKSUM: checksum=".concat(i.toString("hex"))),t.abrupt("break",30);case 28:return g("Ignore unsupported meta-sub-block-id functionId=0x".concat(n.functionId.toString(16))),t.abrupt("break",30);case 30:r-=h.WavPack.MetadataIdToken.len+(n.largeBlock?k.UINT24_LE.len:k.UINT8.len)+2*o,g("remainingLength=".concat(r)),n.isOddSize&&this.tokenizer.ignore(1),t.next=0;break;case 35:p.strictEqual(r,0,"metadata-sub-block should fit it remaining length");case 36:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}()}]),a}();exports.WavPackParser=y;
},{"token-types":"1rOY","assert":"TfPC","../apev2/APEv2Parser":"IhDz","../common/FourCC":"P2sd","../common/BasicParser":"O0hF","./WavPackToken":"aBWN","debug":"j+D9","buffer":"z1tx"}],"kASw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,n=require("token-types"),t=require("../common/FourCC");exports.ChunkHeader={len:12,get:function(e,r){return{id:t.FourCcToken.get(e,r),size:n.UINT64_LE.get(e,r+4)}}},exports.DsdChunk={len:16,get:function(e,t){return{fileSize:n.INT64_LE.get(e,t),metadataPointer:n.INT64_LE.get(e,t+8)}}},function(e){e[e.mono=1]="mono",e[e.stereo=2]="stereo",e[e.channels=3]="channels",e[e.quad=4]="quad",e[e["4 channels"]=5]="4 channels",e[e["5 channels"]=6]="5 channels",e[e["5.1 channels"]=7]="5.1 channels"}(e=exports.ChannelType||(exports.ChannelType={})),exports.FormatChunk={len:40,get:function(e,t){return{formatVersion:n.INT32_LE.get(e,t),formatID:n.INT32_LE.get(e,t+4),channelType:n.INT32_LE.get(e,t+8),channelNum:n.INT32_LE.get(e,t+12),samplingFrequency:n.INT32_LE.get(e,t+16),bitsPerSample:n.INT32_LE.get(e,t+20),sampleCount:n.INT64_LE.get(e,t+24),blockSizePerChannel:n.INT32_LE.get(e,t+32)}}};
},{"token-types":"1rOY","../common/FourCC":"P2sd"}],"PXkK":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,a)}function r(e){return function(){var r=this,n=arguments;return new Promise(function(a,o){var i=e.apply(r,n);function s(e){t(i,a,o,s,u,"next",e)}function u(e){t(i,a,o,s,u,"throw",e)}s(void 0)})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function i(t,r){return!r||"object"!==e(r)&&"function"!=typeof r?s(t):r}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var p=require("../id3v2/AbstractID3Parser"),m=require("assert"),l=require("debug"),h=require("./DsfChunk"),b=require("../id3v2/ID3v2Parser"),d=l("music-metadata:parser:DSF"),y=function(e){function t(){return n(this,t),i(this,u(t).apply(this,arguments))}return c(t,p.AbstractID3Parser),o(t,[{key:"_parse",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.tokenizer.position,e.next=3,this.tokenizer.readToken(h.ChunkHeader);case 3:return r=e.sent,m.strictEqual(r.id,"DSD ","Invalid chunk signature"),this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0),e.next=9,this.tokenizer.readToken(h.DsdChunk);case 9:if(0!==(n=e.sent).metadataPointer){e.next=14;break}d("No ID3v2 tag present"),e.next=20;break;case 14:return d("expect ID3v2 at offset=".concat(n.metadataPointer)),e.next=17,this.parseChunks(n.fileSize-r.size);case 17:return e.next=19,this.tokenizer.ignore(n.metadataPointer-this.tokenizer.position-t);case 19:return e.abrupt("return",(new b.ID3v2Parser).parse(this.metadata,this.tokenizer,this.options));case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parseChunks",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>=h.ChunkHeader.len)){e.next=24;break}return e.next=3,this.tokenizer.readToken(h.ChunkHeader);case 3:r=e.sent,d("Parsing chunk name=".concat(r.id," size=").concat(r.size)),e.t0=r.id,e.next="fmt "===e.t0?8:19;break;case 8:return e.next=10,this.tokenizer.readToken(h.FormatChunk);case 10:return n=e.sent,this.metadata.setFormat("numberOfChannels",n.channelNum),this.metadata.setFormat("sampleRate",n.samplingFrequency),this.metadata.setFormat("bitsPerSample",n.bitsPerSample),this.metadata.setFormat("numberOfSamples",n.sampleCount),this.metadata.setFormat("duration",n.sampleCount/n.samplingFrequency),a=n.bitsPerSample*n.samplingFrequency*n.channelNum,this.metadata.setFormat("bitrate",a),e.abrupt("return");case 19:return this.tokenizer.ignore(r.size-h.ChunkHeader.len),e.abrupt("break",21);case 21:t-=r.size,e.next=0;break;case 24:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}();exports.DsfParser=y;
},{"../id3v2/AbstractID3Parser":"Tc8M","assert":"TfPC","debug":"j+D9","./DsfChunk":"kASw","../id3v2/ID3v2Parser":"pIqu"}],"xY5O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("token-types"),r=require("../common/FourCC");exports.ChunkHeader={len:12,get:function(t,u){return{chunkID:r.FourCcToken.get(t,u),chunkSize:e.INT64_BE.get(t,u+4)}}};
},{"token-types":"1rOY","../common/FourCC":"P2sd"}],"xpEd":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,n,r,a,o,i){try{var s=e[o](i),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function n(e){return function(){var n=this,r=arguments;return new Promise(function(a,o){var i=e.apply(n,r);function s(e){t(i,a,o,s,u,"next",e)}function u(e){t(i,a,o,s,u,"throw",e)}s(void 0)})}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function i(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?s(t):n}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(exports,"__esModule",{value:!0});var k=require("assert"),f=require("token-types"),p=require("debug"),m=require("../common/FourCC"),d=require("../common/BasicParser"),l=require("../id3v2/ID3Stream"),b=require("./DsdiffToken"),y=require("strtok3/lib/core"),S=require("../id3v2/ID3v2Parser"),z=p("music-metadata:parser:aiff"),x=function(e){function t(){return r(this,t),i(this,u(t).apply(this,arguments))}return c(t,d.BasicParser),o(t,[{key:"parse",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tokenizer.readToken(b.ChunkHeader);case 2:return t=e.sent,k.strictEqual(t.chunkID,"FRM8"),e.next=6,this.tokenizer.readToken(m.FourCcToken);case 6:n=e.sent.trim(),e.t0=n,e.next="DSD"===e.t0?10:13;break;case 10:return this.metadata.setFormat("container","DSDIFF/".concat(n)),this.metadata.setFormat("lossless",!0),e.abrupt("return",this.readFmt8Chunks(t.chunkSize-m.FourCcToken.len));case 13:throw Error("Unsupported DSDIFF type: ".concat(n));case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"readFmt8Chunks",value:function(){var e=n(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>=b.ChunkHeader.len)){e.next=10;break}return e.next=3,this.tokenizer.readToken(b.ChunkHeader);case 3:return n=e.sent,z("Chunk id=".concat(n.chunkID)),e.next=7,this.readData(n);case 7:t-=b.ChunkHeader.len+n.chunkSize,e.next=0;break;case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"readData",value:function(){var e=n(regeneratorRuntime.mark(function e(t){var n,r,a,o,i,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:z("Reading data of chunk[ID=".concat(t.chunkID,", size=").concat(t.chunkSize,"]")),n=this.tokenizer.position,e.t0=t.chunkID.trim(),e.next="FVER"===e.t0?5:"PROP"===e.t0?10:"ID3"===e.t0?17:"DSD"===e.t0?27:25;break;case 5:return e.next=7,this.tokenizer.readToken(f.UINT32_LE);case 7:return r=e.sent,z("DSDIFF version=".concat(r)),e.abrupt("break",30);case 10:return e.next=12,this.tokenizer.readToken(m.FourCcToken);case 12:return a=e.sent,k.strictEqual(a,"SND "),e.next=16,this.handleSoundPropertyChunks(t.chunkSize-m.FourCcToken.len);case 16:return e.abrupt("break",30);case 17:return e.next=19,this.tokenizer.readToken(new f.BufferType(t.chunkSize));case 19:return o=e.sent,i=new l.ID3Stream(o),s=y.fromStream(i),e.next=24,(new S.ID3v2Parser).parse(this.metadata,s,this.options);case 24:return e.abrupt("break",30);case 25:return z("Ignore chunk[ID=".concat(t.chunkID,", size=").concat(t.chunkSize,"]")),e.abrupt("break",30);case 27:return this.metadata.setFormat("numberOfSamples",8*t.chunkSize/this.metadata.format.numberOfChannels),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate),e.abrupt("break",30);case 30:if(!((u=t.chunkSize-(this.tokenizer.position-n))>0)){e.next=35;break}return z("After Parsing chunk, remaining ".concat(u," bytes")),e.next=35,this.tokenizer.ignore(u);case 35:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSoundPropertyChunks",value:function(){var e=n(regeneratorRuntime.mark(function e(t){var n,r,a,o,i,s,u,c,h,k,p,d,l,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:z("Parsing sound-property-chunks, remainingSize=".concat(t));case 1:if(!(t>0)){e.next=65;break}return e.next=4,this.tokenizer.readToken(b.ChunkHeader);case 4:n=e.sent,z("Sound-property-chunk[ID=".concat(n.chunkID,", size=").concat(n.chunkSize,"]")),r=this.tokenizer.position,e.t0=n.chunkID.trim(),e.next="FS"===e.t0?10:"CHNL"===e.t0?15:"CMPR"===e.t0?22:"ABSS"===e.t0?34:"LSCO"===e.t0?48:(e.t0,53);break;case 10:return e.next=12,this.tokenizer.readToken(f.UINT32_BE);case 12:return a=e.sent,this.metadata.setFormat("sampleRate",a),e.abrupt("break",56);case 15:return e.next=17,this.tokenizer.readToken(f.UINT16_BE);case 17:return o=e.sent,this.metadata.setFormat("numberOfChannels",o),e.next=21,this.handleChannelChunks(n.chunkSize-f.UINT16_BE.len);case 21:return e.abrupt("break",56);case 22:return e.next=24,this.tokenizer.readToken(m.FourCcToken);case 24:return i=e.sent.trim(),e.next=27,this.tokenizer.readToken(f.UINT8);case 27:return s=e.sent,e.next=30,this.tokenizer.readToken(new f.StringType(s,"ascii"));case 30:return u=e.sent,"DSD"===i&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec","".concat(i," (").concat(u,")")),e.abrupt("break",56);case 34:return e.next=36,this.tokenizer.readToken(f.UINT16_BE);case 36:return c=e.sent,e.next=39,this.tokenizer.readToken(f.UINT8);case 39:return h=e.sent,e.next=42,this.tokenizer.readToken(f.UINT8);case 42:return k=e.sent,e.next=45,this.tokenizer.readToken(f.UINT32_BE);case 45:return p=e.sent,z("ABSS ".concat(c,":").concat(h,":").concat(k,".").concat(p)),e.abrupt("break",56);case 48:return e.next=50,this.tokenizer.readToken(f.UINT16_BE);case 50:return d=e.sent,z("LSCO lsConfig=".concat(d)),e.abrupt("break",56);case 53:return z("Unknown sound-property-chunk[ID=".concat(n.chunkID,", size=").concat(n.chunkSize,"]")),e.next=56,this.tokenizer.ignore(n.chunkSize);case 56:if(!((l=n.chunkSize-(this.tokenizer.position-r))>0)){e.next=61;break}return z("After Parsing sound-property-chunk ".concat(n.chunkSize,", remaining ").concat(l," bytes")),e.next=61,this.tokenizer.ignore(l);case 61:t-=b.ChunkHeader.len+n.chunkSize,z("Parsing sound-property-chunks, remainingSize=".concat(t)),e.next=1;break;case 65:this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample&&(y=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample,this.metadata.setFormat("bitrate",y));case 66:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleChannelChunks",value:function(){var e=n(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:z("Parsing channel-chunks, remainingSize=".concat(t)),n=[];case 2:if(!(t>=m.FourCcToken.len)){e.next=11;break}return e.next=5,this.tokenizer.readToken(m.FourCcToken);case 5:r=e.sent,z("Channel[ID=".concat(r,"]")),n.push(r),t-=m.FourCcToken.len,e.next=2;break;case 11:return z("Channels: ".concat(n.join(", "))),e.abrupt("return",n);case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}();exports.DsdiffParser=x;
},{"assert":"TfPC","token-types":"1rOY","debug":"j+D9","../common/FourCC":"P2sd","../common/BasicParser":"O0hF","../id3v2/ID3Stream":"Zy6X","./DsdiffToken":"xY5O","strtok3/lib/core":"tvmF","../id3v2/ID3v2Parser":"pIqu"}],"5YKB":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;function r(e,r,a,t,n,s,u){try{var c=e[s](u),i=c.value}catch(o){return void a(o)}c.done?r(i):Promise.resolve(i).then(t,n)}function a(e){return function(){var a=this,t=arguments;return new Promise(function(n,s){var u=e.apply(a,t);function c(e){r(u,n,s,c,i,"next",e)}function i(e){r(u,n,s,c,i,"throw",e)}c(void 0)})}}function t(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function n(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function s(e,r,a){return r&&n(e.prototype,r),a&&n(e,a),e}Object.defineProperty(exports,"__esModule",{value:!0});var u=require("file-type"),c=require("content-type"),i=require("media-typer"),o=require("debug"),f=require("./common/MetadataCollector"),p=require("./aiff/AiffParser"),m=require("./apev2/APEv2Parser"),v=require("./asf/AsfParser"),g=require("./flac/FlacParser"),d=require("./mp4/MP4Parser"),w=require("./mpeg/MpegParser"),l=require("./musepack"),y=require("./ogg/OggParser"),P=require("./riff/WaveParser"),b=require("./wavpack/WavPackParser"),k=require("./dsf/DsfParser"),h=require("./dsdiff/DsdiffParser"),x=o("music-metadata:parser:factory");function q(e){var r=c.parse(e),a=i.parse(r.type);return{type:a.type,subtype:a.subtype,suffix:a.suffix,parameters:r.parameters}}exports.parseHttpContentType=q;var M=function(){function r(){t(this,r),this.warning=[]}return s(r,null,[{key:"parse",value:function(){var t=a(regeneratorRuntime.mark(function a(t,n,s){var c,i,o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(c=r.getParserIdForMimeType(n)||r.getParserIdForExtension(n)){a.next=14;break}return x("No parser found for MIME-type / extension: "+n),i=e.alloc(4100),a.next=6,t.peekBuffer(i,0,i.byteLength,t.position,!0);case 6:if(o=u(i)){a.next=9;break}throw new Error("Failed to guess MIME-type");case 9:if(x("Guessed file type is mime=".concat(o.mime,", extension=").concat(o.ext)),c=r.getParserIdForMimeType(o.mime)){a.next=13;break}throw new Error("Guessed MIME-type not supported: "+o.mime);case 13:case 14:return a.abrupt("return",this._parse(t,c,s));case 15:case"end":return a.stop()}},a,this)}));return function(e,r,a){return t.apply(this,arguments)}}()},{key:"getParserIdForExtension",value:function(e){if(e)switch(this.getExtension(e).toLocaleLowerCase()||e){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff"}}},{key:"loadParser",value:function(){var e=a(regeneratorRuntime.mark(function e(r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next="aiff"===e.t0?3:"apev2"===e.t0?4:"asf"===e.t0?5:"dsf"===e.t0?6:"dsdiff"===e.t0?7:"flac"===e.t0?8:"mp4"===e.t0?9:"mpeg"===e.t0?10:"musepack"===e.t0?11:"ogg"===e.t0?12:"riff"===e.t0?13:"wavpack"===e.t0?14:15;break;case 3:return e.abrupt("return",new p.AIFFParser);case 4:return e.abrupt("return",new m.APEv2Parser);case 5:return e.abrupt("return",new v.AsfParser);case 6:return e.abrupt("return",new k.DsfParser);case 7:return e.abrupt("return",new h.DsdiffParser);case 8:return e.abrupt("return",new g.FlacParser);case 9:return e.abrupt("return",new d.MP4Parser);case 10:return e.abrupt("return",new w.MpegParser);case 11:return e.abrupt("return",new l.default);case 12:return e.abrupt("return",new y.OggParser);case 13:return e.abrupt("return",new P.WaveParser);case 14:return e.abrupt("return",new b.WavPackParser);case 15:throw new Error("Unknown parser type: ".concat(r));case 16:case"end":return e.stop()}},e)}));return function(r,a){return e.apply(this,arguments)}}()},{key:"_parse",value:function(){var e=a(regeneratorRuntime.mark(function e(a,t){var n,s,u,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:{},e.next=3,r.loadParser(t,n);case 3:return s=e.sent,u=new f.MetadataCollector(n),e.next=7,s.init(u,a,n).parse();case 7:return e.abrupt("return",u.toCommonMetadata());case 8:case"end":return e.stop()}},e)}));return function(r,a){return e.apply(this,arguments)}}()},{key:"getExtension",value:function(e){var r=e.lastIndexOf(".");return-1===r?"":e.slice(r)}},{key:"getParserIdForMimeType",value:function(e){var r;try{r=q(e)}catch(t){return void x("Invalid HTTP Content-Type header value: ".concat(e))}var a=0===r.subtype.indexOf("x-")?r.subtype.substring(2):r.subtype;switch(r.type){case"audio":switch(a){case"mp3":case"mpeg":return"mpeg";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"aac":case"aacp":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"dsf":return"dsf"}break;case"video":switch(a){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg"}break;case"application":switch(a){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}}}}]),r}();exports.ParserFactory=M;
},{"file-type":"gPQA","content-type":"UNrW","media-typer":"atBn","debug":"j+D9","./common/MetadataCollector":"34Xp","./aiff/AiffParser":"C2dR","./apev2/APEv2Parser":"IhDz","./asf/AsfParser":"EvYH","./flac/FlacParser":"lnZi","./mp4/MP4Parser":"eyoP","./mpeg/MpegParser":"7/3S","./musepack":"dsOL","./ogg/OggParser":"fxkA","./riff/WaveParser":"UqqU","./wavpack/WavPackParser":"0DiC","./dsf/DsfParser":"PXkK","./dsdiff/DsdiffParser":"xpEd","buffer":"z1tx"}],"0Pvp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("strtok3/lib/core"),e=require("./ParserFactory");function t(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(r.fromStream(e),t,o)}function o(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(r.fromBuffer(e),t,o)}function i(r,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return!r.fileSize&&o.fileSize&&(r.fileSize=o.fileSize),e.ParserFactory.parse(r,t,o)}function n(r){var e={},t=!0,o=!1,i=void 0;try{for(var n,a=r[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var u=n.value;(e[u.id]=e[u.id]||[]).push(u.value)}}catch(f){o=!0,i=f}finally{try{t||null==a.return||a.return()}finally{if(o)throw i}}return e}function a(r){return void 0===r?0:1+Math.round(4*r)}exports.parseStream=t,exports.parseBuffer=o,exports.parseFromTokenizer=i,exports.orderTags=n,exports.ratingToStars=a;
},{"strtok3/lib/core":"tvmF","./ParserFactory":"5YKB"}],"3NT2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("stream");class s extends e.Readable{constructor(e){super(),this.bytesRead=0,this.released=!1,this.reader=e.getReader()}async _read(){if(this.released)return void this.push(null);this.pendingRead=this.reader.read();const e=await this.pendingRead;delete this.pendingRead,e.done||this.released?this.push(null):(this.bytesRead+=e.value.length,this.push(e.value))}async waitForReadToComplete(){this.pendingRead&&await this.pendingRead}async close(){await this.syncAndRelease()}async syncAndRelease(){this.released=!0,await this.waitForReadToComplete(),await this.reader.releaseLock()}}exports.ReadableWeToNodeStream=s;
},{"stream":"17Yv"}],"ugmL":[function(require,module,exports) {
module.exports=n,n.strict=a,n.loose=o;var t=Object.prototype.toString,r={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function n(t){return a(t)||o(t)}function a(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array}function o(n){return r[t.call(n)]}
},{}],"QV2L":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer,r=require("is-typedarray").strict;module.exports=function(t){if(r(t)){var f=e.from(t.buffer);return t.byteLength!==t.buffer.byteLength&&(f=f.slice(t.byteOffset,t.byteOffset+t.byteLength)),f}return e.from(t)};
},{"is-typedarray":"ugmL","buffer":"z1tx"}],"yy1F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("debug"),r=require("music-metadata/lib/core"),t=require("readable-web-to-node-stream"),a=require("typedarray-to-buffer"),o=e("music-metadata-browser:main");async function s(e,r,a){const s=new t.ReadableWeToNodeStream(e),n=await exports.parseNodeStream(s,r,a);return o(`Completed parsing from stream bytesRead=${s.bytesRead} / fileSize=${a&&a.fileSize?a.fileSize:"?"}`),await s.close(),n}function n(e,t){return d(e).then(a=>r.parseBuffer(a,e.type,t))}async function i(e,r){const t=await fetch(e),a=t.headers.get("Content-Type"),s=[];if(t.headers.forEach(e=>{s.push(e)}),t.ok){if(t.body){const e=await this.parseReadableStream(t.body,a,r);return o("Closing HTTP-readable-stream..."),t.body.locked||await t.body.cancel(),o("HTTP-readable-stream closed."),e}return this.parseBlob(await t.blob(),r)}throw new Error(`HTTP error status=${t.status}: ${t.statusText}`)}function d(e){return new Promise((r,t)=>{const o=new FileReader;o.onloadend=(e=>{let t=e.target.result;t instanceof ArrayBuffer&&(t=a(new Uint8Array(e.target.result))),r(t)}),o.onerror=(e=>{t(new Error(e.type))}),o.onabort=(e=>{t(new Error(e.type))}),o.readAsArrayBuffer(e)})}exports.parseNodeStream=r.parseStream,exports.parseReadableStream=s,exports.parseBuffer=r.parseBuffer,exports.parseBlob=n,exports.fetchFromUrl=i,exports.parseFromTokenizer=r.parseFromTokenizer,exports.orderTags=r.orderTags,exports.ratingToStars=r.ratingToStars;
},{"debug":"j+D9","music-metadata/lib/core":"0Pvp","readable-web-to-node-stream":"3NT2","typedarray-to-buffer":"QV2L"}],"pQHU":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var t=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0});const e=-1;class a{constructor(){this._fileData=[]}addData(t,a){const f=t+a.byteLength-1,s=this._getChunkRange(t,f);if(s.startIx===e)this._fileData.splice(s.insertIx||0,0,{offset:t,data:a});else{const e=this._fileData[s.startIx],i=this._fileData[s.endIx],n=t>e.offset,r=f<i.offset+i.data.byteLength-1,o={offset:Math.min(t,e.offset),data:a};if(n){const f=e.data.slice(0,t-e.offset);o.data=this._concatData(f,a)}if(r){const t=o.data.slice(0,i.offset-o.offset);o.data=this._concatData(t,i.data)}this._fileData.splice(s.startIx,s.endIx-s.startIx+1,o)}}hasDataRange(t,e){for(let a=0;a<this._fileData.length;a++){const f=this._fileData[a];if(e<f.offset)return!1;if(t>=f.offset&&e<f.offset+f.data.byteLength)return!0}return!1}readToBuffer(e,a,f,s){const i=f;let n;for(let r=0;r<this._fileData.length;r++){const o=this._fileData[r].offset,h=o+this._fileData[r].data.byteLength-1;if(i>=o&&i<=h){n=this._fileData[r];const h=i-o,l=Math.min(s,n.data.byteLength-h);return t.from(n.data).copy(e,a,h,h+l),l<s?this.readToBuffer(e,a+l,f+l,s-l):void 0}}throw new Error(`Offset ${i} hasn't been loaded yet.`)}_concatData(t,e){const a=new Uint8Array(t.byteLength+e.byteLength);return a.set(new Uint8Array(t),0),a.set(new Uint8Array(e),t.byteLength),a.buffer}_getChunkRange(t,a){let f=e,s=e,i=0;for(let e=0;e<this._fileData.length;i=++e){const s=this._fileData[e].offset,i=s+this._fileData[e].data.byteLength;if(a<s-1)break;if(t<=i+1&&a>=s-1){f=e;break}}if(f===e)return{startIx:e,endIx:e,insertIx:i};for(let e=f;e<this._fileData.length;e++){const t=this._fileData[e].offset;if(a>=t-1&&(s=e),a<=t+this._fileData[e].data.byteLength+1)break}return s===e&&(s=f),{startIx:f,endIx:s}}}exports.ChunkedFileData=a;
},{"buffer":"z1tx"}],"L2sF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("debug"),t=require("strtok3/lib/AbstractTokenizer"),n=require("./chunked-file-data"),i=e("streaming-http-token-reader");class s extends t.AbstractTokenizer{constructor(e,t){super(),this.url=e,this.config={avoidHeadRequests:!1,initialChunkSize:4096,minimumChunkSize:1024},t&&Object.assign(this.config,t),this._fileData=new n.ChunkedFileData,this._isInitialized=!1,this.fileSize=0}static getContentLength(e){const t=e.get("Content-Length");return t?parseInt(t,10):void 0}readBuffer(e,t=0,n=e.length,s){return s&&(this.position=s),i(`readBuffer position=${this.position} length=${n}`),0===n?Promise.resolve(0):(n||(n=e.length),this.peekBuffer(e,t,n,this.position).then(()=>(this.position+=n,n)))}peekBuffer(e,t=0,n=e.length,s=this.position){i(`peekBuffer position=${s} length=${n}`);const r=s+n-1;return this.loadRange([s,r]).then(()=>(this._fileData.readToBuffer(e,t,s,n),n))}ignore(e){const t=this.fileSize-this.position;return e<=t?(this.position+=e,Promise.resolve(e)):(this.position+=t,Promise.resolve(t))}init(){return this.config.avoidHeadRequests?this._fetchSizeWithGetRequest():this._fetchSizeWithHeadRequest()}loadRange(e){return i(`loadRange ${e[0]}..${e[1]}`),this._fileData.hasDataRange(e[0],Math.min(this.fileSize,e[1]))?(i("Read from cache"),Promise.resolve()):((e=this._roundRange(e))[1]=Math.min(this.fileSize,e[1]),i(`adjust range to: ${e[0]}..${e[1]}`),this._getResponse("GET",e).then(t=>t.arrayBuffer().then(t=>{this._fileData.addData(e[0],t)})))}_fetchSizeWithHeadRequest(){return i("_fetchSizeWithHeadRequest()"),fetch(this.url,{method:"HEAD"}).then(e=>{const t=s.getContentLength(e.headers);if(!t)return i("Content-Length not provided by the server, fallback to GET requests"),this._fetchSizeWithGetRequest();i(`contentLength=${t}`),this.fileSize=t,this.contentType=e.headers.get("Content-Type")})}_fetchSizeWithGetRequest(){const e=this._roundRange([0,this.config.initialChunkSize]);return this._getResponse("GET",e).then(e=>{const t=this._parseContentRange(e.headers);if(i(`_fetchSizeWithGetRequest response: contentRange=${t}`),this.contentType=e.headers.get("Content-Type"),t)return this.fileSize=t.instanceLength,e;throw new Error("Did not get a content range")})}_parseContentRange(e){const t=e.get("Content-Range");if(i(`_parseContentRang response: contentRange=${t}`),t){const e=t.match(/bytes (\d+)-(\d+)\/(?:(\d+)|\*)/i);if(!e)throw new Error("FIXME: Unknown Content-Range syntax: "+t);return{firstBytePosition:parseInt(e[1],10),lastBytePosition:parseInt(e[2],10),instanceLength:e[3]?parseInt(e[3],10):null}}return null}_roundRange(e){const t=e[1]-e[0]+1,n=Math.max(this.config.minimumChunkSize,t);return[e[0],e[0]+n-1]}_getResponse(e,t){i(t?`_makeXHRRequest ${e} ${t[0]}..${t[1]}`:`_makeXHRRequest ${e} (range not provided)`);const n=new Headers;return n.set("Range","bytes="+t[0]+"-"+t[1]),fetch(this.url,{method:e,headers:n}).then(e=>{if(e.ok)return e;throw new Error(`Unexpected HTTP response status=${e.status}`)})}}exports.StreamingHttpTokenReader=s;
},{"debug":"j+D9","strtok3/lib/AbstractTokenizer":"PoRW","./chunked-file-data":"pQHU"}],"Focm":[function(require,module,exports) {
"use strict";require("regenerator-runtime/runtime");var e=t(require("music-metadata-browser")),r=require("streaming-http-token-reader");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};a.get||a.set?Object.defineProperty(r,t,a):r[t]=e[t]}return r.default=e,r}self.musicMetadata=e,self.StreamingHttpTokenReader=r.StreamingHttpTokenReader;
},{"regenerator-runtime/runtime":"KA2S","music-metadata-browser":"yy1F","streaming-http-token-reader":"L2sF"}]},{},["Focm"], null)